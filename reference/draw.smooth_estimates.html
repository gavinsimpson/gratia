<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot the result of a call to smooth_estimates() — draw.smooth_estimates • gratia</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Plot the result of a call to smooth_estimates() — draw.smooth_estimates"><meta name="description" content="Plot the result of a call to smooth_estimates()"><meta property="og:description" content="Plot the result of a call to smooth_estimates()"><meta property="og:image" content="https://gavinsimpson.github.io/gratia/reference/figures/README-draw-gam-figure-1.png"><meta property="og:image:alt" content="Plot produced by draw() of 4 smooth functions from a fitted generalized additive model"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@ucfagls"><meta name="twitter:site" content="@ucfagls"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gratia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.0.9014</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/gratia.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/custom-plotting.html">Customizing plots</a></li>
    <li><a class="dropdown-item" href="../articles/data-slices.html">Data slices</a></li>
    <li><a class="dropdown-item" href="../articles/posterior-simulation.html">Posterior Simulation</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gavinsimpson/gratia/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot the result of a call to <code>smooth_estimates()</code></h1>
      <small class="dont-index">Source: <a href="https://github.com/gavinsimpson/gratia/blob/main/R/smooth-estimates.R" class="external-link"><code>R/smooth-estimates.R</code></a></small>
      <div class="d-none name"><code>draw.smooth_estimates.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot the result of a call to <code><a href="smooth_estimates.html">smooth_estimates()</a></code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'smooth_estimates'</span></span>
<span><span class="fu"><a href="draw.html">draw</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  constant <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contour <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grouped_by <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  contour_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  n_contour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ci_alpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  ci_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  smooth_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  resid_col <span class="op">=</span> <span class="st">"steelblue3"</span>,</span>
<span>  decrease_col <span class="op">=</span> <span class="st">"#56B4E9"</span>,</span>
<span>  increase_col <span class="op">=</span> <span class="st">"#E69F00"</span>,</span>
<span>  change_lwd <span class="op">=</span> <span class="fl">1.75</span>,</span>
<span>  partial_match <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  discrete_colour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  discrete_fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  continuous_colour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  continuous_fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  angle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  crs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  default_crs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lims_method <span class="op">=</span> <span class="st">"cross"</span>,</span>
<span>  caption <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a fitted GAM, the result of a call to <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">mgcv::gam()</a></code>.</p></dd>


<dt id="arg-constant">constant<a class="anchor" aria-label="anchor" href="#arg-constant"></a></dt>
<dd><p>numeric; a constant to add to the estimated values of the
smooth. <code>constant</code>, if supplied, will be added to the estimated value
before the confidence band is computed.</p></dd>


<dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>function; a function that will be applied to the estimated values
and confidence interval before plotting. Can be a function or the name of a
function. Function <code>fun</code> will be applied after adding any <code>constant</code>, if
provided.</p></dd>


<dt id="arg-contour">contour<a class="anchor" aria-label="anchor" href="#arg-contour"></a></dt>
<dd><p>logical; should contours be draw on the plot using
<code><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">ggplot2::geom_contour()</a></code>.</p></dd>


<dt id="arg-grouped-by">grouped_by<a class="anchor" aria-label="anchor" href="#arg-grouped-by"></a></dt>
<dd><p>logical; should factor by smooths be drawn as one panel
per level of the factor (<code>FALSE</code>, the default), or should the individual
smooths be combined into a single panel containing all levels (<code>TRUE</code>)?</p></dd>


<dt id="arg-contour-col">contour_col<a class="anchor" aria-label="anchor" href="#arg-contour-col"></a></dt>
<dd><p>colour specification for contour lines.</p></dd>


<dt id="arg-n-contour">n_contour<a class="anchor" aria-label="anchor" href="#arg-n-contour"></a></dt>
<dd><p>numeric; the number of contour bins. Will result in
<code>n_contour - 1</code> contour lines being drawn. See <code><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">ggplot2::geom_contour()</a></code>.</p></dd>


<dt id="arg-ci-alpha">ci_alpha<a class="anchor" aria-label="anchor" href="#arg-ci-alpha"></a></dt>
<dd><p>numeric; alpha transparency for confidence or simultaneous
interval.</p></dd>


<dt id="arg-ci-col">ci_col<a class="anchor" aria-label="anchor" href="#arg-ci-col"></a></dt>
<dd><p>colour specification for the confidence/credible intervals
band. Affects the fill of the interval.</p></dd>


<dt id="arg-smooth-col">smooth_col<a class="anchor" aria-label="anchor" href="#arg-smooth-col"></a></dt>
<dd><p>colour specification for the smooth line.</p></dd>


<dt id="arg-resid-col">resid_col<a class="anchor" aria-label="anchor" href="#arg-resid-col"></a></dt>
<dd><p>colour specification for the partial residuals.</p></dd>


<dt id="arg-decrease-col-increase-col">decrease_col, increase_col<a class="anchor" aria-label="anchor" href="#arg-decrease-col-increase-col"></a></dt>
<dd><p>colour specifications to use for
indicating periods of change. <code>col_change</code> is used when
<code>change_type = "change"</code>, while <code>col_decrease</code> and <code>col_increase</code> are used
when `change_type = "sizer"“.</p></dd>


<dt id="arg-change-lwd">change_lwd<a class="anchor" aria-label="anchor" href="#arg-change-lwd"></a></dt>
<dd><p>numeric; the value to set the <code>linewidth</code> to in
<code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">ggplot2::geom_line()</a></code>, used to represent the periods of change.</p></dd>


<dt id="arg-partial-match">partial_match<a class="anchor" aria-label="anchor" href="#arg-partial-match"></a></dt>
<dd><p>logical; should smooths be selected by partial matches
with <code>select</code>? If <code>TRUE</code>, <code>select</code> can only be a single string to match
against.</p></dd>


<dt id="arg-discrete-colour">discrete_colour<a class="anchor" aria-label="anchor" href="#arg-discrete-colour"></a></dt>
<dd><p>a suitable colour scale to be used when plotting
discrete variables.</p></dd>


<dt id="arg-discrete-fill">discrete_fill<a class="anchor" aria-label="anchor" href="#arg-discrete-fill"></a></dt>
<dd><p>a suitable fill scale to be used when plotting
discrete variables.</p></dd>


<dt id="arg-continuous-colour">continuous_colour<a class="anchor" aria-label="anchor" href="#arg-continuous-colour"></a></dt>
<dd><p>a suitable colour scale to be used when plotting
continuous variables.</p></dd>


<dt id="arg-continuous-fill">continuous_fill<a class="anchor" aria-label="anchor" href="#arg-continuous-fill"></a></dt>
<dd><p>a suitable fill scale to be used when plotting
continuous variables.</p></dd>


<dt id="arg-angle">angle<a class="anchor" aria-label="anchor" href="#arg-angle"></a></dt>
<dd><p>numeric; the angle at which the x axis tick labels are to be
drawn passed to the <code>angle</code> argument of <code><a href="https://ggplot2.tidyverse.org/reference/guide_axis.html" class="external-link">ggplot2::guide_axis()</a></code>.</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>numeric; vector of y axis limits to use all <em>all</em> panels drawn.</p></dd>


<dt id="arg-crs">crs<a class="anchor" aria-label="anchor" href="#arg-crs"></a></dt>
<dd><p>the coordinate reference system (CRS) to use for the plot. All
data will be projected into this CRS. See <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::coord_sf()</a></code> for
details.</p></dd>


<dt id="arg-default-crs">default_crs<a class="anchor" aria-label="anchor" href="#arg-default-crs"></a></dt>
<dd><p>the coordinate reference system (CRS) to use for the
non-sf layers in the plot. If left at the default <code>NULL</code>, the CRS used is
4326 (WGS84), which is appropriate for spline-on-the-sphere smooths, which
are parameterized in terms of latitude and longitude as coordinates. See
<code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::coord_sf()</a></code> for more details.</p></dd>


<dt id="arg-lims-method">lims_method<a class="anchor" aria-label="anchor" href="#arg-lims-method"></a></dt>
<dd><p>character; affects how the axis limits are determined. See
<code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::coord_sf()</a></code>. Be careful; in testing of some examples, changing
this to <code>"orthogonal"</code> for example with the chlorophyll-a example from
Simon Wood's GAM book quickly used up all the RAM in my test system and the
OS killed R. This could be incorrect usage on my part; right now the grid
of points at which SOS smooths are evaluated (if not supplied by the user)
can produce invalid coordinates for the corners of tiles as the grid is
generated for tile centres without respect to the spacing of those tiles.</p></dd>


<dt id="arg-caption">caption<a class="anchor" aria-label="anchor" href="#arg-caption"></a></dt>
<dd><p>logical; show the smooth type in the caption of each plot?</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to <code><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">patchwork::wrap_plots()</a></code>.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="load_mgcv.html">load_mgcv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># example data</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="data_sim.html">data_sim</a></span><span class="op">(</span><span class="st">"eg1"</span>, seed <span class="op">=</span> <span class="fl">21</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># fit GAM</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">gam</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">x0</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x3</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># plot all of the estimated smooths</span></span></span>
<span class="r-in"><span><span class="va">sm</span> <span class="op">&lt;-</span> <span class="fu"><a href="smooth_estimates.html">smooth_estimates</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="draw.html">draw</a></span><span class="op">(</span><span class="va">sm</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="draw.smooth_estimates-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># evaluate smooth of `x2`</span></span></span>
<span class="r-in"><span><span class="va">sm</span> <span class="op">&lt;-</span> <span class="fu"><a href="smooth_estimates.html">smooth_estimates</a></span><span class="op">(</span><span class="va">m</span>, select <span class="op">=</span> <span class="st">"s(x2)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># plot it</span></span></span>
<span class="r-in"><span><span class="fu"><a href="draw.html">draw</a></span><span class="op">(</span><span class="va">sm</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="draw.smooth_estimates-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># customising some plot elements</span></span></span>
<span class="r-in"><span><span class="fu"><a href="draw.html">draw</a></span><span class="op">(</span><span class="va">sm</span>, ci_col <span class="op">=</span> <span class="st">"steelblue"</span>, smooth_col <span class="op">=</span> <span class="st">"forestgreen"</span>, ci_alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="draw.smooth_estimates-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a constant to the plotted smooth</span></span></span>
<span class="r-in"><span><span class="fu"><a href="draw.html">draw</a></span><span class="op">(</span><span class="va">sm</span>, constant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="draw.smooth_estimates-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Adding change indicators to smooths based on derivatives of the smooth</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="derivatives.html">derivatives</a></span><span class="op">(</span><span class="va">m</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># n to match smooth_estimates()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="smooth_estimates.html">smooth_estimates</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="add_sizer.html">add_sizer</a></span><span class="op">(</span>derivatives <span class="op">=</span> <span class="va">d</span>, type <span class="op">=</span> <span class="st">"sizer"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="draw.html">draw</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="draw.smooth_estimates-5.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://fromthebottomoftheheap.net" class="external-link">Gavin L. Simpson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

