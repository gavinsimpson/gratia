<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Basis expansions for smooths — basis • gratia</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Basis expansions for smooths — basis"><meta name="description" content="Basis expansions from a definition of a smoother using the syntax of mgcv's
smooths via mgcv::s()., mgcv::te(), mgcv::ti(), and mgcv::t2(), or
directly from a fitted GAM(M)."><meta property="og:description" content="Basis expansions from a definition of a smoother using the syntax of mgcv's
smooths via mgcv::s()., mgcv::te(), mgcv::ti(), and mgcv::t2(), or
directly from a fitted GAM(M)."><meta property="og:image" content="https://gavinsimpson.github.io/gratia/reference/figures/README-draw-gam-figure-1.png"><meta property="og:image:alt" content="Plot produced by draw() of 4 smooth functions from a fitted generalized additive model"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@ucfagls"><meta name="twitter:site" content="@ucfagls"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gratia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.0.9023</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/gratia.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/custom-plotting.html">Customizing plots</a></li>
    <li><a class="dropdown-item" href="../articles/data-slices.html">Data slices</a></li>
    <li><a class="dropdown-item" href="../articles/posterior-simulation.html">Posterior Simulation</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gavinsimpson/gratia/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Basis expansions for smooths</h1>
      <small class="dont-index">Source: <a href="https://github.com/gavinsimpson/gratia/blob/main/R/basis-funs.R" class="external-link"><code>R/basis-funs.R</code></a></small>
      <div class="d-none name"><code>basis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Basis expansions from a definition of a smoother using the syntax of <em>mgcv</em>'s
smooths via <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">mgcv::s()</a></code>., <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">mgcv::te()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">mgcv::ti()</a></code>, and <code><a href="https://rdrr.io/pkg/mgcv/man/t2.html" class="external-link">mgcv::t2()</a></code>, or
directly from a fitted GAM(M).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">basis</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'gam'</span></span>
<span><span class="fu">basis</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  term <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_2d <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  n_3d <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  n_4d <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  partial_match <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'scam'</span></span>
<span><span class="fu">basis</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  term <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_2d <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  n_3d <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  n_4d <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  partial_match <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'gamm'</span></span>
<span><span class="fu">basis</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  term <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_2d <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  n_3d <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  n_4d <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  partial_match <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'gamm4'</span></span>
<span><span class="fu">basis</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  term <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_2d <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  n_3d <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  n_4d <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  partial_match <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">basis</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  knots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  constraints <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  at <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  diagonalize <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a smooth specification, the result of a call to one of
<code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">mgcv::s()</a></code>., <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">mgcv::te()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">mgcv::ti()</a></code>, or <code><a href="https://rdrr.io/pkg/mgcv/man/t2.html" class="external-link">mgcv::t2()</a></code>, or a fitted
GAM(M) model.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments passed to <code><a href="https://rdrr.io/pkg/mgcv/man/smoothCon.html" class="external-link">mgcv::smoothCon()</a></code>.</p></dd>


<dt id="arg-select">select<a class="anchor" aria-label="anchor" href="#arg-select"></a></dt>
<dd><p>character; select smooths in a fitted model</p></dd>


<dt id="arg-term">term<a class="anchor" aria-label="anchor" href="#arg-term"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> This argument has been
renamed <code>select</code></p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data frame containing the variables used in <code>smooth</code>.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>numeric; the number of points over the range of the covariate at
which to evaluate the smooth.</p></dd>


<dt id="arg-n-d">n_2d<a class="anchor" aria-label="anchor" href="#arg-n-d"></a></dt>
<dd><p>numeric; the number of new observations for each dimension of a
bivariate smooth. Not currently used; <code>n</code> is used for both dimensions.</p></dd>


<dt id="arg-n-d">n_3d<a class="anchor" aria-label="anchor" href="#arg-n-d"></a></dt>
<dd><p>numeric; the number of new observations to generate for the third
dimension of a 3D smooth.</p></dd>


<dt id="arg-n-d">n_4d<a class="anchor" aria-label="anchor" href="#arg-n-d"></a></dt>
<dd><p>numeric; the number of new observations to generate for the
dimensions higher than 2 (!) of a <em>k</em>D smooth (<em>k</em> &gt;= 4). For example, if
the smooth is a 4D smooth, each of dimensions 3 and 4 will get <code>n_4d</code>
new observations.</p></dd>


<dt id="arg-partial-match">partial_match<a class="anchor" aria-label="anchor" href="#arg-partial-match"></a></dt>
<dd><p>logical; in the case of character <code>select</code>, should
<code>select</code> match partially against <code>smooths</code>? If <code>partial_match = TRUE</code>,
<code>select</code> must only be a single string, a character vector of length 1.</p></dd>


<dt id="arg-knots">knots<a class="anchor" aria-label="anchor" href="#arg-knots"></a></dt>
<dd><p>a list or data frame with named components containing
knots locations. Names must match the covariates for which the basis
is required. See <code><a href="https://rdrr.io/pkg/mgcv/man/smoothCon.html" class="external-link">mgcv::smoothCon()</a></code>.</p></dd>


<dt id="arg-constraints">constraints<a class="anchor" aria-label="anchor" href="#arg-constraints"></a></dt>
<dd><p>logical; should identifiability constraints be applied to
the smooth basis. See argument <code>absorb.cons</code> in <code><a href="https://rdrr.io/pkg/mgcv/man/smoothCon.html" class="external-link">mgcv::smoothCon()</a></code>.</p></dd>


<dt id="arg-at">at<a class="anchor" aria-label="anchor" href="#arg-at"></a></dt>
<dd><p>a data frame containing values of the smooth covariate(s) at which
the basis should be evaluated.</p></dd>


<dt id="arg-diagonalize">diagonalize<a class="anchor" aria-label="anchor" href="#arg-diagonalize"></a></dt>
<dd><p>logical; if <code>TRUE</code>, reparameterizes the smooth such that
the associated penalty is an identity matrix. This has the effect of
turning the last diagonal elements of the penalty to zero, which highlights
the penalty null space.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Gavin L. Simpson</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="load_mgcv.html">load_mgcv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="data_sim.html">data_sim</a></span><span class="op">(</span><span class="st">"eg4"</span>, n <span class="op">=</span> <span class="fl">400</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bf</span> <span class="op">&lt;-</span> <span class="fu">basis</span><span class="op">(</span><span class="fu">s</span><span class="op">(</span><span class="va">x0</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bf</span> <span class="op">&lt;-</span> <span class="fu">basis</span><span class="op">(</span><span class="fu">s</span><span class="op">(</span><span class="va">x2</span>, by <span class="op">=</span> <span class="va">fac</span>, bs <span class="op">=</span> <span class="st">"bs"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>, constraints <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://fromthebottomoftheheap.net" class="external-link">Gavin L. Simpson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

