<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot estimated smooths from a fitted GAM — assemble.gam • gratia</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Plot estimated smooths from a fitted GAM — assemble.gam"><meta name="description" content="Plots estimated smooths from a fitted GAM model in a similar way to
mgcv::plot.gam() but instead of using base graphics, ggplot2::ggplot()
is used instead."><meta property="og:description" content="Plots estimated smooths from a fitted GAM model in a similar way to
mgcv::plot.gam() but instead of using base graphics, ggplot2::ggplot()
is used instead."><meta property="og:image" content="https://gavinsimpson.github.io/gratia/reference/figures/README-draw-gam-figure-1.png"><meta property="og:image:alt" content="Plot produced by draw() of 4 smooth functions from a fitted generalized additive model"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@ucfagls"><meta name="twitter:site" content="@ucfagls"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gratia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/gratia.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/custom-plotting.html">Customizing plots</a></li>
    <li><a class="dropdown-item" href="../articles/data-slices.html">Data slices</a></li>
    <li><a class="dropdown-item" href="../articles/posterior-simulation.html">Posterior Simulation</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gavinsimpson/gratia/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot estimated smooths from a fitted GAM</h1>
      <small class="dont-index">Source: <a href="https://github.com/gavinsimpson/gratia/blob/main/R/assemble.R" class="external-link"><code>R/assemble.R</code></a></small>
      <div class="d-none name"><code>assemble.gam.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots estimated smooths from a fitted GAM model in a similar way to
<code><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">mgcv::plot.gam()</a></code> but instead of using base graphics, <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code>
is used instead.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'gam'</span></span>
<span><span class="fu"><a href="assemble.html">assemble</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parametric <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  residuals <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"free"</span>, <span class="st">"fixed"</span><span class="op">)</span>,</span>
<span>  ci_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_3d <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  n_4d <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  unconditional <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overall_uncertainty <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  constant <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dist <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  rug <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  distinct_rug <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contour <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grouped_by <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ci_alpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  ci_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  smooth_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  resid_col <span class="op">=</span> <span class="st">"steelblue3"</span>,</span>
<span>  contour_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  n_contour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  partial_match <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  discrete_colour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  discrete_fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  continuous_colour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  continuous_fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  angle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nrow <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  guides <span class="op">=</span> <span class="st">"keep"</span>,</span>
<span>  widths <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  heights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  crs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  default_crs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lims_method <span class="op">=</span> <span class="st">"cross"</span>,</span>
<span>  wrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  caption <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a fitted GAM, the result of a call to <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">mgcv::gam()</a></code>.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional data frame that is used to supply the data at which
the smooths will be evaluated and plotted. This is usually not needed, but
is an option if you need fine control over exactly what data are used for
plotting.</p></dd>


<dt id="arg-select">select<a class="anchor" aria-label="anchor" href="#arg-select"></a></dt>
<dd><p>character, logical, or numeric; which smooths to plot. If
<code>NULL</code>, the default, then all model smooths are drawn. Numeric <code>select</code>
indexes the smooths in the order they are specified in the formula and
stored in <code>object</code>. Character <code>select</code> matches the labels for smooths
as shown for example in the output from <code>summary(object)</code>. Logical
<code>select</code> operates as per numeric <code>select</code> in the order that smooths are
stored.</p></dd>


<dt id="arg-parametric">parametric<a class="anchor" aria-label="anchor" href="#arg-parametric"></a></dt>
<dd><p>logical; plot parametric terms also? Note that <code>select</code> is
used for selecting which smooths to plot. The <code>terms</code> argument is used to
select which parametric effects are plotted. The default, as with
<code><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">mgcv::plot.gam()</a></code>, is to not draw parametric effects.</p></dd>


<dt id="arg-terms">terms<a class="anchor" aria-label="anchor" href="#arg-terms"></a></dt>
<dd><p>character; which model parametric terms should be drawn? The
Default of <code>NULL</code> will plot all parametric terms that can be drawn.</p></dd>


<dt id="arg-residuals">residuals<a class="anchor" aria-label="anchor" href="#arg-residuals"></a></dt>
<dd><p>logical; should partial residuals for a smooth be drawn?
Ignored for anything but a simple univariate smooth.</p></dd>


<dt id="arg-scales">scales<a class="anchor" aria-label="anchor" href="#arg-scales"></a></dt>
<dd><p>character; should all univariate smooths be plotted with the
same y-axis scale? If <code>scales = "free"</code>, the default, each univariate
smooth has its own y-axis scale. If <code>scales = "fixed"</code>, a common y axis
scale is used for all univariate smooths.</p>
<p>Currently does not affect the y-axis scale of plots of the parametric
terms.</p></dd>


<dt id="arg-ci-level">ci_level<a class="anchor" aria-label="anchor" href="#arg-ci-level"></a></dt>
<dd><p>numeric between 0 and 1; the coverage of credible interval.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>numeric; the number of points over the range of the covariate at
which to evaluate the smooth.</p></dd>


<dt id="arg-n-d">n_3d<a class="anchor" aria-label="anchor" href="#arg-n-d"></a></dt>
<dd><p>numeric; the number of new observations to generate for the third
dimension of a 3D smooth.</p></dd>


<dt id="arg-n-d">n_4d<a class="anchor" aria-label="anchor" href="#arg-n-d"></a></dt>
<dd><p>numeric; the number of new observations to generate for the
dimensions higher than 2 (!) of a <em>k</em>D smooth (<em>k</em> &gt;= 4). For example, if
the smooth is a 4D smooth, each of dimensions 3 and 4 will get <code>n_4d</code>
new observations.</p></dd>


<dt id="arg-unconditional">unconditional<a class="anchor" aria-label="anchor" href="#arg-unconditional"></a></dt>
<dd><p>logical; should confidence intervals include the
uncertainty due to smoothness selection? If <code>TRUE</code>, the corrected Bayesian
covariance matrix will be used.</p></dd>


<dt id="arg-overall-uncertainty">overall_uncertainty<a class="anchor" aria-label="anchor" href="#arg-overall-uncertainty"></a></dt>
<dd><p>logical; should the uncertainty in the model
constant term be included in the standard error of the evaluate values of
the smooth?</p></dd>


<dt id="arg-constant">constant<a class="anchor" aria-label="anchor" href="#arg-constant"></a></dt>
<dd><p>numeric; a constant to add to the estimated values of the
smooth. <code>constant</code>, if supplied, will be added to the estimated value
before the confidence band is computed.</p></dd>


<dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>function; a function that will be applied to the estimated values
and confidence interval before plotting. Can be a function or the name of a
function. Function <code>fun</code> will be applied after adding any <code>constant</code>, if
provided.</p></dd>


<dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>numeric; if greater than 0, this is used to determine when
a location is too far from data to be plotted when plotting 2-D smooths.
The data are scaled into the unit square before deciding what to exclude,
and <code>dist</code> is a distance within the unit square. See
<code><a href="https://rdrr.io/pkg/mgcv/man/exclude.too.far.html" class="external-link">mgcv::exclude.too.far()</a></code> for further details.</p></dd>


<dt id="arg-rug">rug<a class="anchor" aria-label="anchor" href="#arg-rug"></a></dt>
<dd><p>logical; draw a rug plot at the bottom of each plot for 1-D
smooths or plot locations of data for higher dimensions.</p></dd>


<dt id="arg-distinct-rug">distinct_rug<a class="anchor" aria-label="anchor" href="#arg-distinct-rug"></a></dt>
<dd><p>logical; should the data for the rug plots be reduced to
the distinct values?</p></dd>


<dt id="arg-contour">contour<a class="anchor" aria-label="anchor" href="#arg-contour"></a></dt>
<dd><p>logical; should contours be draw on the plot using
<code><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">ggplot2::geom_contour()</a></code>.</p></dd>


<dt id="arg-grouped-by">grouped_by<a class="anchor" aria-label="anchor" href="#arg-grouped-by"></a></dt>
<dd><p>logical; should factor by smooths be drawn as one panel
per level of the factor (<code>FALSE</code>, the default), or should the individual
smooths be combined into a single panel containing all levels (<code>TRUE</code>)?</p></dd>


<dt id="arg-ci-alpha">ci_alpha<a class="anchor" aria-label="anchor" href="#arg-ci-alpha"></a></dt>
<dd><p>numeric; alpha transparency for confidence or simultaneous
interval.</p></dd>


<dt id="arg-ci-col">ci_col<a class="anchor" aria-label="anchor" href="#arg-ci-col"></a></dt>
<dd><p>colour specification for the confidence/credible intervals
band. Affects the fill of the interval.</p></dd>


<dt id="arg-smooth-col">smooth_col<a class="anchor" aria-label="anchor" href="#arg-smooth-col"></a></dt>
<dd><p>colour specification for the smooth line.</p></dd>


<dt id="arg-resid-col">resid_col<a class="anchor" aria-label="anchor" href="#arg-resid-col"></a></dt>
<dd><p>colour specification for the partial residuals.</p></dd>


<dt id="arg-contour-col">contour_col<a class="anchor" aria-label="anchor" href="#arg-contour-col"></a></dt>
<dd><p>colour specification for contour lines.</p></dd>


<dt id="arg-n-contour">n_contour<a class="anchor" aria-label="anchor" href="#arg-n-contour"></a></dt>
<dd><p>numeric; the number of contour bins. Will result in
<code>n_contour - 1</code> contour lines being drawn. See <code><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">ggplot2::geom_contour()</a></code>.</p></dd>


<dt id="arg-partial-match">partial_match<a class="anchor" aria-label="anchor" href="#arg-partial-match"></a></dt>
<dd><p>logical; should smooths be selected by partial matches
with <code>select</code>? If <code>TRUE</code>, <code>select</code> can only be a single string to match
against.</p></dd>


<dt id="arg-discrete-colour">discrete_colour<a class="anchor" aria-label="anchor" href="#arg-discrete-colour"></a></dt>
<dd><p>a suitable colour scale to be used when plotting
discrete variables.</p></dd>


<dt id="arg-discrete-fill">discrete_fill<a class="anchor" aria-label="anchor" href="#arg-discrete-fill"></a></dt>
<dd><p>a suitable fill scale to be used when plotting
discrete variables.</p></dd>


<dt id="arg-continuous-colour">continuous_colour<a class="anchor" aria-label="anchor" href="#arg-continuous-colour"></a></dt>
<dd><p>a suitable colour scale to be used when plotting
continuous variables.</p></dd>


<dt id="arg-continuous-fill">continuous_fill<a class="anchor" aria-label="anchor" href="#arg-continuous-fill"></a></dt>
<dd><p>a suitable fill scale to be used when plotting
continuous variables.</p></dd>


<dt id="arg-position">position<a class="anchor" aria-label="anchor" href="#arg-position"></a></dt>
<dd><p>Position adjustment, either as a string, or the result of a
call to a position adjustment function.</p></dd>


<dt id="arg-angle">angle<a class="anchor" aria-label="anchor" href="#arg-angle"></a></dt>
<dd><p>numeric; the angle at which the x axis tick labels are to be
drawn passed to the <code>angle</code> argument of <code><a href="https://ggplot2.tidyverse.org/reference/guide_axis.html" class="external-link">ggplot2::guide_axis()</a></code>.</p></dd>


<dt id="arg-ncol-nrow">ncol, nrow<a class="anchor" aria-label="anchor" href="#arg-ncol-nrow"></a></dt>
<dd><p>numeric; the numbers of rows and columns over which to
spread the plots</p></dd>


<dt id="arg-guides">guides<a class="anchor" aria-label="anchor" href="#arg-guides"></a></dt>
<dd><p>character; one of <code>"keep"</code> (the default), <code>"collect"</code>, or
<code>"auto"</code>. Passed to <code><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">patchwork::plot_layout()</a></code></p></dd>


<dt id="arg-widths-heights">widths, heights<a class="anchor" aria-label="anchor" href="#arg-widths-heights"></a></dt>
<dd><p>The relative widths and heights of each column and
row in the grid. Will get repeated to match the dimensions of the grid. If
there is more than 1 plot and <code>widths = NULL</code>, the value of <code>widths</code> will
be set internally to <code>widths = 1</code> to accommodate plots of smooths that
use a fixed aspect ratio.</p></dd>


<dt id="arg-crs">crs<a class="anchor" aria-label="anchor" href="#arg-crs"></a></dt>
<dd><p>the coordinate reference system (CRS) to use for the plot. All
data will be projected into this CRS. See <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::coord_sf()</a></code> for
details.</p></dd>


<dt id="arg-default-crs">default_crs<a class="anchor" aria-label="anchor" href="#arg-default-crs"></a></dt>
<dd><p>the coordinate reference system (CRS) to use for the
non-sf layers in the plot. If left at the default <code>NULL</code>, the CRS used is
4326 (WGS84), which is appropriate for spline-on-the-sphere smooths, which
are parameterized in terms of latitude and longitude as coordinates. See
<code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::coord_sf()</a></code> for more details.</p></dd>


<dt id="arg-lims-method">lims_method<a class="anchor" aria-label="anchor" href="#arg-lims-method"></a></dt>
<dd><p>character; affects how the axis limits are determined. See
<code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::coord_sf()</a></code>. Be careful; in testing of some examples, changing
this to <code>"orthogonal"</code> for example with the chlorophyll-a example from
Simon Wood's GAM book quickly used up all the RAM in my test system and the
OS killed R. This could be incorrect usage on my part; right now the grid
of points at which SOS smooths are evaluated (if not supplied by the user)
can produce invalid coordinates for the corners of tiles as the grid is
generated for tile centres without respect to the spacing of those tiles.</p></dd>


<dt id="arg-wrap">wrap<a class="anchor" aria-label="anchor" href="#arg-wrap"></a></dt>
<dd><p>logical; wrap plots as a patchwork? If <code>FALSE</code>, a list of
ggplot objects is returned, 1 per term plotted.</p></dd>


<dt id="arg-caption">caption<a class="anchor" aria-label="anchor" href="#arg-caption"></a></dt>
<dd><p>logical; show the smooth type in the caption of each plot?</p></dd>


<dt id="arg-envir">envir<a class="anchor" aria-label="anchor" href="#arg-envir"></a></dt>
<dd><p>an environment to look up the data within.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments to other methods; not used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> objects.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Internally, plots of each smooth are created using <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code>
and composed into a single plot using <code><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">patchwork::wrap_plots()</a></code>. As a
result, it is not possible to use <code>+</code> to add to the plots in the way one
might typically work with <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> plots. Instead, use the <code>&amp;</code> operator;
see the examples.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Gavin L. Simpson</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="load_mgcv.html">load_mgcv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate some data</span></span></span>
<span class="r-in"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="data_sim.html">data_sim</a></span><span class="op">(</span><span class="st">"eg1"</span>, n <span class="op">=</span> <span class="fl">400</span>, dist <span class="op">=</span> <span class="st">"normal"</span>, scale <span class="op">=</span> <span class="fl">2</span>, seed <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># fit GAM</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">gam</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">x0</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x3</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df1</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># assemble plots of all smooths</span></span></span>
<span class="r-in"><span><span class="fu"><a href="assemble.html">assemble</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -- <span style="font-weight: bold;">Assembly of 4 plots</span> --</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1. s(x0)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2. s(x1)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 3. s(x2)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 4. s(x3)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># can be passed to patchwork::wrap_plots()</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://patchwork.data-imaginist.com" class="external-link">"patchwork"</a></span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="assemble.html">assemble</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="assemble.gam-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://fromthebottomoftheheap.net" class="external-link">Gavin L. Simpson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

