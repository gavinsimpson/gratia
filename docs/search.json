[{"path":[]},{"path":"https://gavinsimpson.github.io/gratia/CODE_OF_CONDUCT.html","id":"our-pledge","dir":"","previous_headings":"","what":"Our Pledge","title":"Contributor Covenant Code of Conduct","text":"members, contributors, leaders pledge make participation community harassment-free experience everyone, regardless age, body size, visible invisible disability, ethnicity, sex characteristics, gender identity expression, level experience, education, socio-economic status, nationality, personal appearance, race, religion, sexual identity orientation. pledge act interact ways contribute open, welcoming, diverse, inclusive, healthy community.","code":""},{"path":"https://gavinsimpson.github.io/gratia/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"Contributor Covenant Code of Conduct","text":"Examples behavior contributes positive environment community include: Demonstrating empathy kindness toward people respectful differing opinions, viewpoints, experiences Giving gracefully accepting constructive feedback Accepting responsibility apologizing affected mistakes, learning experience Focusing best just us individuals, overall community Examples unacceptable behavior include: use sexualized language imagery, sexual attention advances kind Trolling, insulting derogatory comments, personal political attacks Public private harassment Publishing others‚Äô private information, physical email address, without explicit permission conduct reasonably considered inappropriate professional setting","code":""},{"path":"https://gavinsimpson.github.io/gratia/CODE_OF_CONDUCT.html","id":"enforcement-responsibilities","dir":"","previous_headings":"","what":"Enforcement Responsibilities","title":"Contributor Covenant Code of Conduct","text":"Community leaders responsible clarifying enforcing standards acceptable behavior take appropriate fair corrective action response behavior deem inappropriate, threatening, offensive, harmful. Community leaders right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct, communicate reasons moderation decisions appropriate.","code":""},{"path":"https://gavinsimpson.github.io/gratia/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Contributor Covenant Code of Conduct","text":"Code Conduct applies within community spaces, also applies individual officially representing community public spaces. Examples representing community include using official e-mail address, posting via official social media account, acting appointed representative online offline event.","code":""},{"path":"https://gavinsimpson.github.io/gratia/CODE_OF_CONDUCT.html","id":"enforcement","dir":"","previous_headings":"","what":"Enforcement","title":"Contributor Covenant Code of Conduct","text":"Instances abusive, harassing, otherwise unacceptable behavior may reported package maintainer, Gavin Simpson (see email address CRAN package page) . complaints reviewed investigated promptly fairly. community leaders obligated respect privacy security reporter incident.","code":""},{"path":"https://gavinsimpson.github.io/gratia/CODE_OF_CONDUCT.html","id":"enforcement-guidelines","dir":"","previous_headings":"","what":"Enforcement Guidelines","title":"Contributor Covenant Code of Conduct","text":"Community leaders follow Community Impact Guidelines determining consequences action deem violation Code Conduct:","code":""},{"path":"https://gavinsimpson.github.io/gratia/CODE_OF_CONDUCT.html","id":"1-correction","dir":"","previous_headings":"Enforcement Guidelines","what":"1. Correction","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Use inappropriate language behavior deemed unprofessional unwelcome community. Consequence: private, written warning community leaders, providing clarity around nature violation explanation behavior inappropriate. public apology may requested.","code":""},{"path":"https://gavinsimpson.github.io/gratia/CODE_OF_CONDUCT.html","id":"2-warning","dir":"","previous_headings":"Enforcement Guidelines","what":"2. Warning","title":"Contributor Covenant Code of Conduct","text":"Community Impact: violation single incident series actions. Consequence: warning consequences continued behavior. interaction people involved, including unsolicited interaction enforcing Code Conduct, specified period time. includes avoiding interactions community spaces well external channels like social media. Violating terms may lead temporary permanent ban.","code":""},{"path":"https://gavinsimpson.github.io/gratia/CODE_OF_CONDUCT.html","id":"3-temporary-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"3. Temporary Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: serious violation community standards, including sustained inappropriate behavior. Consequence: temporary ban sort interaction public communication community specified period time. public private interaction people involved, including unsolicited interaction enforcing Code Conduct, allowed period. Violating terms may lead permanent ban.","code":""},{"path":"https://gavinsimpson.github.io/gratia/CODE_OF_CONDUCT.html","id":"4-permanent-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"4. Permanent Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Demonstrating pattern violation community standards, including sustained inappropriate behavior, harassment individual, aggression toward disparagement classes individuals. Consequence: permanent ban sort public interaction within community.","code":""},{"path":"https://gavinsimpson.github.io/gratia/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Contributor Covenant Code of Conduct","text":"Code Conduct adapted Contributor Covenant, version 2.0, available https://www.contributor-covenant.org/version/2/0/code_of_conduct.html. Community Impact Guidelines inspired Mozilla‚Äôs code conduct enforcement ladder. answers common questions code conduct, see FAQ https://www.contributor-covenant.org/faq. Translations available https://www.contributor-covenant.org/translations.","code":""},{"path":"https://gavinsimpson.github.io/gratia/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"The MIT License (MIT)","title":"The MIT License (MIT)","text":"Copyright (c) 2013-2020 Gavin L. Simpson Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://gavinsimpson.github.io/gratia/articles/gratia.html","id":"plotting","dir":"Articles","previous_headings":"","what":"Plotting","title":"Get started with gratia","text":"gratia provides draw() function produce plots using ggplot2 üì¶. draw estimated smooths GAM fitted , use  intended reasonable overview estimated model, offers limited option modify resulting plot. want full control, can obtain data used create plot smooth_estimates() evaluate smooths unevenly spaced values range covariate(s). want evaluate selected smooths, can specify via smooth argument. takes smooth labels names smooths known mgcv. list labels smooths use evaluate \\(f(x_2)\\) use can generate plot using ggplot2 package, example","code":"draw(m) sm <- smooth_estimates(m) sm #> # A tibble: 400 √ó 9 #>    smooth type  by       est    se       x0    x1    x2    x3 #>    <chr>  <chr> <chr>  <dbl> <dbl>    <dbl> <dbl> <dbl> <dbl> #>  1 s(x0)  TPRS  NA    -1.32  0.390 0.000239    NA    NA    NA #>  2 s(x0)  TPRS  NA    -1.24  0.365 0.0103      NA    NA    NA #>  3 s(x0)  TPRS  NA    -1.17  0.340 0.0204      NA    NA    NA #>  4 s(x0)  TPRS  NA    -1.09  0.318 0.0304      NA    NA    NA #>  5 s(x0)  TPRS  NA    -1.02  0.297 0.0405      NA    NA    NA #>  6 s(x0)  TPRS  NA    -0.947 0.279 0.0506      NA    NA    NA #>  7 s(x0)  TPRS  NA    -0.875 0.263 0.0606      NA    NA    NA #>  8 s(x0)  TPRS  NA    -0.803 0.249 0.0707      NA    NA    NA #>  9 s(x0)  TPRS  NA    -0.732 0.237 0.0807      NA    NA    NA #> 10 s(x0)  TPRS  NA    -0.662 0.228 0.0908      NA    NA    NA #> # ‚Ä¶ with 390 more rows smooths(m) #> [1] \"s(x0)\" \"s(x1)\" \"s(x2)\" \"s(x3)\" sm <- smooth_estimates(m, smooth = \"s(x2)\") sm #> # A tibble: 100 √ó 6 #>    smooth type  by        est    se      x2 #>    <chr>  <chr> <chr>   <dbl> <dbl>   <dbl> #>  1 s(x2)  TPRS  NA    -4.47   0.476 0.00359 #>  2 s(x2)  TPRS  NA    -4.00   0.406 0.0136  #>  3 s(x2)  TPRS  NA    -3.53   0.345 0.0237  #>  4 s(x2)  TPRS  NA    -3.06   0.295 0.0338  #>  5 s(x2)  TPRS  NA    -2.58   0.263 0.0438  #>  6 s(x2)  TPRS  NA    -2.09   0.250 0.0539  #>  7 s(x2)  TPRS  NA    -1.59   0.253 0.0639  #>  8 s(x2)  TPRS  NA    -1.08   0.264 0.0740  #>  9 s(x2)  TPRS  NA    -0.564  0.278 0.0841  #> 10 s(x2)  TPRS  NA    -0.0364 0.289 0.0941  #> # ‚Ä¶ with 90 more rows library(\"ggplot2\") library(\"dplyr\") #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union sm %>%   add_confint() %>%   ggplot(aes(y = est, x = x2)) +     geom_ribbon(aes(ymin = lower_ci, ymax = upper_ci),                 alpha = 0.2, fill = \"forestgreen\") +     geom_line(colour = \"forestgreen\", size = 1.5) +     labs(y = \"Partial effect\",          title = expression(\"Partial effect of\" ~ f(x[2])),          x = expression(x[2]))"},{"path":"https://gavinsimpson.github.io/gratia/articles/gratia.html","id":"model-diagnostics","dir":"Articles","previous_headings":"","what":"Model diagnostics","title":"Get started with gratia","text":"appraise() function provides standard diagnotic plots GAMs  plots produced (left--right, top--bottom), quantile-quantile (QQ) plot deviance residuals, scatterplot deviance residuals linear predictor, histogram deviance residuals, scatterplot observed vs fitted values. Adding partial residuals partial effect plots produced draw() can also help diagnose problems model, oversmoothing","code":"appraise(m) draw(m, residuals = TRUE)"},{"path":"https://gavinsimpson.github.io/gratia/articles/gratia.html","id":"want-to-learn-more","dir":"Articles","previous_headings":"","what":"Want to learn more?","title":"Get started with gratia","text":"gratia active development area development currently lacking documentation. find package, look help pages package look examples code help get going.","code":""},{"path":"https://gavinsimpson.github.io/gratia/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Gavin L. Simpson. Author, maintainer. Henrik Singmann. Contributor.","code":""},{"path":"https://gavinsimpson.github.io/gratia/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Simpson G (2022). gratia: Graceful ggplot-Based Graphics Functions GAMs Fitted using mgcv. R package version 0.7.0-4, https://gavinsimpson.github.io/gratia/.","code":"@Manual{,   title = {{gratia}: Graceful {ggplot}-Based Graphics and Other Functions                   for {GAM}s Fitted using {mgcv}},   author = {Gavin L. Simpson},   year = {2022},   abstract = {Graceful ggplot-based graphics and utility functions for              working with generalized additive models (GAMs) fitted using the              mgcv package. Provides a reimplementation of the plot() method for              GAMs that mgcv provides, as well as tidyverse-compatible              representations of estimated smooths.},   note = {R package version 0.7.0-4},   url = {https://gavinsimpson.github.io/gratia/}, }"},{"path":[]},{"path":"https://gavinsimpson.github.io/gratia/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Graceful ggplot-Based Graphics and Other Functions for GAMs Fitted Using mgcv","text":"Graceful ‚Äòggplot‚Äô-based graphics utility functions working generalized additive models (GAMs) fitted using ‚Äòmgcv‚Äô package. Provides reimplementation plot() method GAMs ‚Äòmgcv‚Äô provides, well ‚Äòtidyverse‚Äô compatible representations estimated smooths.","code":""},{"path":"https://gavinsimpson.github.io/gratia/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"Graceful ggplot-Based Graphics and Other Functions for GAMs Fitted Using mgcv","text":"main features gratia currently ggplot2-based replacement mgcv:::plot.gam(): draw.gam(). example, classic four term additive example Gu & Wahba: Estimated smooths GAM bivariate smooth: Estimated smooths GAM Note specialist smoothers (bs %% c(\"sos\",\"mrf\",\"\")) currently supported, univariate, factor continuous -variable smooths, simple random effect smooths (bs = 're'), factor-smooth interaction smooths (bs = \"fs\"), bivariate tensor product smooths supported, Estimatation derivatives fitted smoothers: derivatives(), Estimation point-wise across--function confidence intervals simultaneous intervals smooths: confint.gam(). Model diagnostics via appraise() Model diagnostics figure","code":""},{"path":"https://gavinsimpson.github.io/gratia/index.html","id":"installing-gratia","dir":"","previous_headings":"","what":"Installing gratia","title":"Graceful ggplot-Based Graphics and Other Functions for GAMs Fitted Using mgcv","text":"gratia now available CRAN, can installed however gratia active development may wish install development version github. easiest way via install_github() function package remotes. Make sure remotes installed, run install package.","code":"install.packages('gratia') remotes::install_github(\"gavinsimpson/gratia\")"},{"path":"https://gavinsimpson.github.io/gratia/index.html","id":"history","dir":"","previous_headings":"","what":"History","title":"Graceful ggplot-Based Graphics and Other Functions for GAMs Fitted Using mgcv","text":"gratia grew earlier package, schoenberg, development earlier package tsgam, originally intended used GAMs fitted time series. developing tsgam however became clear package used generally name ‚Äútsgam‚Äù longer appropriate. avoid breaking blog posts written using tsgam decided copy git repo history new repo package name schoenberg. later date someone released another package called schoenberg CRAN, scuppered idea. Now ‚Äôm calling package gratia. Hopefully won‚Äôt change ‚Ä¶","code":""},{"path":"https://gavinsimpson.github.io/gratia/index.html","id":"why-gratia","dir":"","previous_headings":"","what":"Why gratia?","title":"Graceful ggplot-Based Graphics and Other Functions for GAMs Fitted Using mgcv","text":"naming greta package, Nick Golding observed recent phenomena naming statistical modelling software, Stan Edward, individuals played prominent role development field. lead Nick name Tensor Flow-based package greta Grete Hermann. spirit, gratia named recognition contributions Grace Wahba, pioneering work penalised spline models foundation way GAMs estimated mgcv. wanted name package grace, explicitly recognise Grace‚Äôs contributions, unfortunately already package named Grace CRAN. looked elsewhere inspiration. English word ‚Äúgrace‚Äù derives Latin gratia, meaning ‚Äúfavor, charm, thanks‚Äù (according Merriam Webster). chair Grace Wabha currently holds named Isaac J Schoenberg, former University Madison-Wisconsin Professor Mathematics, 1946 paper provided first mathematical reference ‚Äúsplines‚Äù. (Hence previous name package.)","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_confint.html","id":null,"dir":"Reference","previous_headings":"","what":"Add a confidence interval to an existing object ‚Äî add_confint","title":"Add a confidence interval to an existing object ‚Äî add_confint","text":"Add confidence interval existing object","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_confint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add a confidence interval to an existing object ‚Äî add_confint","text":"","code":"add_confint(object, coverage = 0.95, ...)  # S3 method for smooth_estimates add_confint(object, coverage = 0.95, ...)  # S3 method for default add_confint(object, coverage = 0.95, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/add_confint.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add a confidence interval to an existing object ‚Äî add_confint","text":"object R object. coverage numeric; coverage interval. Must range 0 < coverage < 1. ... arguments passed methods.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_constant.html","id":null,"dir":"Reference","previous_headings":"","what":"Add a constant to estimated values ‚Äî add_constant","title":"Add a constant to estimated values ‚Äî add_constant","text":"Add constant estimated values","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_constant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add a constant to estimated values ‚Äî add_constant","text":"","code":"add_constant(object, constant = NULL, ...)  # S3 method for evaluated_smooth add_constant(object, constant = NULL, ...)  # S3 method for smooth_estimates add_constant(object, constant = NULL, ...)  # S3 method for mgcv_smooth add_constant(object, constant = NULL, ...)  # S3 method for parametric_effects add_constant(object, constant = NULL, ...)  # S3 method for tbl_df add_constant(object, constant = NULL, column = NULL, ...)  # S3 method for evaluated_parametric_term add_constant(object, constant = NULL, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/add_constant.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add a constant to estimated values ‚Äî add_constant","text":"object object add constant . constant constant add. ... additional arguments passed methods. column character; \"tbl_df\" method, column add constant .","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_constant.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add a constant to estimated values ‚Äî add_constant","text":"Returns object estimate shifted addition supplied constant.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_constant.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Add a constant to estimated values ‚Äî add_constant","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_fitted.gam.html","id":null,"dir":"Reference","previous_headings":"","what":"Add fitted values from a GAM to a data frame ‚Äî add_fitted.gam","title":"Add fitted values from a GAM to a data frame ‚Äî add_fitted.gam","text":"Add fitted values GAM data frame","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_fitted.gam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add fitted values from a GAM to a data frame ‚Äî add_fitted.gam","text":"","code":"# S3 method for gam add_fitted(data, model, value = \".value\", type = \"response\", prefix = \".\", ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/add_fitted.gam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add fitted values from a GAM to a data frame ‚Äî add_fitted.gam","text":"data data frame containing values variables used fit model. Passed stats::predict() newdata. model fitted model stats::predict() method available. S3 method dispatch performed model argument. value character; name variable model predictions stored. type character; type predictions return. See mgcv::predict.gam() options. prefix character; string prepend names predicted values type \"terms\", \"iterms\", \"lpmatrix\". prediction types result matrix values returned. prefix prepended names columns returned prediction types. ... additional arguments passed mgcv::predict.gam().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_fitted.gam.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add fitted values from a GAM to a data frame ‚Äî add_fitted.gam","text":"data frame (tibble) formed data predictions model.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_fitted.gam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add fitted values from a GAM to a data frame ‚Äî add_fitted.gam","text":"","code":"load_mgcv() # \\dontshow{ set.seed(1) op <- options(digits = 3, cli.unicode = FALSE) # } df <- gamSim(eg = 1, verbose = FALSE) df <- df[, c(\"y\",\"x0\",\"x1\",\"x2\",\"x3\")] m <-  gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = df, method = 'REML')  ## add_fitted(df, m) #> # A tibble: 400 x 6 #>          y     x0     x1     x2    x3 .value #>      <dbl>  <dbl>  <dbl>  <dbl> <dbl>  <dbl> #>  1  3.34   0.266  0.659  0.859  0.367   5.90 #>  2 -0.0758 0.372  0.185  0.0344 0.741   3.15 #>  3 10.7    0.573  0.954  0.971  0.934   8.28 #>  4  8.73   0.908  0.898  0.745  0.673   8.65 #>  5 15.0    0.202  0.944  0.273  0.701  15.7  #>  6  7.67   0.898  0.724  0.677  0.848   8.38 #>  7  7.58   0.945  0.370  0.348  0.706   7.84 #>  8  8.51   0.661  0.781  0.947  0.859   6.74 #>  9 10.6    0.629  0.0111 0.339  0.446   9.14 #> 10  3.72   0.0618 0.940  0.0317 0.677   7.04 #> # ... with 390 more rows  ## with type = \"terms\" or \"iterms\" add_fitted(df, m, type = \"terms\") #> # A tibble: 400 x 10 #>          y     x0     x1     x2    x3 .constant `.s(x0)` `.s(x1)` `.s(x2)` #>      <dbl>  <dbl>  <dbl>  <dbl> <dbl>     <dbl>    <dbl>    <dbl>    <dbl> #>  1  3.34   0.266  0.659  0.859  0.367      7.94   0.175     0.559   -2.81  #>  2 -0.0758 0.372  0.185  0.0344 0.741      7.94   0.435    -1.92    -3.23  #>  3 10.7    0.573  0.954  0.971  0.934      7.94   0.593     3.35    -3.47  #>  4  8.73   0.908  0.898  0.745  0.673      7.94  -0.812     2.77    -1.19  #>  5 15.0    0.202  0.944  0.273  0.701      7.94  -0.0589    3.23     4.63  #>  6  7.67   0.898  0.724  0.677  0.848      7.94  -0.745     1.15     0.146 #>  7  7.58   0.945  0.370  0.348  0.706      7.94  -1.07     -1.31     2.34  #>  8  8.51   0.661  0.781  0.947  0.859      7.94   0.434     1.67    -3.20  #>  9 10.6    0.629  0.0111 0.339  0.446      7.94   0.512    -1.95     2.63  #> 10  3.72   0.0618 0.940  0.0317 0.677      7.94  -0.695     3.20    -3.35  #> # ... with 390 more rows, and 1 more variable: `.s(x3)` <dbl> options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/add_fitted.html","id":null,"dir":"Reference","previous_headings":"","what":"Add fitted values from a model to a data frame ‚Äî add_fitted","title":"Add fitted values from a model to a data frame ‚Äî add_fitted","text":"Add fitted values model data frame","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_fitted.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add fitted values from a model to a data frame ‚Äî add_fitted","text":"","code":"add_fitted(data, model, value = \".value\", ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/add_fitted.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add fitted values from a model to a data frame ‚Äî add_fitted","text":"data data frame containing values variables used fit model. Passed stats::predict() newdata. model fitted model stats::predict() method available. S3 method dispatch performed model argument. value character; name variable model predictions stored. ... additional arguments passed methods.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_fitted.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add fitted values from a model to a data frame ‚Äî add_fitted","text":"data frame (tibble) formed data fitted values model.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_partial_residuals.html","id":null,"dir":"Reference","previous_headings":"","what":"Add partial residuals ‚Äî add_partial_residuals","title":"Add partial residuals ‚Äî add_partial_residuals","text":"Add partial residuals","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_partial_residuals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add partial residuals ‚Äî add_partial_residuals","text":"","code":"add_partial_residuals(data, model, ...)  # S3 method for gam add_partial_residuals(data, model, select = NULL, partial_match = FALSE, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/add_partial_residuals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add partial residuals ‚Äî add_partial_residuals","text":"data data frame containing values variables used fit model. Passed stats::residuals() newdata. model fitted model stats::residuals() method available. S3 method dispatch performed model argument. ... arguments passed methods. select character, logical, numeric; smooths plot. NULL, default, model smooths drawn. Numeric select indexes smooths order specified formula stored object. Character select matches labels smooths shown example output summary(object). Logical select operates per numeric select order smooths stored. partial_match logical; smooths selected partial matches select? TRUE, select can single string match .","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_partial_residuals.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add partial residuals ‚Äî add_partial_residuals","text":"","code":"load_mgcv() # \\dontshow{ op <- options(digits = 4, cli.unicode = FALSE) # } df <- data_sim(\"eg1\", seed = 1) df <- df[, c(\"y\",\"x0\",\"x1\",\"x2\",\"x3\")] m <-  gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = df, method = 'REML')  ## add partial residuals add_partial_residuals(df, m) #> # A tibble: 400 x 9 #>          y     x0     x1     x2    x3 `s(x0)` `s(x1)` `s(x2)` `s(x3)` #>      <dbl>  <dbl>  <dbl>  <dbl> <dbl>   <dbl>   <dbl>   <dbl>   <dbl> #>  1  3.34   0.266  0.659  0.859  0.367  -2.38   -2.00   -5.36  -2.52   #>  2 -0.0758 0.372  0.185  0.0344 0.741  -2.79   -5.15   -6.45  -3.29   #>  3 10.7    0.573  0.954  0.971  0.934   2.99    5.75   -1.07   2.28   #>  4  8.73   0.908  0.898  0.745  0.673  -0.734   2.84   -1.11   0.0287 #>  5 15.0    0.202  0.944  0.273  0.701  -0.752   2.54    3.94  -0.750  #>  6  7.67   0.898  0.724  0.677  0.848  -1.46    0.432  -0.567 -0.812  #>  7  7.58   0.945  0.370  0.348  0.706  -1.33   -1.57    2.08  -0.318  #>  8  8.51   0.661  0.781  0.947  0.859   2.21    3.44   -1.42   1.68   #>  9 10.6    0.629  0.0111 0.339  0.446   2.01   -0.445   4.13   1.51   #> 10  3.72   0.0618 0.940  0.0317 0.677  -4.02   -0.123  -6.67  -3.37   #> # ... with 390 more rows  ## add partial residuals for selected smooths add_partial_residuals(df, m, select = \"s(x0)\") #> # A tibble: 400 x 6 #>          y     x0     x1     x2    x3 `s(x0)` #>      <dbl>  <dbl>  <dbl>  <dbl> <dbl>   <dbl> #>  1  3.34   0.266  0.659  0.859  0.367  -2.38  #>  2 -0.0758 0.372  0.185  0.0344 0.741  -2.79  #>  3 10.7    0.573  0.954  0.971  0.934   2.99  #>  4  8.73   0.908  0.898  0.745  0.673  -0.734 #>  5 15.0    0.202  0.944  0.273  0.701  -0.752 #>  6  7.67   0.898  0.724  0.677  0.848  -1.46  #>  7  7.58   0.945  0.370  0.348  0.706  -1.33  #>  8  8.51   0.661  0.781  0.947  0.859   2.21  #>  9 10.6    0.629  0.0111 0.339  0.446   2.01  #> 10  3.72   0.0618 0.940  0.0317 0.677  -4.02  #> # ... with 390 more rows options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/add_residuals.gam.html","id":null,"dir":"Reference","previous_headings":"","what":"Add residuals from a GAM to a data frame ‚Äî add_residuals.gam","title":"Add residuals from a GAM to a data frame ‚Äî add_residuals.gam","text":"Add residuals GAM data frame","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_residuals.gam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add residuals from a GAM to a data frame ‚Äî add_residuals.gam","text":"","code":"# S3 method for gam add_residuals(data, model, value = \".residual\", type = \"deviance\", ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/add_residuals.gam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add residuals from a GAM to a data frame ‚Äî add_residuals.gam","text":"data data frame containing values variables used fit model. Passed stats::predict() newdata. model fitted model stats::predict() method available. S3 method dispatch performed model argument. value character; name variable model predictions stored. type character; type residuals return. See mgcv::residuals.gam() options. ... additional arguments passed mgcv::residuals.gam().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_residuals.gam.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add residuals from a GAM to a data frame ‚Äî add_residuals.gam","text":"data frame (tibble) formed data residuals model.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_residuals.gam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add residuals from a GAM to a data frame ‚Äî add_residuals.gam","text":"","code":"load_mgcv() # \\dontshow{ set.seed(1) op <- options(digits = 5, cli.unicode = FALSE) # } df <- gamSim(eg = 1, verbose = FALSE) df <- df[, c(\"y\",\"x0\",\"x1\",\"x2\",\"x3\")] m <-  gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = df, method = 'REML')  ## add_residuals(df, m) #> # A tibble: 400 x 6 #>          y     x0     x1     x2    x3 .residual #>      <dbl>  <dbl>  <dbl>  <dbl> <dbl>     <dbl> #>  1  3.34   0.266  0.659  0.859  0.367   -2.56   #>  2 -0.0758 0.372  0.185  0.0344 0.741   -3.22   #>  3 10.7    0.573  0.954  0.971  0.934    2.40   #>  4  8.73   0.908  0.898  0.745  0.673    0.0785 #>  5 15.0    0.202  0.944  0.273  0.701   -0.693  #>  6  7.67   0.898  0.724  0.677  0.848   -0.714  #>  7  7.58   0.945  0.370  0.348  0.706   -0.259  #>  8  8.51   0.661  0.781  0.947  0.859    1.78   #>  9 10.6    0.629  0.0111 0.339  0.446    1.50   #> 10  3.72   0.0618 0.940  0.0317 0.677   -3.32   #> # ... with 390 more rows options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/add_residuals.html","id":null,"dir":"Reference","previous_headings":"","what":"Add residuals from a model to a data frame ‚Äî add_residuals","title":"Add residuals from a model to a data frame ‚Äî add_residuals","text":"Add residuals model data frame","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_residuals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add residuals from a model to a data frame ‚Äî add_residuals","text":"","code":"add_residuals(data, model, value = \".residual\", ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/add_residuals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add residuals from a model to a data frame ‚Äî add_residuals","text":"data data frame containing values variables used fit model. Passed stats::residuals() newdata. model fitted model stats::residuals() method available. S3 method dispatch performed model argument. value character; name variable model residuals stored. ... additional arguments passed methods.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/add_residuals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add residuals from a model to a data frame ‚Äî add_residuals","text":"data frame (tibble) formed data residuals model.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/appraise.html","id":null,"dir":"Reference","previous_headings":"","what":"Model diagnostic plots ‚Äî appraise","title":"Model diagnostic plots ‚Äî appraise","text":"Model diagnostic plots","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/appraise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model diagnostic plots ‚Äî appraise","text":"","code":"appraise(model, ...)  # S3 method for gam appraise(   model,   method = c(\"uniform\", \"simulate\", \"normal\", \"direct\"),   n_uniform = 10,   n_simulate = 50,   type = c(\"deviance\", \"pearson\", \"response\"),   n_bins = c(\"sturges\", \"scott\", \"fd\"),   ncol = NULL,   nrow = NULL,   guides = \"keep\",   level = 0.9,   ci_col = \"black\",   ci_alpha = 0.2,   point_col = \"black\",   point_alpha = 1,   line_col = \"red\",   ... )  # S3 method for lm appraise(model, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/appraise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model diagnostic plots ‚Äî appraise","text":"model fitted model. Currently class \"gam\". ... arguments passed patchwork::wrap_plots(). method character; method used generate theoretical quantiles. Note method = \"direct\" deprecated favour method = \"uniform\". n_uniform numeric; number times randomize uniform quantiles direct computation method (method = \"direct\") QQ plots. n_simulate numeric; number data sets simulate estimated model using simulation method (method = \"simulate\") QQ plots. type character; type residuals use. \"deviance\", \"response\", \"pearson\" residuals allowed. n_bins character numeric; either number bins string indicating calculate number bins. ncol, nrow numeric; numbers rows columns spread plots. guides character; one \"keep\" (default), \"collect\", \"auto\". Passed patchwork::plot_layout() level numeric; coverage level QQ plot reference intervals. Must strictly 0 < level < 1. used method = \"simulate\". ci_alpha, ci_col numeric; level alpha transparency QQ plot reference interval method = \"simulate\", points drawn plots. point_col, point_alpha colour transparency used draw points plots. See graphics::par() section Color Specification. passed individual plotting functions, therefore affects points plots. line_col colour specification 1:1 line QQ plot reference line residuals vs linear predictor plot.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/appraise.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Model diagnostic plots ‚Äî appraise","text":"wording used mgcv::qq.gam() uses direct reference simulated residuals method (method = \"simulated\"). avoid confusion, method = \"direct\" deprecated favour method = \"uniform\".","code":""},{"path":[]},{"path":"https://gavinsimpson.github.io/gratia/reference/appraise.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Model diagnostic plots ‚Äî appraise","text":"","code":"load_mgcv() set.seed(2) ## simulate some data... dat <- gamSim(1, n = 400, dist = \"normal\", scale = 2) #> Gu & Wahba 4 term additive model mod <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat) ## run some basic model checks appraise(mod, point_col = \"steelblue\", point_alpha = 0.4)   ## To change the theme for all panels use the & operator, for example to  ## change the ggplot theme for all panels library(\"ggplot2\") appraise(mod, point_col = \"steelblue\", point_alpha = 0.4,          line_col = \"black\") & theme_minimal()"},{"path":"https://gavinsimpson.github.io/gratia/reference/basis.html","id":null,"dir":"Reference","previous_headings":"","what":"Basis expansions for smooths ‚Äî basis","title":"Basis expansions for smooths ‚Äî basis","text":"Creates basis expansion definition smoother using syntax mgcv's smooths via mgcv::s()., mgcv::te(), mgcv::ti(), mgcv::t2().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/basis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basis expansions for smooths ‚Äî basis","text":"","code":"basis(smooth, data, knots = NULL, constraints = FALSE, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/basis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Basis expansions for smooths ‚Äî basis","text":"smooth smooth specification, result call one mgcv::s()., mgcv::te(), mgcv::ti(), mgcv::t2(). data data frame containing variables used smooth. knots list data frame named components containing knots locations. Names must match covariates basis required. See mgcv::smoothCon(). constraints logical; identifiability constraints applied smooth basis. See argument absorb.cons mgcv::smoothCon(). ... arguments passed mgcv::smoothCon().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/basis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Basis expansions for smooths ‚Äî basis","text":"tibble.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/basis.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Basis expansions for smooths ‚Äî basis","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/basis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Basis expansions for smooths ‚Äî basis","text":"","code":"load_mgcv() # \\dontshow{ set.seed(42) op <- options(digits = 3, cli.unicode = FALSE) # } df <- gamSim(4, n = 400, verbose = FALSE)  bf <- basis(s(x0), data = df) bf <- basis(s(x2, by = fac, bs = 'bs'), data = df, constraints = TRUE) options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/bird_move.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated bird migration data ‚Äî bird_move","title":"Simulated bird migration data ‚Äî bird_move","text":"Data generated hypothetical study bird movement along migration corridor, sampled throughout year. dataset consists simulated sample records numbers observed locations 100 tagged individuals six species bird, ten locations along latitudinal gradient, one observation taken every four weeks. Counts simulated randomly species location week creating species-specific migration curve gave probability finding individual given species given location, simulated distribution individuals across sites using multinomial distribution, subsampling using binomial distribution simulation observation error (.e. every bird present location detected). data set (bird_move) consists variables count, latitude, week species.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/bird_move.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated bird migration data ‚Äî bird_move","text":"data frame","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/bird_move.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Simulated bird migration data ‚Äî bird_move","text":"Pedersen EJ, Miller DL, Simpson GL, Ross N. 2018. Hierarchical generalized additive models: introduction mgcv. PeerJ Preprints 6:e27320v1 doi: 10.7287/peerj.preprints.27320v1 .","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/check_user_select_smooths.html","id":null,"dir":"Reference","previous_headings":"","what":"Select smooths based on user's choices ‚Äî check_user_select_smooths","title":"Select smooths based on user's choices ‚Äî check_user_select_smooths","text":"Given vector indexing smooths GAM, returns logical vector selecting requested smooths.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/check_user_select_smooths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select smooths based on user's choices ‚Äî check_user_select_smooths","text":"","code":"check_user_select_smooths(   smooths,   select = NULL,   partial_match = FALSE,   model_name = NULL )"},{"path":"https://gavinsimpson.github.io/gratia/reference/check_user_select_smooths.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select smooths based on user's choices ‚Äî check_user_select_smooths","text":"smooths character; vector smooth labels. select numeric, logical, character vector selected smooths. partial_match logical; case character select, select match partially smooths? partial_match = TRUE, select must single string, character vector length 1. model_name character; model name used error messages.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/check_user_select_smooths.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select smooths based on user's choices ‚Äî check_user_select_smooths","text":"logical vector length length(smooths) indicating smooths selected.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/check_user_select_smooths.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Select smooths based on user's choices ‚Äî check_user_select_smooths","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/coef.scam.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract coefficients from a fitted scam model. ‚Äî coef.scam","title":"Extract coefficients from a fitted scam model. ‚Äî coef.scam","text":"Extract coefficients fitted scam model.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/coef.scam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract coefficients from a fitted scam model. ‚Äî coef.scam","text":"","code":"# S3 method for scam coef(object, parametrized = TRUE, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/coef.scam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract coefficients from a fitted scam model. ‚Äî coef.scam","text":"object model object fitted scam() parametrized logical; extract parametrized coefficients, respect linear inequality constraints model. ... arguments.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/compare_smooths.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare smooths across models ‚Äî compare_smooths","title":"Compare smooths across models ‚Äî compare_smooths","text":"Compare smooths across models","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/compare_smooths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare smooths across models ‚Äî compare_smooths","text":"","code":"compare_smooths(   model,   ...,   smooths = NULL,   n = 100,   data = NULL,   unconditional = FALSE,   overall_uncertainty = TRUE )"},{"path":"https://gavinsimpson.github.io/gratia/reference/compare_smooths.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare smooths across models ‚Äî compare_smooths","text":"model Primary model comparison. ... Additional models compare smooths model. smooths character; vector smooths compare. specified comparisons performed smooths common models supplied. n numeric; number points range covariate evaluate smooth. data data frame covariate values evaluate smooth. unconditional logical; confidence intervals include uncertainty due smoothness selection? TRUE, corrected Bayesian covariance matrix used. overall_uncertainty logical; uncertainty model constant term included standard error evaluate values smooth?","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/compare_smooths.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare smooths across models ‚Äî compare_smooths","text":"","code":"op <- options(cli.unicode = FALSE, digits = 5) load_mgcv() dat <- data_sim(\"eg1\", seed = 2)  ## models to compare smooths across - artificially create differences m1 <- gam(y ~ s(x0, k = 5) + s(x1, k = 5) + s(x2, k = 5) + s(x3, k = 5),           data = dat, method = \"REML\") m2 <- gam(y ~ s(x0, bs = 'ts') + s(x1, bs = 'ts') + s(x2, bs = 'ts') +           s(x3, bs = 'ts'), data = dat, method = \"REML\")  ## build comparisons comp <- compare_smooths(m1, m2) comp #> # A tibble: 8 x 5 #>   model smooth type          by    data               #>   <chr> <chr>  <chr>         <chr> <list>             #> 1 m1    s(x0)  TPRS          NA    <tibble [100 x 3]> #> 2 m2    s(x0)  TPRS (shrink) NA    <tibble [100 x 3]> #> 3 m1    s(x1)  TPRS          NA    <tibble [100 x 3]> #> 4 m2    s(x1)  TPRS (shrink) NA    <tibble [100 x 3]> #> 5 m1    s(x2)  TPRS          NA    <tibble [100 x 3]> #> 6 m2    s(x2)  TPRS (shrink) NA    <tibble [100 x 3]> #> 7 m1    s(x3)  TPRS          NA    <tibble [100 x 3]> #> 8 m2    s(x3)  TPRS (shrink) NA    <tibble [100 x 3]> ## notice that the result is a nested tibble  draw(comp)  options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/confint.fderiv.html","id":null,"dir":"Reference","previous_headings":"","what":"Point-wise and simultaneous confidence intervals for derivatives of smooths ‚Äî confint.fderiv","title":"Point-wise and simultaneous confidence intervals for derivatives of smooths ‚Äî confint.fderiv","text":"Calculates point-wise confidence simultaneous intervals first derivatives smooth terms fitted GAM.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/confint.fderiv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Point-wise and simultaneous confidence intervals for derivatives of smooths ‚Äî confint.fderiv","text":"","code":"# S3 method for fderiv confint(   object,   parm,   level = 0.95,   type = c(\"confidence\", \"simultaneous\"),   nsim = 10000,   ncores = 1L,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/confint.fderiv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Point-wise and simultaneous confidence intervals for derivatives of smooths ‚Äî confint.fderiv","text":"object object class \"fderiv\" containing estimated derivatives. parm parameters (smooth terms) given intervals vector terms. missing, parameters considered. level numeric, 0 < level < 1; confidence level point-wise simultaneous interval. default 0.95 95% interval. type character; type interval compute. One \"confidence\" point-wise intervals, \"simultaneous\" simultaneous intervals. nsim integer; number simulations used computing simultaneous intervals. ncores number cores generating random variables multivariate normal distribution. Passed mvnfast::rmvn(). Parallelization take place OpenMP supported (appears work Windows current R). ... additional arguments methods","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/confint.fderiv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Point-wise and simultaneous confidence intervals for derivatives of smooths ‚Äî confint.fderiv","text":"data frame components: term; factor indicating term row relates, lower; lower limit confidence simultaneous interval, est; estimated derivative upper; upper limit confidence simultaneous interval.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/confint.fderiv.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Point-wise and simultaneous confidence intervals for derivatives of smooths ‚Äî confint.fderiv","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/confint.fderiv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Point-wise and simultaneous confidence intervals for derivatives of smooths ‚Äî confint.fderiv","text":"","code":"load_mgcv() # \\dontshow{ set.seed(2) op <- options(digits = 3, cli.unicode = FALSE) # } dat <- gamSim(1, n = 1000, dist = \"normal\", scale = 2) #> Gu & Wahba 4 term additive model mod <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = \"REML\")  ## first derivatives of all smooths... fd <- fderiv(mod) #> Warning: `fderiv()` was deprecated in gratia 0.7.0. #> Please use `derivatives()` instead. #> This warning is displayed once every 8 hours. #> Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.  ## point-wise interval ci <- confint(fd, type = \"confidence\") head(ci) #>    term lower  est upper #> 1 s(x0)  1.22 6.02  10.8 #> 2 s(x0)  1.22 6.02  10.8 #> 3 s(x0)  1.22 6.02  10.8 #> 4 s(x0)  1.23 6.01  10.8 #> 5 s(x0)  1.25 6.01  10.8 #> 6 s(x0)  1.27 6.01  10.7  ## simultaneous interval for smooth term of x1 # \\dontshow{ set.seed(42) # } x1.sint <- confint(fd, parm = \"x1\", type = \"simultaneous\", nsim = 2500) head(x1.sint) #>    term  lower  est upper #> 1 s(x1) -0.483 4.70  9.88 #> 2 s(x1) -0.482 4.70  9.88 #> 3 s(x1) -0.478 4.70  9.87 #> 4 s(x1) -0.469 4.70  9.86 #> 5 s(x1) -0.452 4.70  9.84 #> 6 s(x1) -0.427 4.69  9.81 options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/confint.gam.html","id":null,"dir":"Reference","previous_headings":"","what":"Point-wise and simultaneous confidence intervals for smooths ‚Äî confint.gam","title":"Point-wise and simultaneous confidence intervals for smooths ‚Äî confint.gam","text":"Calculates point-wise confidence simultaneous intervals smooth terms fitted GAM.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/confint.gam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Point-wise and simultaneous confidence intervals for smooths ‚Äî confint.gam","text":"","code":"# S3 method for gam confint(   object,   parm,   level = 0.95,   newdata = NULL,   n = 200,   type = c(\"confidence\", \"simultaneous\"),   nsim = 10000,   shift = FALSE,   transform = FALSE,   unconditional = FALSE,   ncores = 1,   partial_match = FALSE,   ... )  # S3 method for gamm confint(object, ...)  # S3 method for list confint(object, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/confint.gam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Point-wise and simultaneous confidence intervals for smooths ‚Äî confint.gam","text":"object object class \"gam\" \"gamm\". parm parameters (smooth terms) given intervals vector terms. missing, parameters considered, although currently implemented. level numeric, 0 < level < 1; confidence level point-wise simultaneous interval. default 0.95 95% interval. newdata data frame; containing new values covariates used model fit. selected smooth(s) wil evaluated supplied values. n numeric; number points evaluate smooths . type character; type interval compute. One \"confidence\" point-wise intervals, \"simultaneous\" simultaneous intervals. nsim integer; number simulations used computing simultaneous intervals. shift logical; constant term add smooth? transform logical; smooth evaluated transformed scale? generalised models, involves applying inverse link function used fit model. Alternatively, name , actual, function can supplied transform smooth confidence interval. unconditional logical; TRUE (freq == FALSE) Bayesian smoothing parameter uncertainty corrected covariance matrix returned, available. ncores number cores generating random variables multivariate normal distribution. Passed mvnfast::rmvn(). Parallelization take place OpenMP supported (appears work Windows current R). partial_match logical; matching parm use partial match exact match? Can used length(parm) 1. ... additional arguments methods","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/confint.gam.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Point-wise and simultaneous confidence intervals for smooths ‚Äî confint.gam","text":"data frame components: term; factor indicating term row relates, x; vector values smooth evaluated, lower; lower limit confidence simultaneous interval, est; estimated value smooth upper; upper limit confidence simultaneous interval, crit; critical value 100 * level% confidence interval.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/confint.gam.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Point-wise and simultaneous confidence intervals for smooths ‚Äî confint.gam","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/confint.gam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Point-wise and simultaneous confidence intervals for smooths ‚Äî confint.gam","text":"","code":"load_mgcv() # \\dontshow{ set.seed(2) op <- options(digits = 4, cli.unicode = FALSE) # } dat <- gamSim(1, n = 500, dist = \"normal\", scale = 2) #> Gu & Wahba 4 term additive model mod <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = \"REML\")  ## point-wise interval ci <- confint(mod, parm = \"s(x1)\", type = \"confidence\") #> Warning: `evaluate_smooth()` was deprecated in gratia 0.7.0. #> Please use `smooth_estimates()` instead. #> This warning is displayed once every 8 hours. #> Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated. ci #> # A tibble: 200 x 8 #>    smooth by_variable      x1   est    se  crit lower upper #>    <chr>  <fct>         <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> #>  1 s(x1)  NA          0.00251 -2.04 0.296  1.96 -2.62 -1.46 #>  2 s(x1)  NA          0.00752 -2.04 0.287  1.96 -2.60 -1.47 #>  3 s(x1)  NA          0.0125  -2.03 0.279  1.96 -2.58 -1.49 #>  4 s(x1)  NA          0.0175  -2.03 0.270  1.96 -2.56 -1.50 #>  5 s(x1)  NA          0.0225  -2.02 0.262  1.96 -2.54 -1.51 #>  6 s(x1)  NA          0.0276  -2.02 0.254  1.96 -2.52 -1.52 #>  7 s(x1)  NA          0.0326  -2.01 0.246  1.96 -2.50 -1.53 #>  8 s(x1)  NA          0.0376  -2.01 0.239  1.96 -2.48 -1.54 #>  9 s(x1)  NA          0.0426  -2.01 0.232  1.96 -2.46 -1.55 #> 10 s(x1)  NA          0.0476  -2.00 0.226  1.96 -2.44 -1.56 #> # ... with 190 more rows  ## simultaneous interval for smooth term of x1 # \\dontshow{ set.seed(42) # } si <- confint(mod, parm = \"s(x1)\", type = \"simultaneous\", nsim = 100) si #> # A tibble: 200 x 8 #>    smooth by_variable      x1   est    se  crit lower upper #>    <chr>  <fct>         <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> #>  1 s(x1)  NA          0.00251 -2.04 0.296  2.49 -2.78 -1.30 #>  2 s(x1)  NA          0.00752 -2.04 0.287  2.49 -2.75 -1.32 #>  3 s(x1)  NA          0.0125  -2.03 0.279  2.49 -2.73 -1.34 #>  4 s(x1)  NA          0.0175  -2.03 0.270  2.49 -2.70 -1.35 #>  5 s(x1)  NA          0.0225  -2.02 0.262  2.49 -2.68 -1.37 #>  6 s(x1)  NA          0.0276  -2.02 0.254  2.49 -2.65 -1.39 #>  7 s(x1)  NA          0.0326  -2.01 0.246  2.49 -2.63 -1.40 #>  8 s(x1)  NA          0.0376  -2.01 0.239  2.49 -2.61 -1.41 #>  9 s(x1)  NA          0.0426  -2.01 0.232  2.49 -2.58 -1.43 #> 10 s(x1)  NA          0.0476  -2.00 0.226  2.49 -2.56 -1.44 #> # ... with 190 more rows # \\dontshow{ options(op) # }"},{"path":"https://gavinsimpson.github.io/gratia/reference/data_combos.html","id":null,"dir":"Reference","previous_headings":"","what":"All combinations of factor levels plus typical values of continuous variables ‚Äî data_combos","title":"All combinations of factor levels plus typical values of continuous variables ‚Äî data_combos","text":"combinations factor levels plus typical values continuous variables","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/data_combos.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"All combinations of factor levels plus typical values of continuous variables ‚Äî data_combos","text":"","code":"data_combos(object, ...)  # S3 method for gam data_combos(object, vars = everything(), complete = TRUE, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/data_combos.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"All combinations of factor levels plus typical values of continuous variables ‚Äî data_combos","text":"object fitted model object. ... arguments passed methods. vars terms include exclude returned object. Uses tidyselect principles. complete logical; combinations factor levels returned? FALSE, combinations levels observed model retained.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/data_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate example data for fitting GAMs ‚Äî data_sim","title":"Simulate example data for fitting GAMs ‚Äî data_sim","text":"tidy reimplementation functions implemented mgcv::gamSim() can used fit GAMs. new feature sampling distribution can applied example types.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/data_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate example data for fitting GAMs ‚Äî data_sim","text":"","code":"data_sim(   model = \"eg1\",   n = 400,   scale = 2,   dist = c(\"normal\", \"poisson\", \"binary\"),   seed = NULL )"},{"path":"https://gavinsimpson.github.io/gratia/reference/data_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate example data for fitting GAMs ‚Äî data_sim","text":"model character; either \"egX\" X integer 1:7, name model. See Details possible options. n numeric; number observations simulate. scale numeric; level noise use. dist character; sampling distribution response variable. seed numeric; seed random number generator. Passed base::set.seed().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/data_sim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate example data for fitting GAMs ‚Äî data_sim","text":"","code":"# \\dontshow{ set.seed(1) op <- options(digits = 5, cli.unicode = FALSE) # } data_sim(\"eg1\") #> # A tibble: 400 x 10 #>          y     x0     x1     x2    x3     f    f0    f1        f2    f3 #>      <dbl>  <dbl>  <dbl>  <dbl> <dbl> <dbl> <dbl> <dbl>     <dbl> <dbl> #>  1  3.34   0.266  0.659  0.859  0.367  5.51 1.48   3.74 0.298         0 #>  2 -0.0758 0.372  0.185  0.0344 0.741  3.58 1.84   1.45 0.288         0 #>  3 10.7    0.573  0.954  0.971  0.934  8.69 1.95   6.74 0.0000861     0 #>  4  8.73   0.908  0.898  0.745  0.673  8.75 0.569  6.02 2.16          0 #>  5 15.0    0.202  0.944  0.273  0.701 16.2  1.18   6.60 8.40          0 #>  6  7.67   0.898  0.724  0.677  0.848  8.03 0.628  4.25 3.15          0 #>  7  7.58   0.945  0.370  0.348  0.706  8.44 0.346  2.10 5.99          0 #>  8  8.51   0.661  0.781  0.947  0.859  6.52 1.75   4.77 0.00243       0 #>  9 10.6    0.629  0.0111 0.339  0.446  9.19 1.84   1.02 6.33          0 #> 10  3.72   0.0618 0.940  0.0317 0.677  7.17 0.386  6.56 0.231         0 #> # ... with 390 more rows options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/data_slice.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare a data slice through covariates ‚Äî data_slice","title":"Prepare a data slice through covariates ‚Äî data_slice","text":"Prepare data slice covariates","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/data_slice.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare a data slice through covariates ‚Äî data_slice","text":"","code":"data_slice(object, ...)  # S3 method for default data_slice(object, ...)  # S3 method for gam data_slice(   object,   var1,   var2 = NULL,   var3 = NULL,   var4 = NULL,   data = NULL,   n = 50,   offset = NULL,   ... )  # S3 method for list data_slice(object, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/data_slice.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare a data slice through covariates ‚Äî data_slice","text":"object R model object. ... arguments passed methods. var1 character; var2 character; var3 character; ignored currently. var4 character; ignored currently. data 1-row data frame tibble containing values variables fitted model varying slice. n numeric; number values create var1 var2in slice. offset numeric; value use offset term model.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/datagen.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate data over the range of variables used in smooths ‚Äî datagen","title":"Generate data over the range of variables used in smooths ‚Äî datagen","text":"smooth GAM, generate new data range variables involved smooth.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/datagen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate data over the range of variables used in smooths ‚Äî datagen","text":"","code":"datagen(x, ...)  # S3 method for mgcv.smooth datagen(x, n = 100, data, ...)  # S3 method for fs.interaction datagen(x, n = 100, data, ...)  # S3 method for gam datagen(x, smooth = NULL, n = 200, ...)  # S3 method for gamm datagen(x, ...)  # S3 method for list datagen(x, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/datagen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate data over the range of variables used in smooths ‚Äî datagen","text":"x object new data required. Currently objects classes \"gam\", \"gamm\" supported, smooths mgcv inheriting class \"mgcv.smooth\". ... arguments passed methods n numeric; number data values generate per term smooth. data data frame; \"mgcv.smooth\" objects, data used fit GAM need supplied.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/datagen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate data over the range of variables used in smooths ‚Äî datagen","text":"data frame new values spread range observed values.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/datagen.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Generate data over the range of variables used in smooths ‚Äî datagen","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/derivatives.html","id":null,"dir":"Reference","previous_headings":"","what":"Derivatives of estimated smooths via finite differences ‚Äî derivatives","title":"Derivatives of estimated smooths via finite differences ‚Äî derivatives","text":"Derivatives estimated smooths via finite differences","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/derivatives.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Derivatives of estimated smooths via finite differences ‚Äî derivatives","text":"","code":"derivatives(object, ...)  # S3 method for default derivatives(object, ...)  # S3 method for gamm derivatives(object, ...)  # S3 method for gam derivatives(   object,   term,   newdata,   order = 1L,   type = c(\"forward\", \"backward\", \"central\"),   n = 200,   eps = 1e-07,   interval = c(\"confidence\", \"simultaneous\"),   n_sim = 10000,   level = 0.95,   unconditional = FALSE,   frequentist = FALSE,   offset = NULL,   ncores = 1,   partial_match = FALSE,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/derivatives.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Derivatives of estimated smooths via finite differences ‚Äî derivatives","text":"object R object compute derivatives . ... arguments passed methods. term character; vector one smooth terms derivatives required. missing, derivatives smooth terms returned. Can partial match smooth term; see argument partial_match . newdata data frame containing values model covariates evaluate first derivatives smooths. order numeric; order derivative. type character; type finite difference used. One \"forward\", \"backward\", \"central\". n numeric; number points evaluate derivative . eps numeric; finite difference. interval character; type interval compute. One \"confidence\" point-wise intervals, \"simultaneous\" simultaneous intervals. n_sim integer; number simulations used computing simultaneous intervals. level numeric; 0 < level < 1; confidence level point-wise simultaneous interval. default 0.95 95% interval. unconditional logical; use smoothness selection-corrected Bayesian covariance matrix? frequentist logical; use frequentist covariance matrix? offset numeric; value use offset term ncores number cores generating random variables multivariate normal distribution. Passed mvnfast::rmvn(). Parallelization take place OpenMP supported (appears work Windows current R). partial_match logical; smooths selected partial matches term? TRUE, term can single string match .","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/derivatives.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Derivatives of estimated smooths via finite differences ‚Äî derivatives","text":"tibble, currently following variables: smooth: smooth row refers , var: name variable involved smooth, data: values var derivative evaluated, derivative: estimated derivative, se: standard error estimated derivative, crit: critical value derivative ¬± (crit * se) gives upper lower bounds requested confidence simultaneous interval (given level), lower: lower bound confidence simultaneous interval, upper: upper bound confidence simultaneous interval.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/derivatives.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Derivatives of estimated smooths via finite differences ‚Äî derivatives","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/derivatives.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Derivatives of estimated smooths via finite differences ‚Äî derivatives","text":"","code":"load_mgcv() # \\dontshow{ set.seed(42) op <- options(cli.unicode = FALSE) # } dat <- gamSim(1, n = 400, dist = \"normal\", scale = 2, verbose = FALSE) mod <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = \"REML\")  ## first derivatives of all smooths using central finite differences derivatives(mod, type = \"central\") #> # A tibble: 800 x 8 #>    smooth var       data derivative    se  crit lower upper #>    <chr>  <chr>    <dbl>      <dbl> <dbl> <dbl> <dbl> <dbl> #>  1 s(x0)  x0    0.000239       7.41  3.33  1.96 0.874  13.9 #>  2 s(x0)  x0    0.00525        7.41  3.33  1.96 0.875  13.9 #>  3 s(x0)  x0    0.0103         7.40  3.33  1.96 0.884  13.9 #>  4 s(x0)  x0    0.0153         7.40  3.31  1.96 0.902  13.9 #>  5 s(x0)  x0    0.0203         7.39  3.30  1.96 0.929  13.8 #>  6 s(x0)  x0    0.0253         7.38  3.27  1.96 0.965  13.8 #>  7 s(x0)  x0    0.0303         7.36  3.24  1.96 1.01   13.7 #>  8 s(x0)  x0    0.0353         7.34  3.20  1.96 1.07   13.6 #>  9 s(x0)  x0    0.0403         7.32  3.15  1.96 1.14   13.5 #> 10 s(x0)  x0    0.0453         7.29  3.10  1.96 1.21   13.4 #> # ... with 790 more rows  ## derivatives for a selected smooth derivatives(mod, type = \"central\", term = \"s(x1)\") #> # A tibble: 200 x 8 #>    smooth var       data derivative    se  crit lower upper #>    <chr>  <chr>    <dbl>      <dbl> <dbl> <dbl> <dbl> <dbl> #>  1 s(x1)  x1    0.000405     -0.907  3.12  1.96 -7.02  5.20 #>  2 s(x1)  x1    0.00541      -0.907  3.12  1.96 -7.02  5.20 #>  3 s(x1)  x1    0.0104       -0.906  3.11  1.96 -7.01  5.20 #>  4 s(x1)  x1    0.0154       -0.903  3.11  1.96 -6.99  5.19 #>  5 s(x1)  x1    0.0204       -0.898  3.10  1.96 -6.97  5.17 #>  6 s(x1)  x1    0.0254       -0.891  3.08  1.96 -6.93  5.15 #>  7 s(x1)  x1    0.0304       -0.880  3.06  1.96 -6.88  5.12 #>  8 s(x1)  x1    0.0354       -0.867  3.04  1.96 -6.82  5.08 #>  9 s(x1)  x1    0.0404       -0.850  3.00  1.96 -6.74  5.04 #> 10 s(x1)  x1    0.0454       -0.829  2.96  1.96 -6.64  4.98 #> # ... with 190 more rows ## or via a partial match derivatives(mod, type = \"central\", term = \"x1\", partial_match = TRUE) #> # A tibble: 200 x 8 #>    smooth var       data derivative    se  crit lower upper #>    <chr>  <chr>    <dbl>      <dbl> <dbl> <dbl> <dbl> <dbl> #>  1 s(x1)  x1    0.000405     -0.907  3.12  1.96 -7.02  5.20 #>  2 s(x1)  x1    0.00541      -0.907  3.12  1.96 -7.02  5.20 #>  3 s(x1)  x1    0.0104       -0.906  3.11  1.96 -7.01  5.20 #>  4 s(x1)  x1    0.0154       -0.903  3.11  1.96 -6.99  5.19 #>  5 s(x1)  x1    0.0204       -0.898  3.10  1.96 -6.97  5.17 #>  6 s(x1)  x1    0.0254       -0.891  3.08  1.96 -6.93  5.15 #>  7 s(x1)  x1    0.0304       -0.880  3.06  1.96 -6.88  5.12 #>  8 s(x1)  x1    0.0354       -0.867  3.04  1.96 -6.82  5.08 #>  9 s(x1)  x1    0.0404       -0.850  3.00  1.96 -6.74  5.04 #> 10 s(x1)  x1    0.0454       -0.829  2.96  1.96 -6.64  4.98 #> # ... with 190 more rows # \\dontshow{ options(op) # }"},{"path":"https://gavinsimpson.github.io/gratia/reference/difference_smooths.html","id":null,"dir":"Reference","previous_headings":"","what":"Differences of factor smooth interactions ‚Äî difference_smooths","title":"Differences of factor smooth interactions ‚Äî difference_smooths","text":"Differences factor smooth interactions","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/difference_smooths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Differences of factor smooth interactions ‚Äî difference_smooths","text":"","code":"difference_smooths(model, ...)  # S3 method for gam difference_smooths(   model,   smooth,   n = 100,   ci_level = 0.95,   newdata = NULL,   partial_match = TRUE,   unconditional = FALSE,   frequentist = FALSE,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/difference_smooths.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Differences of factor smooth interactions ‚Äî difference_smooths","text":"model fitted model. ... arguments passed methods. smooth character; smooth compute differences . n numeric; number points evaluate difference pairs smooths. ci_level numeric 0 1; coverage credible interval. newdata data frame locations evaluate difference smooths. partial_match logical; smooth match partially smooths? partial_match = TRUE, smooth must single string, character vector length 1. Unlike similar functions, default TRUE intention users matching factor-smooth labels. unconditional logical; account smoothness selection model? frequentist logical; use frequentist covariance matrix?","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/difference_smooths.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Differences of factor smooth interactions ‚Äî difference_smooths","text":"","code":"load_mgcv() # \\dontshow{ op <- options(digits = 3, cli.unicode = FALSE) # } df <- data_sim(\"eg4\", seed = 42) m <- gam(y ~ fac + s(x2, by = fac) + s(x0), data = df, method = \"REML\")  difference_smooths(m, smooth = \"s(x2)\") #> # A tibble: 300 x 9 #>    smooth by    level_1 level_2  diff    se    lower upper      x2 #>    <chr>  <chr> <chr>   <chr>   <dbl> <dbl>    <dbl> <dbl>   <dbl> #>  1 s(x2)  fac   1       2       0.386 0.618 -0.824    1.60 0.00359 #>  2 s(x2)  fac   1       2       0.479 0.574 -0.646    1.60 0.0136  #>  3 s(x2)  fac   1       2       0.572 0.534 -0.474    1.62 0.0237  #>  4 s(x2)  fac   1       2       0.665 0.497 -0.308    1.64 0.0338  #>  5 s(x2)  fac   1       2       0.758 0.464 -0.151    1.67 0.0438  #>  6 s(x2)  fac   1       2       0.850 0.435 -0.00342  1.70 0.0539  #>  7 s(x2)  fac   1       2       0.941 0.412  0.134    1.75 0.0639  #>  8 s(x2)  fac   1       2       1.03  0.393  0.262    1.80 0.0740  #>  9 s(x2)  fac   1       2       1.12  0.378  0.380    1.86 0.0841  #> 10 s(x2)  fac   1       2       1.21  0.367  0.489    1.93 0.0941  #> # ... with 290 more rows options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.compare_smooths.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot comparisons of smooths ‚Äî draw.compare_smooths","title":"Plot comparisons of smooths ‚Äî draw.compare_smooths","text":"Plot comparisons smooths","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.compare_smooths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot comparisons of smooths ‚Äî draw.compare_smooths","text":"","code":"# S3 method for compare_smooths draw(object, ncol = NULL, nrow = NULL, guides = \"collect\", ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.compare_smooths.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot comparisons of smooths ‚Äî draw.compare_smooths","text":"object class \"compare_smooths\", result call compare_smooths(). ncol numeric; numbers rows columns spread plots nrow numeric; numbers rows columns spread plots guides character; one \"keep\" (default), \"collect\", \"auto\". Passed patchwork::plot_layout() ... additional arguments passed patchwork::wrap_plots().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.derivatives.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot derivatives of smooths ‚Äî draw.derivatives","title":"Plot derivatives of smooths ‚Äî draw.derivatives","text":"Plot derivatives smooths","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.derivatives.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot derivatives of smooths ‚Äî draw.derivatives","text":"","code":"# S3 method for derivatives draw(   object,   select = NULL,   scales = c(\"free\", \"fixed\"),   alpha = 0.2,   ncol = NULL,   nrow = NULL,   guides = \"keep\",   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.derivatives.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot derivatives of smooths ‚Äî draw.derivatives","text":"object fitted GAM, result call mgcv::gam(). select character, logical, numeric; smooths plot. NULL, default, model smooths drawn. Numeric select indexes smooths order specified formula stored object. Character select matches labels smooths shown example output summary(object). Logical select operates per numeric select order smooths stored. scales character; univariate smooths plotted y-axis scale? default, scales = \"fixed\", ensures done. scales = \"free\" univariate smooth y-axis scale. Currently affect y-axis scale plots parametric terms. alpha numeric; alpha transparency confidence simultaneous interval. ncol numeric; numbers rows columns spread plots nrow numeric; numbers rows columns spread plots guides character; one \"keep\" (default), \"collect\", \"auto\". Passed patchwork::plot_layout() ... additional arguments passed patchwork::wrap_plots().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.derivatives.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot derivatives of smooths ‚Äî draw.derivatives","text":"","code":"load_mgcv() dat <- data_sim(\"eg1\", n = 800, dist = \"normal\", scale = 2, seed = 42) mod <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = \"REML\")  ## first derivative of all smooths df <- derivatives(mod, type = \"central\") draw(df)  ## fixed axis scales draw(df, scales = \"fixed\")"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.difference_smooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot differences of smooths ‚Äî draw.difference_smooth","title":"Plot differences of smooths ‚Äî draw.difference_smooth","text":"Plot differences smooths","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.difference_smooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot differences of smooths ‚Äî draw.difference_smooth","text":"","code":"# S3 method for difference_smooth draw(   object,   select = NULL,   rug = FALSE,   ref_line = FALSE,   contour = FALSE,   contour_col = \"black\",   n_contour = NULL,   ci_alpha = 0.2,   ci_col = \"black\",   smooth_col = \"black\",   line_col = \"red\",   scales = c(\"free\", \"fixed\"),   ncol = NULL,   nrow = NULL,   guides = \"keep\",   xlab = NULL,   ylab = NULL,   title = NULL,   subtitle = NULL,   caption = NULL,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.difference_smooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot differences of smooths ‚Äî draw.difference_smooth","text":"object fitted GAM, result call mgcv::gam(). select character, logical, numeric; smooths plot. NULL, default, model smooths drawn. Numeric select indexes smooths order specified formula stored object. Character select matches labels smooths shown example output summary(object). Logical select operates per numeric select order smooths stored. rug logical; ref_line logical; contour logical; contour lines added smooth surfaces? contour_col colour specification contour lines. n_contour numeric; number contour bins. result n_contour - 1 contour lines drawn. See ggplot2::geom_contour(). ci_alpha numeric; alpha transparency confidence simultaneous interval. ci_col colour specification confidence/credible intervals band. Affects fill interval. smooth_col colour specification smooth difference line. line_col colour specicification drawing reference lines scales character; univariate smooths plotted y-axis scale? default, scales = \"fixed\", ensures done. scales = \"free\" univariate smooth y-axis scale. Currently affect y-axis scale plots parametric terms. ncol, nrow numeric; numbers rows columns spread plots guides character; one \"keep\" (default), \"collect\", \"auto\". Passed patchwork::plot_layout() xlab, ylab, title, subtitle, caption character; labels annotate plots ... additional arguments passed patchwork::wrap_plots().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.difference_smooth.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot differences of smooths ‚Äî draw.difference_smooth","text":"","code":"load_mgcv() # simulate some data; a factor smooth example df <- data_sim(\"eg4\", seed = 42) # fit GAM m <- gam(y ~ fac + s(x2, by = fac) + s(x0), data = df, method = \"REML\")  # calculate the differences between pairs of smooths the f_j(x2) term diffs <- difference_smooths(m, smooth = \"s(x2)\") draw(diffs)"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.evaluated_smooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot estimated smooths ‚Äî draw.evaluated_smooth","title":"Plot estimated smooths ‚Äî draw.evaluated_smooth","text":"Plots estimated univariate bivariate smooths using ggplot2.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.evaluated_smooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot estimated smooths ‚Äî draw.evaluated_smooth","text":"","code":"# S3 method for evaluated_1d_smooth draw(   object,   rug = NULL,   ci_level = 0.95,   constant = NULL,   fun = NULL,   xlab,   ylab,   title = NULL,   subtitle = NULL,   caption = NULL,   partial_residuals = NULL,   response_range = NULL,   ... )  # S3 method for evaluated_2d_smooth draw(   object,   show = c(\"estimate\", \"se\"),   contour = TRUE,   contour_col = \"black\",   n_contour = NULL,   constant = NULL,   fun = NULL,   xlab,   ylab,   title = NULL,   subtitle = NULL,   caption = NULL,   response_range = NULL,   continuous_fill = NULL,   ... )  # S3 method for evaluated_re_smooth draw(   object,   qq_line = TRUE,   constant = NULL,   fun = NULL,   xlab,   ylab,   title = NULL,   subtitle = NULL,   caption = NULL,   response_range = NULL,   ... )  # S3 method for evaluated_fs_smooth draw(   object,   rug = NULL,   constant = NULL,   fun = NULL,   xlab,   ylab,   title = NULL,   subtitle = NULL,   caption = NULL,   response_range = NULL,   discrete_colour = NULL,   ... )  # S3 method for evaluated_parametric_term draw(   object,   ci_level = 0.95,   constant = NULL,   fun = NULL,   xlab,   ylab,   title = NULL,   subtitle = NULL,   caption = NULL,   rug = TRUE,   position = \"identity\",   response_range = NULL,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.evaluated_smooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot estimated smooths ‚Äî draw.evaluated_smooth","text":"object object, result call evaluate_smooth(). rug evaluate_smooth(), numeric vector values location data x axis. default NULL results rug plot drawn. evaluate_parametric_terms(), logical indicate rug plot drawn. ci_level numeric 0 1; coverage credible interval. constant numeric; constant add estimated values smooth. constant, supplied, added estimated value confidence band computed. fun function; function applied estimated values confidence interval plotting. Can function name function. Function fun applied adding constant, provided. xlab character expression; label x axis. supplied, suitable label generated object. ylab character expression; label y axis. supplied, suitable label generated object. title character expression; title plot. See ggplot2::labs(). subtitle character expression; subtitle plot. See ggplot2::labs(). caption character expression; plot caption. See ggplot2::labs(). partial_residuals data frame; partial residuals data values partial residuals drawn. names ..p_resid ..orig_x supplied. response_range numeric; vector two values giving range response data guide. Used fix plots common scale/range. Ignored show set \"se\". ... arguments passed methods. show character; plot estimated smooth (\"estimate\") standard error (\"se\"). contour logical; contours draw plot using ggplot2::geom_contour(). contour_col colour specification contour lines. n_contour numeric; number contour bins. result n_contour - 1 contour lines drawn. See ggplot2::geom_contour(). continuous_fill suitable scale used filled surface. NULL, default used scale_fill_distiller(palette = \"RdBu\", type = \"div\"). qq_line logical; draw reference line lower upper theoretical quartiles. discrete_colour appropriate discrete colour scale ggplot2. scale need able provide many colours levels factor variable involved smooth. Suitable alternatives include ggplot2::scale_colour_viridis_d(). position Position adjustment, either string, result call position adjustment function.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.evaluated_smooth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot estimated smooths ‚Äî draw.evaluated_smooth","text":"ggplot2::ggplot() object.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.evaluated_smooth.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot estimated smooths ‚Äî draw.evaluated_smooth","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.evaluated_smooth.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot estimated smooths ‚Äî draw.evaluated_smooth","text":"","code":"load_mgcv()  dat <- data_sim(\"eg1\", n = 400, dist = \"normal\", scale = 2, seed = 2) m1 <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = \"REML\")  sm <- evaluate_smooth(m1, \"s(x2)\") draw(sm)   ## supply constant to shift y axis scale draw(sm, constant = coef(m1)[1])   dat <- data_sim(\"eg2\", n = 1000, dist = \"normal\", scale = 1, seed = 2) m2 <- gam(y ~ s(x, z, k = 40), data = dat, method = \"REML\")  sm <- evaluate_smooth(m2, \"s(x,z)\", n = 100) draw(sm)"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.gam.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot estimated smooths from a fitted GAM ‚Äî draw.gam","title":"Plot estimated smooths from a fitted GAM ‚Äî draw.gam","text":"Plots estimated smooths fitted GAM model similar way mgcv::plot.gam() instead using base graphics, ggplot2::ggplot() used instead.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.gam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot estimated smooths from a fitted GAM ‚Äî draw.gam","text":"","code":"# S3 method for gam draw(   object,   data = NULL,   select = NULL,   parametric = FALSE,   terms = NULL,   residuals = FALSE,   scales = c(\"free\", \"fixed\"),   ci_level = 0.95,   n = 100,   n_3d = 16,   n_4d = 4,   unconditional = FALSE,   overall_uncertainty = TRUE,   constant = NULL,   fun = NULL,   dist = 0.1,   rug = TRUE,   contour = TRUE,   ci_alpha = 0.2,   ci_col = \"black\",   smooth_col = \"black\",   contour_col = \"black\",   n_contour = NULL,   partial_match = FALSE,   discrete_colour = NULL,   continuous_colour = NULL,   continuous_fill = NULL,   position = \"identity\",   ncol = NULL,   nrow = NULL,   guides = \"keep\",   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.gam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot estimated smooths from a fitted GAM ‚Äî draw.gam","text":"object fitted GAM, result call mgcv::gam(). data optional data frame may may used? FIXME! select character, logical, numeric; smooths plot. NULL, default, model smooths drawn. Numeric select indexes smooths order specified formula stored object. Character select matches labels smooths shown example output summary(object). Logical select operates per numeric select order smooths stored. parametric logical; plot parametric terms also? Note select used selecting smooths plot. terms argument used select parametric effects plotted. default, mgcv::plot.gam(), draw parametyric effects. terms character; model parametric terms drawn? Default NULL plot parametric terms can drawn. residuals logical; partial residuals smooth drawn? Ignored anything simple univariate smooth. scales character; univariate smooths plotted y-axis scale? default, scales = \"fixed\", ensures done. scales = \"free\" univariate smooth y-axis scale. Currently affect y-axis scale plots parametric terms. ci_level numeric 0 1; coverage credible interval. n numeric; number points range covariate evaluate smooth. n_3d numeric; number new observations generate third dimension 3D smooth. n_4d numeric; number new observations generate dimensions higher 2 (!) kD smooth (k >= 4). example, smooth 4D smooth, dimensions 3 4 get n_4d new observations. unconditional logical; confidence intervals include uncertainty due smoothness selection? TRUE, corrected Bayesian covariance matrix used. overall_uncertainty logical; uncertainty model constant term included standard error evaluate values smooth? constant numeric; constant add estimated values smooth. constant, supplied, added estimated value confidence band computed. fun function; function applied estimated values confidence interval plotting. Can function name function. Function fun applied adding constant, provided. dist numeric; greater 0, used determine location far data plotted plotting 2-D smooths. data scaled unit square deciding exclude, dist distance within unit square. See mgcv::exclude..far() details. rug logical; draw rug plot botom plot? contour logical; contours draw plot using ggplot2::geom_contour(). ci_alpha numeric; alpha transparency confidence simultaneous interval. ci_col colour specification confidence/credible intervals band. Affects fill interval. smooth_col colour specification smooth line. contour_col colour specification contour lines. n_contour numeric; number contour bins. result n_contour - 1 contour lines drawn. See ggplot2::geom_contour(). partial_match logical; smooths selected partial matches select? TRUE, select can single string match . discrete_colour, continuous_colour, continuous_fill suitable scales types data. position Position adjustment, either string, result call position adjustment function. ncol, nrow numeric; numbers rows columns spread plots guides character; one \"keep\" (default), \"collect\", \"auto\". Passed patchwork::plot_layout() ... additional arguments passed patchwork::wrap_plots().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.gam.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot estimated smooths from a fitted GAM ‚Äî draw.gam","text":"object returned created patchwork::wrap_plots().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.gam.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Plot estimated smooths from a fitted GAM ‚Äî draw.gam","text":"Internally, plots smooth created using ggplot2::ggplot() composed single plot using patchwork::wrap_plots(). result, possible use + add plots way one might typically work ggplot() plots. Instead, use & operator; see examples.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.gam.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot estimated smooths from a fitted GAM ‚Äî draw.gam","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.gam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot estimated smooths from a fitted GAM ‚Äî draw.gam","text":"","code":"load_mgcv()  # simulate some data df1 <- data_sim(\"eg1\", n = 400, dist = \"normal\", scale = 2, seed = 2) # fit GAM m1 <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = df1, method = \"REML\")  # plot all smooths draw(m1)   # can add partial residuals draw(m1, residuals = TRUE)   df2 <- data_sim(2, n = 1000, dist = \"normal\", scale = 1, seed = 2) m2 <- gam(y ~ s(x, z, k = 40), data = df2, method = \"REML\") draw(m2, contour = FALSE, n = 50)   # change the number of contours drawn and the fill scale used for # the surface library(\"ggplot2\") draw(m2, n_contour = 5, n = 50,      continuous_fill = scale_fill_distiller(palette = \"Spectral\",                                             type = \"div\"))   # to modify all panels, for example to change the theme, use the & operator draw(m2, n_contour = 5, n = 50) &   theme_minimal()   # customising some plot elements draw(m1, ci_col = \"steelblue\", smooth_col = \"forestgreen\", ci_alpha = 0.3)"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic plotting via ggplot2 ‚Äî draw","title":"Generic plotting via ggplot2 ‚Äî draw","text":"Generic plotting via ggplot2","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic plotting via ggplot2 ‚Äî draw","text":"","code":"draw(object, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic plotting via ggplot2 ‚Äî draw","text":"object R object plot. ... arguments passed methods.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic plotting via ggplot2 ‚Äî draw","text":"ggplot2::ggplot() object.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generic plotting via ggplot2 ‚Äî draw","text":"Generic function plotting R objects uses ggplot2 package.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Generic plotting via ggplot2 ‚Äî draw","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.mgcv_smooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot basis functions ‚Äî draw.mgcv_smooth","title":"Plot basis functions ‚Äî draw.mgcv_smooth","text":"Plots basis functions using ggplot2","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.mgcv_smooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot basis functions ‚Äî draw.mgcv_smooth","text":"","code":"# S3 method for mgcv_smooth draw(   object,   legend = FALSE,   use_facets = TRUE,   labeller = NULL,   xlab,   ylab,   title = NULL,   subtitle = NULL,   caption = NULL,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.mgcv_smooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot basis functions ‚Äî draw.mgcv_smooth","text":"object object, result call basis(). legend logical; legend drawn indicate basis functions? use_facets logical; factor smooths, use facets show basis functions level factor? FALSE, separate ggplot object created level combined using patchwork::wrap_plots(). Currently ignored. labeller labeller function label facets. default use ggplot2::label_both(). xlab character expression; label x axis. supplied, suitable label generated object. ylab character expression; label y axis. supplied, suitable label generated object. title character expression; title plot. See ggplot2::labs(). subtitle character expression; subtitle plot. See ggplot2::labs(). caption character expression; plot caption. See ggplot2::labs(). ... arguments passed methods. used method.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.mgcv_smooth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot basis functions ‚Äî draw.mgcv_smooth","text":"ggplot2::ggplot() object.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.mgcv_smooth.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot basis functions ‚Äî draw.mgcv_smooth","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.mgcv_smooth.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot basis functions ‚Äî draw.mgcv_smooth","text":"","code":"load_mgcv() set.seed(42) df <- gamSim(4, n = 400, verbose = FALSE)  bf <- basis(s(x0), data = df) draw(bf)   bf <- basis(s(x2, by = fac, bs = 'bs'), data = df) draw(bf)"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.parametric_effects.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot estimated effects for model parametric terms ‚Äî draw.parametric_effects","title":"Plot estimated effects for model parametric terms ‚Äî draw.parametric_effects","text":"Plot estimated effects model parametric terms","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.parametric_effects.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot estimated effects for model parametric terms ‚Äî draw.parametric_effects","text":"","code":"# S3 method for parametric_effects draw(   object,   scales = c(\"free\", \"fixed\"),   ci_level = 0.95,   ci_col = \"black\",   ci_alpha = 0.2,   line_col = \"black\",   constant = NULL,   fun = NULL,   rug = TRUE,   position = \"identity\",   ...,   ncol = NULL,   nrow = NULL,   guides = \"keep\" )"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.parametric_effects.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot estimated effects for model parametric terms ‚Äî draw.parametric_effects","text":"object fitted GAM, result call mgcv::gam(). scales character; univariate smooths plotted y-axis scale? default, scales = \"fixed\", ensures done. scales = \"free\" univariate smooth y-axis scale. Currently affect y-axis scale plots parametric terms. ci_level numeric 0 1; coverage credible interval. ci_col colour specification confidence/credible intervals band. Affects fill interval. ci_alpha numeric; alpha transparency confidence simultaneous interval. line_col colour specification used regression lines linear continuous terms. constant numeric; constant add estimated values smooth. constant, supplied, added estimated value confidence band computed. fun function; function applied estimated values confidence interval plotting. Can function name function. Function fun applied adding constant, provided. rug logical; draw rug plot botom plot? position Position adjustment, either string, result call position adjustment function. ... additional arguments passed patchwork::wrap_plots(). ncol numeric; numbers rows columns spread plots nrow numeric; numbers rows columns spread plots guides character; one \"keep\" (default), \"collect\", \"auto\". Passed patchwork::plot_layout()","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.penalty_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Display penalty matrices of smooths using ggplot ‚Äî draw.penalty_df","title":"Display penalty matrices of smooths using ggplot ‚Äî draw.penalty_df","text":"Displays penalty matrices smooths heatmap using ggplot","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.penalty_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Display penalty matrices of smooths using ggplot ‚Äî draw.penalty_df","text":"","code":"# S3 method for penalty_df draw(   object,   normalize = FALSE,   continuous_fill = NULL,   xlab = NULL,   ylab = NULL,   title = NULL,   subtitle = NULL,   caption = NULL,   ncol = NULL,   nrow = NULL,   guides = \"keep\",   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.penalty_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Display penalty matrices of smooths using ggplot ‚Äî draw.penalty_df","text":"object object, result call evaluate_smooth(). normalize logical; normalize penalty range -1, 1? continuous_fill suitable scale used filled surface. NULL, default used scale_fill_distiller(palette = \"RdBu\", type = \"div\"). xlab character expression; label x axis. supplied, axis label drawn. May vector, one per penalty. ylab character expression; label y axis.  supplied, axis label drawn. May vector, one per penalty. title character expression; title plot. See ggplot2::labs(). May vector, one per penalty. subtitle character expression; subtitle plot. See ggplot2::labs(). May vector, one per penalty. caption character expression; plot caption. See ggplot2::labs(). May vector, one per penalty. ncol, nrow numeric; numbers rows columns spread plots. guides character; one \"keep\" (default), \"collect\", \"auto\". Passed patchwork::plot_layout() ... arguments passed methods.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.penalty_df.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Display penalty matrices of smooths using ggplot ‚Äî draw.penalty_df","text":"","code":"load_mgcv() dat <- data_sim(\"eg4\", n = 400, seed = 42) m <- gam(y ~ s(x0) + s(x1, bs = 'cr') + s(x2, bs = 'bs', by = fac),          data = dat, method = \"REML\")  ## produce a multi-panel plot of all penalties draw(penalty(m))   # for a specific smooth draw(penalty(m, smooth = \"s(x2):fac1\"))"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.rootogram.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw a rootogram ‚Äî draw.rootogram","title":"Draw a rootogram ‚Äî draw.rootogram","text":"rootogram model diagnostic tool assesses goodness fit statistical model. observed values response compared expected fitted model. discrete, count responses, frequency count (0, 1, 2, etc) observed data expected conditional distribution response implied model compared. continuous variables, observed expected frequencies obtained grouping data bins. rootogram drawn using ggplot2::ggplot() graphics. design closely follows Kleiber & Zeileis (2016).","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.rootogram.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw a rootogram ‚Äî draw.rootogram","text":"","code":"# S3 method for rootogram draw(   object,   type = c(\"hanging\", \"standing\", \"suspended\"),   sqrt = TRUE,   ref_line = TRUE,   warn_limits = TRUE,   fitted_colour = \"steelblue\",   bar_colour = NA,   bar_fill = \"grey\",   ref_line_colour = \"black\",   warn_line_colour = \"black\",   ylab = NULL,   xlab = NULL,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.rootogram.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw a rootogram ‚Äî draw.rootogram","text":"object R object plot. type character; type rootogram draw. sqrt logical; show observed fitted frequencies ref_line logical; draw reference line zero? warn_limits logical; draw Tukey's warning limit lines +/- 1? fitted_colour, bar_colour, bar_fill, ref_line_colour, warn_line_colour colours used draw respective element rootogram. xlab, ylab character; labels x y axis rootogram. May missing (NULL), case suitable labels used. ' ... arguments passed methods.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.rootogram.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draw a rootogram ‚Äî draw.rootogram","text":"'ggplot' object.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.rootogram.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Draw a rootogram ‚Äî draw.rootogram","text":"Kleiber, C., Zeileis, ., (2016) Visualizing Count Data Regressions Using Rootograms. . Stat. 70, 296‚Äì303. doi: 10.1080/00031305.2016.1173590","code":""},{"path":[]},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.rootogram.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Draw a rootogram ‚Äî draw.rootogram","text":"","code":"load_mgcv() df <- data_sim(\"eg1\", n = 1000, dist = \"poisson\", scale = 0.1, seed = 6)  # A poisson example m <- gam(y ~ s(x0, bs = \"cr\") + s(x1, bs = \"cr\") + s(x2, bs = \"cr\") +          s(x3, bs = \"cr\"), family = poisson(), data = df, method = \"REML\") rg <- rootogram(m)  # plot the rootogram draw(rg)   # change the type of rootogram draw(rg, type = \"suspended\")"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.smooth_estimates.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the result of a call to smooth_estimates() ‚Äî draw.smooth_estimates","title":"Plot the result of a call to smooth_estimates() ‚Äî draw.smooth_estimates","text":"Plot result call smooth_estimates()","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.smooth_estimates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the result of a call to smooth_estimates() ‚Äî draw.smooth_estimates","text":"","code":"# S3 method for smooth_estimates draw(   object,   constant = NULL,   fun = NULL,   contour = TRUE,   contour_col = \"black\",   n_contour = NULL,   ci_alpha = 0.2,   ci_col = \"black\",   smooth_col = \"black\",   partial_match = FALSE,   discrete_colour = NULL,   continuous_colour = NULL,   continuous_fill = NULL,   ylim = NULL,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.smooth_estimates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the result of a call to smooth_estimates() ‚Äî draw.smooth_estimates","text":"object fitted GAM, result call mgcv::gam(). constant numeric; constant add estimated values smooth. constant, supplied, added estimated value confidence band computed. fun function; function applied estimated values confidence interval plotting. Can function name function. Function fun applied adding constant, provided. contour logical; contours draw plot using ggplot2::geom_contour(). contour_col colour specification contour lines. n_contour numeric; number contour bins. result n_contour - 1 contour lines drawn. See ggplot2::geom_contour(). ci_alpha numeric; alpha transparency confidence simultaneous interval. ci_col colour specification confidence/credible intervals band. Affects fill interval. smooth_col colour specification smooth line. partial_match logical; smooths selected partial matches select? TRUE, select can single string match . discrete_colour suitable scales types data. continuous_colour suitable scales types data. continuous_fill suitable scales types data. ylim numeric; vector y axis limits use panels drawn. ... additional arguments passed patchwork::wrap_plots().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.smooth_estimates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the result of a call to smooth_estimates() ‚Äî draw.smooth_estimates","text":"","code":"load_mgcv() # example data df <- data_sim(\"eg1\", seed = 21) # fit GAM m <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = df, method = \"REML\") # plot all of the estimated smooths sm <- smooth_estimates(m) draw(sm)  # evaluate smooth of `x2` sm <- smooth_estimates(m, smooth = \"s(x2)\") # plot it draw(sm)   # customising some plot elements draw(sm, ci_col = \"steelblue\", smooth_col = \"forestgreen\", ci_alpha = 0.3)"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.smooth_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot posterior smooths ‚Äî draw.smooth_samples","title":"Plot posterior smooths ‚Äî draw.smooth_samples","text":"Plot posterior smooths","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.smooth_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot posterior smooths ‚Äî draw.smooth_samples","text":"","code":"# S3 method for smooth_samples draw(   object,   select = NULL,   n_samples = NULL,   seed = NULL,   xlab = NULL,   ylab = NULL,   title = NULL,   subtitle = NULL,   caption = NULL,   alpha = 1,   colour = \"black\",   contour = FALSE,   contour_col = \"black\",   n_contour = NULL,   scales = c(\"free\", \"fixed\"),   rug = TRUE,   partial_match = FALSE,   ncol = NULL,   nrow = NULL,   guides = \"keep\",   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.smooth_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot posterior smooths ‚Äî draw.smooth_samples","text":"object fitted GAM, result call mgcv::gam(). select character, logical, numeric; smooths plot. NULL, default, model smooths drawn. Numeric select indexes smooths order specified formula stored object. Character select matches labels smooths shown example output summary(object). Logical select operates per numeric select order smooths stored. n_samples numeric; NULL, sample n_samples posterior draws plotting. seed numeric; random seed used sampling draws. xlab character expression; label x axis. supplied, suitable label generated object. ylab character expression; label y axis. supplied, suitable label generated object. title character expression; title plot. See ggplot2::labs(). subtitle character expression; subtitle plot. See ggplot2::labs(). caption character expression; plot caption. See ggplot2::labs(). alpha numeric; alpha transparency confidence simultaneous interval. colour colour use draw posterior smooths. Passed ggplot2::geom_line() argument colour. contour logical; contour lines added smooth surfaces? contour_col colour specification contour lines. n_contour numeric; number contour bins. result n_contour - 1 contour lines drawn. See ggplot2::geom_contour(). scales character; univariate smooths plotted y-axis scale? default, scales = \"fixed\", ensures done. scales = \"free\" univariate smooth y-axis scale. Currently affect y-axis scale plots parametric terms. rug logical; draw rug plot botom plot? partial_match logical; smooths selected partial matches select? TRUE, select can single string match . ncol numeric; numbers rows columns spread plots nrow numeric; numbers rows columns spread plots guides character; one \"keep\" (default), \"collect\", \"auto\". Passed patchwork::plot_layout() ... arguments passed patchwork::wrap_plots().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.smooth_samples.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot posterior smooths ‚Äî draw.smooth_samples","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw.smooth_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot posterior smooths ‚Äî draw.smooth_samples","text":"","code":"load_mgcv() dat1 <- data_sim(\"eg1\", n = 400, dist = \"normal\", scale = 1, seed = 1) ## a single smooth GAM m1 <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat1, method = \"REML\") ## posterior smooths from m1 sm1 <- smooth_samples(m1, n = 15, seed = 23478) ## plot draw(sm1, alpha = 0.7)  ## plot only 5 randomly smapled draws draw(sm1, n_samples = 5, alpha = 0.7)   ## A factor-by smooth example dat2 <- data_sim(\"eg4\", n = 400, dist = \"normal\", scale = 1, seed = 1) ## a multi-smooth GAM with a factor-by smooth m2 <- gam(y ~ fac + s(x2, by = fac) + s(x0), data = dat2, method = \"REML\") ## posterior smooths from m1 sm2 <- smooth_samples(m2, n = 15, seed = 23478) ## plot, this time selecting only the factor-by smooth draw(sm2, select = \"s(x2)\", partial_match = TRUE, alpha = 0.7)   ## A 2D smooth example dat3 <- data_sim(\"eg2\", n = 400, dist = \"normal\", scale = 1, seed = 1) ## fit a 2D smooth m3 <- gam(y ~ te(x, z), data = dat3, method = \"REML\") ## get samples sm3 <- smooth_samples(m3, n = 10) ## plot just 6 of the draws, with contour line overlays draw(sm3, n_samples = 6, contour = TRUE, seed = 42)"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw_parametric_effect.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal function to draw an individual parametric effect ‚Äî draw_parametric_effect","title":"Internal function to draw an individual parametric effect ‚Äî draw_parametric_effect","text":"Internal function draw individual parametric effect","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/draw_parametric_effect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal function to draw an individual parametric effect ‚Äî draw_parametric_effect","text":"","code":"draw_parametric_effect(   object,   ci_level = 0.95,   ci_col = \"black\",   ci_alpha = 0.2,   line_col = \"black\",   constant = NULL,   fun = NULL,   xlab = NULL,   ylab = NULL,   title = NULL,   subtitle = NULL,   caption = NULL,   rug = TRUE,   position = \"identity\",   ylim = NULL,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/draw_parametric_effect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal function to draw an individual parametric effect ‚Äî draw_parametric_effect","text":"object fitted GAM, result call mgcv::gam(). ci_level numeric 0 1; coverage credible interval. ci_col colour specification confidence/credible intervals band. Affects fill interval. ci_alpha numeric; alpha transparency confidence simultaneous interval. constant numeric; constant add estimated values smooth. constant, supplied, added estimated value confidence band computed. fun function; function applied estimated values confidence interval plotting. Can function name function. Function fun applied adding constant, provided. xlab character expression; label x axis. supplied, suitable label generated object. ylab character expression; label y axis. supplied, suitable label generated object. title character expression; title plot. See ggplot2::labs(). subtitle character expression; subtitle plot. See ggplot2::labs(). caption character expression; plot caption. See ggplot2::labs(). rug logical; draw rug plot botom plot? position Position adjustment, either string, result call position adjustment function. ... additional arguments passed patchwork::wrap_plots().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/edf.html","id":null,"dir":"Reference","previous_headings":"","what":"Effective degrees of freedom for smooths and GAMs ‚Äî edf","title":"Effective degrees of freedom for smooths and GAMs ‚Äî edf","text":"Extracts effective degrees freedom (EDF) model smooth terms overall EDF fitted GAMs","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/edf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Effective degrees of freedom for smooths and GAMs ‚Äî edf","text":"","code":"edf(object, ...)  # S3 method for gam edf(   object,   smooth = NULL,   type = c(\"default\", \"unconditional\", \"alternative\"),   ... )  model_edf(object, ..., type = c(\"default\", \"unconditional\", \"alternative\"))"},{"path":"https://gavinsimpson.github.io/gratia/reference/edf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Effective degrees of freedom for smooths and GAMs ‚Äî edf","text":"object fitted model extract smooth-specific EDFs. ... arguments passed methods. smooth character; vector smooth terms whose EDFs extracted. NULL, default, EDFs smooths returned. type character: type EDF return. \"default\" returns standard EDF; \"unconditional\" selects EDF corrected smoothness parameter selection, available; \"alternative\" returns alternative formulation EDF Wood (2017, pp. 252)","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/edf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Effective degrees of freedom for smooths and GAMs ‚Äî edf","text":"Multiple formulations effective degrees freedom available. additional uncertainty due selection smoothness parameters can taken account computing EDF smooths. form EDF available type = \"unconditional\". Wood (2017; pp. 252) describes alternative EDF  model $$\\mathrm{EDF} = 2\\mathrm{tr}(\\mathbf{F}) -   \\mathrm{tr}(\\mathbf{FF}),$$ \\(\\mathrm{tr}\\) matrix trace \\(\\mathbf{F}\\) matrix mapping un-penalized coefficient estimates penalized coefficient estimates.  trace \\(\\mathbf{F}\\) effectively average shrinkage coefficients multipled number coefficients (Wood, 2017). Smooth-specific EDFs obtained summing relevent elements \\(\\mathrm{diag}(2\\mathbf{F} - \\mathbf{FF})\\).","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/edf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Effective degrees of freedom for smooths and GAMs ‚Äî edf","text":"","code":"load_mgcv() op <- options(cli.unicode = FALSE, digits = 6) df <- data_sim(\"eg1\", n = 400, seed = 42) m <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = df, method = \"REML\")  # extract the EDFs for all smooths edf(m) #> # A tibble: 4 x 2 #>   smooth   edf #>   <chr>  <dbl> #> 1 s(x0)   3.42 #> 2 s(x1)   3.22 #> 3 s(x2)   7.90 #> 4 s(x3)   1.88  # or selected smooths edf(m, smooth = c(\"s(x0)\", \"s(x2)\")) #> # A tibble: 2 x 2 #>   smooth   edf #>   <chr>  <dbl> #> 1 s(x0)   3.42 #> 2 s(x2)   7.90  # accounting for smoothness parameter uncertainty edf(m, type = \"unconditional\") #> # A tibble: 4 x 2 #>   smooth   edf #>   <chr>  <dbl> #> 1 s(x0)   3.77 #> 2 s(x1)   3.87 #> 3 s(x2)   8.07 #> 4 s(x3)   2.88  # over EDF of the model, including the intercept model_edf(m) #> # A tibble: 1 x 2 #>   model   edf #>   <chr> <dbl> #> 1 m      17.4  # can get model EDF for multiple models m2 <- gam(y ~ s(x0) + s(x1) + s(x3), data = df, method = \"REML\") model_edf(m, m2) #> # A tibble: 2 x 2 #>   model   edf #>   <chr> <dbl> #> 1 m     17.4  #> 2 m2     7.58 options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/eval_smooth.html","id":null,"dir":"Reference","previous_headings":"","what":"S3 methods to evaluate individual smooths ‚Äî eval_smooth","title":"S3 methods to evaluate individual smooths ‚Äî eval_smooth","text":"S3 methods evaluate individual smooths","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/eval_smooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"S3 methods to evaluate individual smooths ‚Äî eval_smooth","text":"","code":"eval_smooth(smooth, ...)  # S3 method for mgcv.smooth eval_smooth(   smooth,   model,   n = 100,   n_3d = NULL,   n_4d = NULL,   data = NULL,   unconditional = FALSE,   overall_uncertainty = TRUE,   dist = NULL,   ... )  # S3 method for fs.interaction eval_smooth(   smooth,   model,   n = 100,   data = NULL,   unconditional = FALSE,   overall_uncertainty = TRUE,   ... )  # S3 method for random.effect eval_smooth(   smooth,   model,   n = 100,   data = NULL,   unconditional = FALSE,   overall_uncertainty = TRUE,   ... )  # S3 method for mrf.smooth eval_smooth(   smooth,   model,   n = 100,   data = NULL,   unconditional = FALSE,   overall_uncertainty = TRUE,   ... )  # S3 method for t2.smooth eval_smooth(   smooth,   model,   n = 100,   n_3d = NULL,   n_4d = NULL,   data = NULL,   unconditional = FALSE,   overall_uncertainty = TRUE,   dist = NULL,   ... )  # S3 method for tensor.smooth eval_smooth(   smooth,   model,   n = 100,   n_3d = NULL,   n_4d = NULL,   data = NULL,   unconditional = FALSE,   overall_uncertainty = TRUE,   dist = NULL,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/eval_smooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"S3 methods to evaluate individual smooths ‚Äî eval_smooth","text":"smooth currently object inherits class mgcv.smooth. ... arguments assed methods model fitted model; currently mgcv::gam() mgcv::bam() models suported. n numeric; number points range covariate evaluate smooth. n_3d numeric; number points range last covariate 3D 4D smooth. default NULL achieves standard behaviour using n points range covariate, resulting n^d evaluation pointsm, d dimension smooth. d > 2 can result many evaluation points slow performance. smooths d > 4, value n_4d used dimensions > 4, unless NULL, case default behaviour (using n dimensions) observed. n_4d numeric; number points range last covariate 3D 4D smooth. default NULL achieves standard behaviour using n points range covariate, resulting n^d evaluation pointsm, d dimension smooth. d > 2 can result many evaluation points slow performance. smooths d > 4, value n_4d used dimensions > 4, unless NULL, case default behaviour (using n dimensions) observed. data optional data frame values evaluate smooth . unconditional logical; confidence intervals include uncertainty due smoothness selection? TRUE, corrected Bayesian covariance matrix used. overall_uncertainty logical; uncertainty model constant term included standard error evaluate values smooth? dist numeric; greater 0, used determine location far data plotted plotting 2-D smooths. data scaled unit square deciding exclude, dist distance within unit square. See mgcv::exclude..far() details.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/evaluate_parametric_term.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate parametric model terms ‚Äî evaluate_parametric_term","title":"Evaluate parametric model terms ‚Äî evaluate_parametric_term","text":"Returns values parametric model terms values factor terms grid covariate values linear parametric terms. function now deprecated favour parametric_effects().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/evaluate_parametric_term.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate parametric model terms ‚Äî evaluate_parametric_term","text":"","code":"evaluate_parametric_term(object, ...)  # S3 method for gam evaluate_parametric_term(object, term, unconditional = FALSE, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/evaluate_parametric_term.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate parametric model terms ‚Äî evaluate_parametric_term","text":"object object class \"gam\" \"gamm\". ... arguments passed methods. term character; parametric term whose effects evaluated unconditional logical; confidence intervals include uncertainty due smoothness selection? TRUE, corrected Bayesian covariance matrix used.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/evaluate_smooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate a smooth ‚Äî evaluate_smooth","title":"Evaluate a smooth ‚Äî evaluate_smooth","text":"Evaluate smooth grid evenly spaced value range covariate associated smooth. Alternatively, set points smooth evaluated can supplied.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/evaluate_smooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate a smooth ‚Äî evaluate_smooth","text":"","code":"evaluate_smooth(object, ...)  # S3 method for gam evaluate_smooth(   object,   smooth,   n = 100,   newdata = NULL,   unconditional = FALSE,   overall_uncertainty = TRUE,   dist = 0.1,   ... )  # S3 method for gamm evaluate_smooth(object, ...)  # S3 method for list evaluate_smooth(object, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/evaluate_smooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate a smooth ‚Äî evaluate_smooth","text":"object object class \"gam\" \"gamm\". ... arguments passed methods. smooth character; single smooth evaluate. n numeric; number points range covariate evaluate smooth. newdata vector data frame points evaluate smooth. unconditional logical; confidence intervals include uncertainty due smoothness selection? TRUE, corrected Bayesian covariance matrix used. overall_uncertainty logical; uncertainty model constant term included standard error evaluate values smooth? dist numeric; greater 0, used determine location far data plotted plotting 2-D smooths. data scaled unit square deciding exclude, dist distance within unit square. See mgcv::exclude..far() details.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/evaluate_smooth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate a smooth ‚Äî evaluate_smooth","text":"data frame, class \"evaluated_1d_smooth\" evaluated_2d_smooth, inherit classes \"evaluated_smooth\"\"data.frame\".","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/evaluate_smooth.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Evaluate a smooth ‚Äî evaluate_smooth","text":"evaluate_smooth() deprecated favour smooth_estimates(), provides cleaner way evaluate smooth range covariate values. smooth_estimates() can handle much wider range models evaluate_smooth() capable smooth_estimates() much easier extend handle new smooth types. code uses evaluate_smooth() work simply changing function call smooth_estimates(). However, differences: newdata argument becomes data Consider evaluate_smooth() soft-deprecated; use discouraged may removed later date becomes difficult maintain current functionality, intentions removing gratia unless situation arises.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/evaluate_smooth.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluate a smooth ‚Äî evaluate_smooth","text":"","code":"load_mgcv() # \\dontshow{ set.seed(2) op <- options(cli.unicode = FALSE, digits = 5) # } dat <- gamSim(1, n = 400, dist = \"normal\", scale = 2) #> Gu & Wahba 4 term additive model m1 <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = \"REML\")  evaluate_smooth(m1, \"s(x1)\") #> # A tibble: 100 x 5 #>    smooth by_variable       x1   est    se #>    <chr>  <fct>          <dbl> <dbl> <dbl> #>  1 s(x1)  NA          0.000663 -1.94 0.329 #>  2 s(x1)  NA          0.0108   -1.93 0.312 #>  3 s(x1)  NA          0.0208   -1.92 0.296 #>  4 s(x1)  NA          0.0309   -1.90 0.281 #>  5 s(x1)  NA          0.0410   -1.89 0.267 #>  6 s(x1)  NA          0.0511   -1.87 0.255 #>  7 s(x1)  NA          0.0612   -1.86 0.243 #>  8 s(x1)  NA          0.0713   -1.84 0.234 #>  9 s(x1)  NA          0.0814   -1.83 0.225 #> 10 s(x1)  NA          0.0914   -1.81 0.218 #> # ... with 90 more rows  ## 2d example set.seed(2) dat <- gamSim(2, n = 1000, dist = \"normal\", scale = 1) #> Bivariate smoothing example m2 <- gam(y ~ s(x, z, k = 30), data = dat$data, method = \"REML\")  evaluate_smooth(m2, \"s(x,z)\", n = 100) #> # A tibble: 10,000 x 6 #>    smooth by_variable        x        z    est    se #>    <chr>  <fct>          <dbl>    <dbl>  <dbl> <dbl> #>  1 s(x,z) NA          0.000663 0.000762 0.0881 0.189 #>  2 s(x,z) NA          0.0108   0.000762 0.0922 0.186 #>  3 s(x,z) NA          0.0208   0.000762 0.0965 0.183 #>  4 s(x,z) NA          0.0309   0.000762 0.101  0.180 #>  5 s(x,z) NA          0.0410   0.000762 0.105  0.176 #>  6 s(x,z) NA          0.0511   0.000762 0.110  0.173 #>  7 s(x,z) NA          0.0612   0.000762 0.115  0.170 #>  8 s(x,z) NA          0.0713   0.000762 0.120  0.166 #>  9 s(x,z) NA          0.0814   0.000762 0.125  0.163 #> 10 s(x,z) NA          0.0914   0.000762 0.130  0.160 #> # ... with 9,990 more rows options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/factor_combos.html","id":null,"dir":"Reference","previous_headings":"","what":"All combinations of factor levels ‚Äî factor_combos","title":"All combinations of factor levels ‚Äî factor_combos","text":"combinations factor levels","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/factor_combos.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"All combinations of factor levels ‚Äî factor_combos","text":"","code":"factor_combos(object, ...)  # S3 method for gam factor_combos(object, vars = everything(), complete = TRUE, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/factor_combos.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"All combinations of factor levels ‚Äî factor_combos","text":"object fitted model object. ... arguments passed methods. vars terms include exclude returned object. Uses tidyselect principles. complete logical; combinations factor levels returned? FALSE, combinations levels observed model retained.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/family.gam.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract family objects from models ‚Äî family.gam","title":"Extract family objects from models ‚Äî family.gam","text":"Provides stats::family() method range GAM objects.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/family.gam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract family objects from models ‚Äî family.gam","text":"","code":"# S3 method for gam family(object, ...)  # S3 method for gamm family(object, ...)  # S3 method for bam family(object, ...)  # S3 method for list family(object, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/family.gam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract family objects from models ‚Äî family.gam","text":"object fitted model. Models fitted mgcv::gam(), mgcv::bam(), mgcv::gamm(), gamm4::gamm4() currently supported. ... arguments passed methods.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/family_name.html","id":null,"dir":"Reference","previous_headings":"","what":"Name of family used to fit model ‚Äî family_name","title":"Name of family used to fit model ‚Äî family_name","text":"Extracts name family used fit supplied model.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/family_name.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Name of family used to fit model ‚Äî family_name","text":"","code":"family_name(object, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/family_name.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Name of family used to fit model ‚Äî family_name","text":"object R object. ... arguments passed methods.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/family_name.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Name of family used to fit model ‚Äî family_name","text":"character vector containing family name.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/family_type.html","id":null,"dir":"Reference","previous_headings":"","what":"Extracts the type of family in a consistent way ‚Äî family_type","title":"Extracts the type of family in a consistent way ‚Äî family_type","text":"Extracts type family consistent way","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/family_type.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extracts the type of family in a consistent way ‚Äî family_type","text":"","code":"family_type(object, ...)  # S3 method for family family_type(object, ...)  # S3 method for default family_type(object, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/family_type.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extracts the type of family in a consistent way ‚Äî family_type","text":"object R object. Currently family() objects anything family() method. ... arguments passed methods.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fderiv.html","id":null,"dir":"Reference","previous_headings":"","what":"First derivatives of fitted GAM functions ‚Äî fderiv","title":"First derivatives of fitted GAM functions ‚Äî fderiv","text":"function deprecated limited first order forward finite differences derivatives , improved offer needed functionality without breaking backwards compatability papers blog posts already used fderiv(). replacement, derivatives(), now available recommended new analyses.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fderiv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"First derivatives of fitted GAM functions ‚Äî fderiv","text":"","code":"fderiv(model, ...)  # S3 method for gam fderiv(   model,   newdata,   term,   n = 200,   eps = 1e-07,   unconditional = FALSE,   offset = NULL,   ... )  # S3 method for gamm fderiv(model, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/fderiv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"First derivatives of fitted GAM functions ‚Äî fderiv","text":"model fitted GAM. Currently models fitted mgcv::gam() mgcv::gamm() supported. ... Arguments passed methods. newdata data frame containing values model covariates evaluate first derivatives smooths. term character; vector one terms derivatives required. missing, derivatives smooth terms returned. n integer; newdata missing original data can reconstructed model n controls number values range covariate populate newdata. eps numeric; value finite difference used approximate first derivative. unconditional logical; TRUE, smoothing parameter uncertainty corrected covariance matrix used, available, otherwise uncorrected Bayesian posterior covariance matrix used. offset numeric; value offset use generating predictions.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fderiv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"First derivatives of fitted GAM functions ‚Äî fderiv","text":"object class \"fderiv\" returned.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fderiv.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"First derivatives of fitted GAM functions ‚Äî fderiv","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fderiv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"First derivatives of fitted GAM functions ‚Äî fderiv","text":"","code":"load_mgcv() # \\dontshow{ op <- options(lifecycle_verbosity = \"quiet\") # } dat <- data_sim(\"eg1\", seed = 2) mod <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = \"REML\")  ## first derivatives of all smooths... fd <- fderiv(mod) ## now use --> fd <- derivatives(mod)  ## ...and a selected smooth fd2 <- fderiv(mod, term = \"x1\") ## now use --> fd2 <- derivatives(mod, term = \"s(x1)\")  ## Models with factors dat <- data_sim(\"eg4\", n = 400, dist = \"normal\", scale = 2, seed = 2) mod <- gam(y ~ s(x0) + s(x1) + fac, data = dat, method = \"REML\")  ## first derivatives of all smooths... fd <- fderiv(mod) ## now use --> fd <- derivatives(mod)  ## ...and a selected smooth fd2 <- fderiv(mod, term = \"x1\") ## now use --> fd2 <- derivatives(mod, term = \"s(x1)\")"},{"path":"https://gavinsimpson.github.io/gratia/reference/fitted_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw fitted values from the posterior distribution ‚Äî fitted_samples","title":"Draw fitted values from the posterior distribution ‚Äî fitted_samples","text":"Expectations (fitted values) response drawn posterior distribution fitted model using Gaussian approximation posterior.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fitted_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw fitted values from the posterior distribution ‚Äî fitted_samples","text":"","code":"fitted_samples(model, ...)  # S3 method for gam fitted_samples(   model,   n = 1,   newdata,   seed,   scale = c(\"response\", \"linear_predictor\"),   method = c(\"gaussian\", \"mh\", \"inla\"),   freq = FALSE,   unconditional = FALSE,   ncores = 1L,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/fitted_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw fitted values from the posterior distribution ‚Äî fitted_samples","text":"model fitted model supported types ... arguments passed methods. fitted_samples(), passed predict.gam(). n numeric; number posterior samples return. newdata data frame; new observations posterior draws model evaluated. supplied, data used fit model used newdata, available model. seed numeric; random seed simulations. scale character; method character; method used generate samples posterior distribution model. \"gaussian\", default, uses Gaussian approximation posterior. \"mh\" uses simple Metropolis Hastings sampler, \"inla\" uses variant Integrated Nested Laplace Approximation due Wood (2019). Currently, available option \"gaussian\". freq logical; TRUE use frequentist covariance matrix parameter estimators, FALSE use Bayesian posterior covariance matrix parameters. unconditional logical; TRUE (freq == FALSE) Bayesian smoothing parameter uncertainty corrected covariance matrix used, available. ncores number cores generating random variables multivariate normal distribution. Passed mvnfast::rmvn(). Parallelization take place OpenMP supported (appears work Windows current R).","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fitted_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draw fitted values from the posterior distribution ‚Äî fitted_samples","text":"tibble (data frame) 3 columns containing posterior predicted values long format. columns row (integer) row newdata posterior draw relates , draw (integer) index, range 1:n, indicating draw row relates , response (numeric) predicted response indicated row newdata.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fitted_samples.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Draw fitted values from the posterior distribution ‚Äî fitted_samples","text":"Wood, S.N., (2020). Simplified integrated nested Laplace approximation. Biometrika 107, 223--230. doi: 10.1093/biomet/asz044","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fitted_samples.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Draw fitted values from the posterior distribution ‚Äî fitted_samples","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fitted_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Draw fitted values from the posterior distribution ‚Äî fitted_samples","text":"","code":"load_mgcv() # \\dontshow{ set.seed(2) op <- options(cli.unicode = FALSE) # } dat <- gamSim(1, n = 1000, dist = \"normal\", scale = 2) #> Gu & Wahba 4 term additive model m1 <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = \"REML\")  fitted_samples(m1, n = 5, seed = 42) #> # A tibble: 5,000 x 3 #>      row  draw fitted #>    <int> <int>  <dbl> #>  1     1     1   6.24 #>  2     2     1   5.12 #>  3     3     1   7.06 #>  4     4     1   7.56 #>  5     5     1   9.20 #>  6     6     1   7.94 #>  7     7     1   6.13 #>  8     8     1   7.59 #>  9     9     1  13.9  #> 10    10     1  12.7  #> # ... with 4,990 more rows options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/fitted_values.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate fitted values from a estimated GAM ‚Äî fitted_values","title":"Generate fitted values from a estimated GAM ‚Äî fitted_values","text":"Generate fitted values estimated GAM","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fitted_values.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate fitted values from a estimated GAM ‚Äî fitted_values","text":"","code":"fitted_values(object, ...)  # S3 method for gam fitted_values(   object,   data = NULL,   scale = c(\"response\", \"link\", \"linear predictor\"),   ci_level = 0.95,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/fitted_values.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate fitted values from a estimated GAM ‚Äî fitted_values","text":"object fitted model. Currently models fitted mgcv::gam() mgcv::bam() supported. ... arguments passed mgcv::predict.gam(). Note type, newdata, se.fit already used passed mgcv::predict.gam(). data optional data frame covariate values fitted values returned. scale character; scale fitted values returned ? \"linear predictor\" synonym \"link\" prefer terminology. ci_level numeric; value 0 1 indicating coverage credible interval.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fitted_values.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate fitted values from a estimated GAM ‚Äî fitted_values","text":"tibble (data frame) whose first m columns contain either data used fit model (data NULL), variables supplied data. Four columns added: fitted: fitted values specified scale, se: standard error fitted values (always link scale), lower, upper: limits credible interval fitted values, specified scale.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fitted_values.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Generate fitted values from a estimated GAM ‚Äî fitted_values","text":"Regardless scale fitted values returned, se component returned object link (linear predictor) scale, response scale.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fitted_values.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate fitted values from a estimated GAM ‚Äî fitted_values","text":"","code":"load_mgcv() # \\dontshow{ op <- options(cli.unicode = FALSE, digits = 6) # } sim_df <- data_sim(\"eg1\", n = 400, dist = \"normal\", scale = 2, seed = 2) m <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = sim_df, method = \"REML\") fv <- fitted_values(m) fv #> # A tibble: 400 x 8 #>       x0     x1      x2    x3 fitted    se lower upper #>    <dbl>  <dbl>   <dbl> <dbl>  <dbl> <dbl> <dbl> <dbl> #>  1 0.185 0.617  0.415   0.132   8.74 0.355  8.04  9.43 #>  2 0.702 0.569  0.531   0.365   7.63 0.338  6.96  8.29 #>  3 0.573 0.154  0.00325 0.455   3.12 0.592  1.96  4.28 #>  4 0.168 0.0348 0.252   0.537  11.1  0.402 10.3  11.9  #>  5 0.944 0.998  0.155   0.185  14.1  0.453 13.2  14.9  #>  6 0.943 0.836  0.879   0.449   6.13 0.365  5.42  6.85 #>  7 0.129 0.587  0.204   0.257  12.5  0.356 11.8  13.2  #>  8 0.833 0.339  0.584   0.618   6.25 0.345  5.58  6.93 #>  9 0.468 0.167  0.804   0.881   4.21 0.372  3.49  4.94 #> 10 0.550 0.807  0.265   0.318  15.5  0.370 14.8  16.3  #> # ... with 390 more rows options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/fix_offset.html","id":null,"dir":"Reference","previous_headings":"","what":"Fix the names of a data frame containing an offset variable. ‚Äî fix_offset","title":"Fix the names of a data frame containing an offset variable. ‚Äî fix_offset","text":"Identifies variable, , model offset, fixed name offset(foo(var)) converted var, possibly sets values variable offset_val.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fix_offset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fix the names of a data frame containing an offset variable. ‚Äî fix_offset","text":"","code":"fix_offset(model, newdata, offset_val = NULL)"},{"path":"https://gavinsimpson.github.io/gratia/reference/fix_offset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fix the names of a data frame containing an offset variable. ‚Äî fix_offset","text":"model fitted GAM. newdata data frame; new values predict . offset_val numeric, optional; provided, offset variable newdata set constant value returning newdata","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fix_offset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fix the names of a data frame containing an offset variable. ‚Äî fix_offset","text":"original newdata returned fixed names possibly modified offset variable.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fix_offset.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fix the names of a data frame containing an offset variable. ‚Äî fix_offset","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fix_offset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fix the names of a data frame containing an offset variable. ‚Äî fix_offset","text":"","code":"load_mgcv() set.seed(2) df <- gamSim(1, n = 400, dist = \"normal\") #> Gu & Wahba 4 term additive model m <- gam(y ~ s(x0) + s(x1) + offset(x2), data = df, method = \"REML\") names(model.frame(m)) #> [1] \"y\"          \"offset(x2)\" \"x0\"         \"x1\"         names(fix_offset(m, model.frame(m), offset_val = 1L)) #> [1] \"y\"  \"x2\" \"x0\" \"x1\""},{"path":"https://gavinsimpson.github.io/gratia/reference/fixef.gam.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract fixed effects estimates from a fitted GAM ‚Äî fixef.gam","title":"Extract fixed effects estimates from a fitted GAM ‚Äî fixef.gam","text":"Extract fixed effects estimates fitted GAM","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fixef.gam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract fixed effects estimates from a fitted GAM ‚Äî fixef.gam","text":"","code":"# S3 method for gam fixef(object, ...)  # S3 method for gamm fixef(object, ...)  # S3 method for lm fixef(object, ...)  # S3 method for glm fixef(object, ...)  fixed_effects(object, ...)  # S3 method for default fixed_effects(object, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/fixef.gam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract fixed effects estimates from a fitted GAM ‚Äî fixef.gam","text":"object fitted GAM ... arguments passed methods","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fixef.gam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract fixed effects estimates from a fitted GAM ‚Äî fixef.gam","text":"","code":"load_mgcv()  # run example if lme4 is available if (require(\"lme4\")) {  data(sleepstudy, package = \"lme4\") m <- gam(Reaction ~ Days + s(Subject, bs = \"re\") +            s(Days, Subject, bs = \"re\"),          data = sleepstudy, method = \"REML\") fixef(m)  } #> Loading required package: lme4 #> Loading required package: Matrix #> (Intercept)        Days  #>   251.40510    10.46729"},{"path":"https://gavinsimpson.github.io/gratia/reference/fixef.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract fixed effects estimates ‚Äî fixef","title":"Extract fixed effects estimates ‚Äî fixef","text":"Extract fixed effects estimates","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/fixef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract fixed effects estimates ‚Äî fixef","text":"object fitted GAM ... arguments passed methods","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/get_by_smooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract an factor-by smooth by name ‚Äî get_by_smooth","title":"Extract an factor-by smooth by name ‚Äî get_by_smooth","text":"Extract factor-smooth name","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/get_by_smooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract an factor-by smooth by name ‚Äî get_by_smooth","text":"","code":"get_by_smooth(object, term, level)"},{"path":"https://gavinsimpson.github.io/gratia/reference/get_by_smooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract an factor-by smooth by name ‚Äî get_by_smooth","text":"object fitted GAM model object. term character; name smooth term extract. level character; level factor exrtact smooth .","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/get_by_smooth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract an factor-by smooth by name ‚Äî get_by_smooth","text":"single smooth object, list smooths several match named term.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/get_smooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract an mgcv smooth by name ‚Äî get_smooth","title":"Extract an mgcv smooth by name ‚Äî get_smooth","text":"Extract mgcv smooth name","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/get_smooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract an mgcv smooth by name ‚Äî get_smooth","text":"","code":"get_smooth(object, term)"},{"path":"https://gavinsimpson.github.io/gratia/reference/get_smooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract an mgcv smooth by name ‚Äî get_smooth","text":"object fitted GAM model object. term character; name smooth term extract","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/get_smooth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract an mgcv smooth by name ‚Äî get_smooth","text":"single smooth object, list smooths several match named term.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/get_smooths_by_id.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract an mgcv smooth given its position in the model object ‚Äî get_smooths_by_id","title":"Extract an mgcv smooth given its position in the model object ‚Äî get_smooths_by_id","text":"Extract mgcv smooth given position model object","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/get_smooths_by_id.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract an mgcv smooth given its position in the model object ‚Äî get_smooths_by_id","text":"","code":"get_smooths_by_id(object, id)"},{"path":"https://gavinsimpson.github.io/gratia/reference/get_smooths_by_id.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract an mgcv smooth given its position in the model object ‚Äî get_smooths_by_id","text":"object fitted GAM model object. id numeric; position smooth model object.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/gss_vocab.html","id":null,"dir":"Reference","previous_headings":"","what":"Data from the General Social Survey (GSS) from the National Opinion Research\nCenter of the University of Chicago ‚Äî gss_vocab","title":"Data from the General Social Survey (GSS) from the National Opinion Research\nCenter of the University of Chicago ‚Äî gss_vocab","text":"subset data carData::GSSvocab dataset carData package, containing observations 2016 .","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/gss_vocab.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data from the General Social Survey (GSS) from the National Opinion Research\nCenter of the University of Chicago ‚Äî gss_vocab","text":"data frame 1858 rows 3 variables: vocab: numeric; number words 10 correct vocabulary test. nativeBorn: factor; respondent born US? factor levels yes. ageGroup: factor; grouped age respondent levels 18-29 30-39, 40-49, 50-59, 60+.##'","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/gw_functions.html","id":null,"dir":"Reference","previous_headings":"","what":"Gu and Wabha test functions ‚Äî gw_f0","title":"Gu and Wabha test functions ‚Äî gw_f0","text":"Gu Wabha test functions","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/gw_functions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gu and Wabha test functions ‚Äî gw_f0","text":"","code":"gw_f0(x)  gw_f1(x)  gw_f2(x)  gw_f3(x)"},{"path":"https://gavinsimpson.github.io/gratia/reference/gw_functions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gu and Wabha test functions ‚Äî gw_f0","text":"x numeric; vecotor points evaluate function , interval (0,1)","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/gw_functions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gu and Wabha test functions ‚Äî gw_f0","text":"","code":"x <- seq(0, 1, length = 6) gw_f0(x) #> [1] 0.000000e+00 1.175571e+00 1.902113e+00 1.902113e+00 1.175571e+00 #> [6] 2.449294e-16 gw_f1(x) #> [1] 1.000000 1.491825 2.225541 3.320117 4.953032 7.389056 gw_f2(x) #> [1] 0.000000 8.591008 4.261214 3.198526 1.100036 0.000000 gw_f3(x) # should be constant 0 #> [1] 0 0 0 0 0 0"},{"path":"https://gavinsimpson.github.io/gratia/reference/has_theta.html","id":null,"dir":"Reference","previous_headings":"","what":"Are additional parameters available for a GAM? ‚Äî has_theta","title":"Are additional parameters available for a GAM? ‚Äî has_theta","text":"additional parameters available GAM?","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/has_theta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Are additional parameters available for a GAM? ‚Äî has_theta","text":"","code":"has_theta(object)"},{"path":"https://gavinsimpson.github.io/gratia/reference/has_theta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Are additional parameters available for a GAM? ‚Äî has_theta","text":"object R object, either family() object object whose class family() method.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/has_theta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Are additional parameters available for a GAM? ‚Äî has_theta","text":"logical; TRUE additional parameters available, FALSEotherwise.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/has_theta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Are additional parameters available for a GAM? ‚Äî has_theta","text":"","code":"load_mgcv() df <- data_sim(\"eg1\", dist = \"poisson\", seed = 42, scale = 1/5) m <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = df, method = \"REML\",          family = nb()) has_theta(m) #> [1] TRUE p <- theta(m)"},{"path":"https://gavinsimpson.github.io/gratia/reference/is_by_smooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Tests for by variable smooths ‚Äî is_by_smooth","title":"Tests for by variable smooths ‚Äî is_by_smooth","text":"Functions check smooth -variable one test type -variable smooth factor-smooth continous-smooth interaction.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/is_by_smooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tests for by variable smooths ‚Äî is_by_smooth","text":"","code":"is_by_smooth(smooth)  is_factor_by_smooth(smooth)  is_continuous_by_smooth(smooth)  by_variable(smooth)  by_level(smooth)"},{"path":"https://gavinsimpson.github.io/gratia/reference/is_by_smooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tests for by variable smooths ‚Äî is_by_smooth","text":"smooth object class \"mgcv.smooth\"","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/is_by_smooth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tests for by variable smooths ‚Äî is_by_smooth","text":"logical vector.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/is_by_smooth.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tests for by variable smooths ‚Äî is_by_smooth","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/is_factor_term.html","id":null,"dir":"Reference","previous_headings":"","what":"Is a model term a factor (categorical)? ‚Äî is_factor_term","title":"Is a model term a factor (categorical)? ‚Äî is_factor_term","text":"Given name (term label) term model, identify term factor term numeric. useful considering interactions, terms like fac1:fac2 num1:fac1 may requested user. terms type fac1:fac2 function return TRUE.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/is_factor_term.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Is a model term a factor (categorical)? ‚Äî is_factor_term","text":"","code":"is_factor_term(object, term, ...)  # S3 method for terms is_factor_term(object, term, ...)  # S3 method for gam is_factor_term(object, term, ...)  # S3 method for bam is_factor_term(object, term, ...)  # S3 method for gamm is_factor_term(object, term, ...)  # S3 method for list is_factor_term(object, term, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/is_factor_term.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Is a model term a factor (categorical)? ‚Äî is_factor_term","text":"object R object method dispatch performed term character; name model term, sense attr(terms(object), \"term.labels\"). Currently checked see term exists model. ... arguments passed methods.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/is_factor_term.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Is a model term a factor (categorical)? ‚Äî is_factor_term","text":"logical: TRUE variables involved term factors, otherwise FALSE.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/is_mgcv_smooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if objects are smooths or are a particular type of smooth ‚Äî is_mgcv_smooth","title":"Check if objects are smooths or are a particular type of smooth ‚Äî is_mgcv_smooth","text":"Check objects smooths particular type smooth","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/is_mgcv_smooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if objects are smooths or are a particular type of smooth ‚Äî is_mgcv_smooth","text":"","code":"is_mgcv_smooth(smooth)  is_mrf_smooth(smooth)"},{"path":"https://gavinsimpson.github.io/gratia/reference/is_mgcv_smooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if objects are smooths or are a particular type of smooth ‚Äî is_mgcv_smooth","text":"smooth R object, typically list","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/is_offset.html","id":null,"dir":"Reference","previous_headings":"","what":"Is a model term an offset? ‚Äî is_offset","title":"Is a model term an offset? ‚Äî is_offset","text":"Given character vector model terms, checks see , , model offset.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/is_offset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Is a model term an offset? ‚Äî is_offset","text":"","code":"is_offset(terms)"},{"path":"https://gavinsimpson.github.io/gratia/reference/is_offset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Is a model term an offset? ‚Äî is_offset","text":"terms character vector model terms.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/is_offset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Is a model term an offset? ‚Äî is_offset","text":"logical vector length terms.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/is_offset.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Is a model term an offset? ‚Äî is_offset","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/is_offset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Is a model term an offset? ‚Äî is_offset","text":"","code":"load_mgcv() df <- gamSim(1, n = 400, dist = \"normal\") #> Gu & Wahba 4 term additive model m <- gam(y ~ s(x0) + s(x1) + offset(x0), data = df, method = \"REML\") nm <- names(model.frame(m)) nm #> [1] \"y\"          \"offset(x0)\" \"x0\"         \"x1\"         is_offset(nm) #> [1] FALSE  TRUE FALSE FALSE"},{"path":"https://gavinsimpson.github.io/gratia/reference/link.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract link and inverse link functions from models ‚Äî link","title":"Extract link and inverse link functions from models ‚Äî link","text":"Returns link inverse estimated model, provides simple way extract functions complex models multiple links, location scale models.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/link.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract link and inverse link functions from models ‚Äî link","text":"","code":"link(object, ...)  # S3 method for family link(object, parameter = NULL, which_eta = NULL, ...)  # S3 method for gam link(object, parameter = NULL, which_eta = NULL, ...)  # S3 method for bam link(object, parameter = NULL, which_eta = NULL, ...)  # S3 method for gamm link(object, ...)  # S3 method for glm link(object, ...)  # S3 method for list link(object, ...)  inv_link(object, ...)  # S3 method for family inv_link(object, parameter = NULL, which_eta = NULL, ...)  # S3 method for gam inv_link(object, parameter = NULL, which_eta = NULL, ...)  # S3 method for bam inv_link(object, parameter = NULL, which_eta = NULL, ...)  # S3 method for gamm inv_link(object, ...)  # S3 method for list inv_link(object, ...)  # S3 method for glm inv_link(object, ...)  extract_link(family, ...)  # S3 method for family extract_link(family, inverse = FALSE, ...)  # S3 method for general.family extract_link(family, parameter, inverse = FALSE, which_eta = NULL, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/link.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract link and inverse link functions from models ‚Äî link","text":"object family object fitted model extract family object.  Models fitted stats::glm(), mgcv::gam(), mgcv::bam(), mgcv::gamm(), gamm4::gamm4() currently supported. ... arguments passed methods. parameter character; parameter distribution. Usually \"location\" \"scale\" \"shape\" may provided location scale models. options include \"mu\" synonym \"location\", \"sigma\" scale parameter mgcv::gaulss(), \"pi\" zero-inflation term mgcv::ziplss(), \"power\" mgcv::twlss() power parameter, \"xi\", shape parameter mgcv::gevlss(), \"epsilon\" \"skewness\" skewness \"delta\" \"kurtosis\" kurtosis parameter mgcv::shash(), \"theta\" scale parameter mgcv::gammals(). which_eta numeric; linear predictor extract families mgcv::mvn() mgcv::multinom(). family family object, result call family(). inverse logical; return inverse link function?","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/link.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Extract link and inverse link functions from models ‚Äî link","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/link.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract link and inverse link functions from models ‚Äî link","text":"","code":"load_mgcv()  link(gaussian()) #> function (mu)  #> mu #> <environment: namespace:stats> link(nb()) #> function (mu)  #> log(mu) #> <environment: namespace:stats>  inv_link(nb()) #> function (eta)  #> pmax(exp(eta), .Machine$double.eps) #> <environment: namespace:stats>  dat <- data_sim(\"eg1\", seed = 4234) mod <- gam(list(y ~ s(x0) + s(x1) + s(x2) + s(x3), ~ 1), data = dat,            family = gaulss)  link(mod, parameter = \"scale\") #> function (mu)  #> log(1/mu - 0.01) #> <environment: 0x55e24a910928> inv_link(mod, parameter = \"scale\") #> function (eta)  #> 1/(exp(eta) + 0.01) #> <environment: 0x55e24a910928>  ## Works with `family` objects too link(shash(), parameter = \"skewness\") #> function (mu)  #> mu #> <environment: namespace:stats>"},{"path":"https://gavinsimpson.github.io/gratia/reference/load_mgcv.html","id":null,"dir":"Reference","previous_headings":"","what":"Load mgcv quietly ‚Äî load_mgcv","title":"Load mgcv quietly ‚Äî load_mgcv","text":"Simple function loads mgcv package whilst suppressing startup messages prints console.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/load_mgcv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load mgcv quietly ‚Äî load_mgcv","text":"","code":"load_mgcv()"},{"path":"https://gavinsimpson.github.io/gratia/reference/load_mgcv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load mgcv quietly ‚Äî load_mgcv","text":"Returns logical vectors invisibly, indicating whether package loaded .","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/model_concurvity.html","id":null,"dir":"Reference","previous_headings":"","what":"Concurvity of an estimated GAM ‚Äî model_concurvity","title":"Concurvity of an estimated GAM ‚Äî model_concurvity","text":"Concurvity estimated GAM","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/model_concurvity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Concurvity of an estimated GAM ‚Äî model_concurvity","text":"","code":"model_concurvity(model, ...)  # S3 method for gam model_concurvity(   model,   terms = everything(),   type = c(\"all\", \"estimate\", \"observed\", \"worst\"),   pairwise = FALSE,   ... )  concrvity(   model,   terms = everything(),   type = c(\"all\", \"estimate\", \"observed\", \"worst\"),   pairwise = FALSE,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/model_concurvity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Concurvity of an estimated GAM ‚Äî model_concurvity","text":"model fitted GAM. Currently objects class \"gam\" supported ... arguents passed methods. terms currently ignored type character; pairwise logical; extract pairwise concurvity model terms?","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/model_concurvity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Concurvity of an estimated GAM ‚Äî model_concurvity","text":"","code":"## simulate data with concurvity... library(\"tibble\") load_mgcv() set.seed(8) n <- 200 df <- tibble(t = sort(runif(n)),              x = gw_f2(t) + rnorm(n) * 3,              y = sin(4 * pi * t) + exp(x / 20) + rnorm(n) * 0.3)  ## fit model m <- gam(y ~ s(t, k = 15) + s(x, k = 15), data = df, method = \"REML\")  ## overall concurvity o_conc <- concrvity(m) draw(o_conc)   ## pairwise concurvity p_conc <- concrvity(m, pairwise = TRUE) draw(p_conc)"},{"path":"https://gavinsimpson.github.io/gratia/reference/n_smooths.html","id":null,"dir":"Reference","previous_headings":"","what":"How many smooths in a fitted model ‚Äî n_smooths","title":"How many smooths in a fitted model ‚Äî n_smooths","text":"many smooths fitted model","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/n_smooths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"How many smooths in a fitted model ‚Äî n_smooths","text":"","code":"n_smooths(object)  # S3 method for default n_smooths(object)  # S3 method for gam n_smooths(object)  # S3 method for gamm n_smooths(object)  # S3 method for bam n_smooths(object)"},{"path":"https://gavinsimpson.github.io/gratia/reference/n_smooths.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"How many smooths in a fitted model ‚Äî n_smooths","text":"object fitted GAM related model. Typically result call mgcv::gam(), mgcv::bam(), mgcv::gamm().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/nb_theta.html","id":null,"dir":"Reference","previous_headings":"","what":"Negative binomial parameter theta ‚Äî nb_theta","title":"Negative binomial parameter theta ‚Äî nb_theta","text":"Negative binomial parameter theta","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/nb_theta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Negative binomial parameter theta ‚Äî nb_theta","text":"","code":"nb_theta(model)  # S3 method for gam nb_theta(model)"},{"path":"https://gavinsimpson.github.io/gratia/reference/nb_theta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Negative binomial parameter theta ‚Äî nb_theta","text":"model fitted model.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/nb_theta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Negative binomial parameter theta ‚Äî nb_theta","text":"numeric vector length 1 containing estimated value theta.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/nb_theta.html","id":"methods-by-class-","dir":"Reference","previous_headings":"","what":"Methods (by class)","title":"Negative binomial parameter theta ‚Äî nb_theta","text":"gam: Method class \"gam\"","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/nb_theta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Negative binomial parameter theta ‚Äî nb_theta","text":"","code":"load_mgcv() df <- data_sim(\"eg1\", n = 500, dist = \"poisson\", scale = 0.1, seed = 6)  m <- gam(y ~ s(x0, bs = \"cr\") + s(x1, bs = \"cr\") + s(x2, bs = \"cr\") +          s(x3, bs = \"cr\"), family = nb, data = df, method = \"REML\") ## IGNORE_RDIFF_BEGIN nb_theta(m) #> [1] 239340.6 ## IGNORE_RDIFF_END"},{"path":"https://gavinsimpson.github.io/gratia/reference/nested_partial_residuals.html","id":null,"dir":"Reference","previous_headings":"","what":"Partial residuals in nested form ‚Äî nested_partial_residuals","title":"Partial residuals in nested form ‚Äî nested_partial_residuals","text":"Computes partial residuals smooth terms, formats long/tidy format, nests partial_residual column result nested data frame one row per smooth.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/nested_partial_residuals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Partial residuals in nested form ‚Äî nested_partial_residuals","text":"","code":"nested_partial_residuals(object, terms = NULL, data = NULL)"},{"path":"https://gavinsimpson.github.io/gratia/reference/nested_partial_residuals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Partial residuals in nested form ‚Äî nested_partial_residuals","text":"object fitted GAM model terms vector terms include partial residuals . Passed argument terms mgcv::predict.gam()]. data optional data frame","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/nested_partial_residuals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Partial residuals in nested form ‚Äî nested_partial_residuals","text":"nested tibble (data frame) one row per smooth term. Contains two columns: smooth - label indicating smooth term partial_residual - list column containing tibble (data frame) 1 column partial_residual containing requested partial residuals indicated smooth.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/nested_rug_values.html","id":null,"dir":"Reference","previous_headings":"","what":"Values for rug plot in nested form ‚Äî nested_rug_values","title":"Values for rug plot in nested form ‚Äî nested_rug_values","text":"Extracts original data smooth terms, formats long/tidy format, nests data column(s) result nested data frame one row per smooth.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/nested_rug_values.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Values for rug plot in nested form ‚Äî nested_rug_values","text":"","code":"nested_rug_values(object, terms = NULL, data = NULL)"},{"path":"https://gavinsimpson.github.io/gratia/reference/nested_rug_values.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Values for rug plot in nested form ‚Äî nested_rug_values","text":"object fitted GAM model terms vector terms include original data . Passed argument terms mgcv::predict.gam()]. data optional data frame","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/nested_rug_values.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Values for rug plot in nested form ‚Äî nested_rug_values","text":"nested tibble (data frame) one row per smooth term.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/observed_fitted_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot of fitted against observed response values ‚Äî observed_fitted_plot","title":"Plot of fitted against observed response values ‚Äî observed_fitted_plot","text":"Plot fitted observed response values","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/observed_fitted_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot of fitted against observed response values ‚Äî observed_fitted_plot","text":"","code":"observed_fitted_plot(   model,   ylab = NULL,   xlab = NULL,   title = NULL,   subtitle = NULL,   caption = NULL,   point_col = \"black\",   point_alpha = 1 )"},{"path":"https://gavinsimpson.github.io/gratia/reference/observed_fitted_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot of fitted against observed response values ‚Äî observed_fitted_plot","text":"model fitted model. Currently class \"gam\". ylab character expression; label y axis. supplied, suitable label generated. xlab character expression; label y axis. supplied, suitable label generated. title character expression; title plot. See ggplot2::labs(). subtitle character expression; subtitle plot. See ggplot2::labs(). caption character expression; plot caption. See ggplot2::labs(). point_col colour used draw points plots. See graphics::par() section Color Specification. passed individual plotting functions, therefore affects points plots. point_alpha numeric; alpha transparency points plots.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/parametric_effects.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimated values for parametric model terms ‚Äî parametric_effects","title":"Estimated values for parametric model terms ‚Äî parametric_effects","text":"Estimated values parametric model terms","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/parametric_effects.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimated values for parametric model terms ‚Äî parametric_effects","text":"","code":"parametric_effects(object, ...)  # S3 method for gam parametric_effects(   object,   terms = NULL,   unconditional = FALSE,   unnest = TRUE,   ci_level = 0.95,   envir = environment(formula(object)),   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/parametric_effects.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimated values for parametric model terms ‚Äî parametric_effects","text":"object fitted model object. ... arguments passed methods. terms character; model parametric terms drawn? Default NULL plot parametric terms can drawn. unconditional logical; confidence intervals include uncertainty due smoothness selection? TRUE, corrected Bayesian covariance matrix used. unnest logical; unnest smooth objects? ci_level numeric; coverage required confidence interval. Currently ignored. envir environment look data within.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/parametric_terms.html","id":null,"dir":"Reference","previous_headings":"","what":"Names of any parametric terms in a GAM ‚Äî parametric_terms","title":"Names of any parametric terms in a GAM ‚Äî parametric_terms","text":"Names parametric terms GAM","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/parametric_terms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Names of any parametric terms in a GAM ‚Äî parametric_terms","text":"","code":"parametric_terms(model, ...)  # S3 method for default parametric_terms(model, ...)  # S3 method for gam parametric_terms(model, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/parametric_terms.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Names of any parametric terms in a GAM ‚Äî parametric_terms","text":"model fitted model. ... arguments passed methods.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/partial_residuals.html","id":null,"dir":"Reference","previous_headings":"","what":"Partial residuals ‚Äî partial_residuals","title":"Partial residuals ‚Äî partial_residuals","text":"Partial residuals","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/partial_residuals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Partial residuals ‚Äî partial_residuals","text":"","code":"partial_residuals(object, ...)  # S3 method for gam partial_residuals(object, select = NULL, partial_match = FALSE, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/partial_residuals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Partial residuals ‚Äî partial_residuals","text":"object R object, typically model. Currently objects class \"gam\" (inherit class) supported. ... arguments passed methods. select character, logical, numeric; smooths plot. NULL, default, model smooths drawn. Numeric select indexes smooths order specified formula stored object. Character select matches labels smooths shown example output summary(object). Logical select operates per numeric select order smooths stored. partial_match logical; smooths selected partial matches select? TRUE, select can single string match .","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/partial_residuals.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Partial residuals ‚Äî partial_residuals","text":"","code":"# \\dontshow{ set.seed(1) op <- options(digits = 4, cli.unicode = FALSE) # } ## load mgcv load_mgcv()  ## example data - Gu & Wabha four term model df <- data_sim(\"eg1\", n = 400, seed = 42) ## fit the model m <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = df, method = 'REML')  ## extract partial residuals partial_residuals(m) #> # A tibble: 400 x 4 #>    `s(x0)` `s(x1)` `s(x2)` `s(x3)` #>      <dbl>   <dbl>   <dbl>   <dbl> #>  1  -0.353 -1.32    -2.18   0.608  #>  2  -0.123  0.501   -1.77   0.961  #>  3   1.43   1.52     5.61   0.991  #>  4  -1.11  -1.70    -0.888 -0.659  #>  5  -2.12  -0.0138  -2.73  -3.01   #>  6   1.25  -1.22     3.91   0.0728 #>  7  -0.522  3.02    -0.820 -1.02   #>  8   1.40   0.218    7.06   1.90   #>  9   2.80   0.497    7.33   2.50   #> 10   1.15  -0.227    0.720  0.744  #> # ... with 390 more rows  ## and for a select term partial_residuals(m, select = \"s(x2)\") #> # A tibble: 400 x 1 #>    `s(x2)` #>      <dbl> #>  1  -2.18  #>  2  -1.77  #>  3   5.61  #>  4  -0.888 #>  5  -2.73  #>  6   3.91  #>  7  -0.820 #>  8   7.06  #>  9   7.33  #> 10   0.720 #> # ... with 390 more rows  ## or with partial matching partial_residuals(m, select = \"x\", partial_match = TRUE) # returns all #> # A tibble: 400 x 4 #>    `s(x0)` `s(x1)` `s(x2)` `s(x3)` #>      <dbl>   <dbl>   <dbl>   <dbl> #>  1  -0.353 -1.32    -2.18   0.608  #>  2  -0.123  0.501   -1.77   0.961  #>  3   1.43   1.52     5.61   0.991  #>  4  -1.11  -1.70    -0.888 -0.659  #>  5  -2.12  -0.0138  -2.73  -3.01   #>  6   1.25  -1.22     3.91   0.0728 #>  7  -0.522  3.02    -0.820 -1.02   #>  8   1.40   0.218    7.06   1.90   #>  9   2.80   0.497    7.33   2.50   #> 10   1.15  -0.227    0.720  0.744  #> # ... with 390 more rows # \\dontshow{ options(op) # }"},{"path":"https://gavinsimpson.github.io/gratia/reference/penalty.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract and tidy penalty matrices ‚Äî penalty","title":"Extract and tidy penalty matrices ‚Äî penalty","text":"Extract tidy penalty matrices","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/penalty.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract and tidy penalty matrices ‚Äî penalty","text":"","code":"penalty(object, ...)  # S3 method for gam penalty(object, smooth = NULL, rescale = FALSE, ...)  # S3 method for mgcv.smooth penalty(object, rescale = FALSE, ...)  # S3 method for tensor.smooth penalty(object, margins = FALSE, ...)  # S3 method for t2.smooth penalty(object, margins = FALSE, ...)  # S3 method for re.smooth.spec penalty(object, data, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/penalty.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract and tidy penalty matrices ‚Äî penalty","text":"object fitted GAM smooth. ... additional arguments passed methods. smooth character; vector smooths extract penalty matrices . NULL, penalty matrices smooths object extracted. rescale logical; default, mgcv scale penalty matrix better performance mgcv::gamm(). rescale TRUE, scaling undone put penalty matrix back original scale. margins logical; extract penalty matrices tensor product marginal smooths tensor product? data data frame; data frame values terms mentioned smooth specification.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/penalty.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract and tidy penalty matrices ‚Äî penalty","text":"'tibble' (data frame) class penalty_df inheriting tbl_df, following components: smooth - character; label mgcv uses refer smooth, type - character; type smooth, penalty - character; label specific penalty. smooths multiple penalty matrices, penalty component identifies particular penalty matrix uses labelling mgcv uses internally, row - character; label form fn n integer nth basis function, referencing columns penalty matrix, col - character; label form fn n integer nth basis function, referencing columns penalty matrix, value - double; value penalty matrix combination row col,","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/penalty.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Extract and tidy penalty matrices ‚Äî penalty","text":"print() method uses base::zapsmall() turn small numbers 0s display purposes ; underlying values penalty matrix matrices changed.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/penalty.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Extract and tidy penalty matrices ‚Äî penalty","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/penalty.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract and tidy penalty matrices ‚Äî penalty","text":"","code":"# \\dontshow{ op <- options(cli.unicode = FALSE, digits = 5) # } load_mgcv() dat <- data_sim(\"eg4\", n = 400, seed = 42) m <- gam(y ~ s(x0) + s(x1) + s(x2, by = fac),          data = dat, method = \"REML\") penalty(m) #> # A tibble: 405 x 6 #>    smooth type  penalty row   col   value #>    <chr>  <chr> <chr>   <chr> <chr> <dbl> #>  1 s(x0)  TPRS  s(x0)   F1    F1     9.81 #>  2 s(x0)  TPRS  s(x0)   F1    F2    -1.45 #>  3 s(x0)  TPRS  s(x0)   F1    F3    -5    #>  4 s(x0)  TPRS  s(x0)   F1    F4    -1.34 #>  5 s(x0)  TPRS  s(x0)   F1    F5    -6.24 #>  6 s(x0)  TPRS  s(x0)   F1    F6     3.90 #>  7 s(x0)  TPRS  s(x0)   F1    F7    -7.74 #>  8 s(x0)  TPRS  s(x0)   F1    F8    -1.79 #>  9 s(x0)  TPRS  s(x0)   F1    F9     0    #> 10 s(x0)  TPRS  s(x0)   F2    F1    -1.45 #> # ... with 395 more rows  # for a specific smooth penalty(m, smooth = \"s(x2):fac1\") #> # A tibble: 81 x 6 #>    smooth     type  penalty    row   col   value #>    <chr>      <chr> <chr>      <chr> <chr> <dbl> #>  1 s(x2):fac1 TPRS  s(x2):fac1 F1    F1     9.94 #>  2 s(x2):fac1 TPRS  s(x2):fac1 F1    F2     1.40 #>  3 s(x2):fac1 TPRS  s(x2):fac1 F1    F3     4.78 #>  4 s(x2):fac1 TPRS  s(x2):fac1 F1    F4     1.13 #>  5 s(x2):fac1 TPRS  s(x2):fac1 F1    F5     5.84 #>  6 s(x2):fac1 TPRS  s(x2):fac1 F1    F6    -4.06 #>  7 s(x2):fac1 TPRS  s(x2):fac1 F1    F7     8.60 #>  8 s(x2):fac1 TPRS  s(x2):fac1 F1    F8     1.44 #>  9 s(x2):fac1 TPRS  s(x2):fac1 F1    F9     0    #> 10 s(x2):fac1 TPRS  s(x2):fac1 F2    F1     1.40 #> # ... with 71 more rows options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/posterior_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw samples from the posterior distribution of an estimated model ‚Äî posterior_samples","title":"Draw samples from the posterior distribution of an estimated model ‚Äî posterior_samples","text":"Draw samples posterior distribution estimated model","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/posterior_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw samples from the posterior distribution of an estimated model ‚Äî posterior_samples","text":"","code":"posterior_samples(model, ...)  # S3 method for gam posterior_samples(   model,   n,   newdata,   seed,   scale = c(\"response\", \"linear_predictor\"),   freq = FALSE,   unconditional = FALSE,   weights = NULL,   ncores = 1L,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/posterior_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw samples from the posterior distribution of an estimated model ‚Äî posterior_samples","text":"model fitted model supported types ... arguments passed methods. fitted_samples(), passed predict.gam(). n numeric; number posterior samples return. newdata data frame; new observations posterior draws model evaluated. supplied, data used fit model used newdata, available model. seed numeric; random seed simulations. scale character; freq logical; TRUE use frequentist covariance matrix parameter estimators, FALSE use Bayesian posterior covariance matrix parameters. unconditional logical; TRUE (freq == FALSE) Bayesian smoothing parameter uncertainty corrected covariance matrix used, available. weights numeric; vector prior weights. newdata null defaults object[[\"prior.weights\"]], otherwise vector ones. ncores number cores generating random variables multivariate normal distribution. Passed mvnfast::rmvn(). Parallelization take place OpenMP supported (appears work Windows current R).","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/posterior_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draw samples from the posterior distribution of an estimated model ‚Äî posterior_samples","text":"tibble (data frame) 3 columns containing posterior predicted values long format. columns row (integer) row newdata posterior draw relates , draw (integer) index, range 1:n, indicating draw row relates , response (numeric) predicted response indicated row newdata.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/posterior_samples.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Draw samples from the posterior distribution of an estimated model ‚Äî posterior_samples","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/predicted_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw new response values from the conditional distribution of the response ‚Äî predicted_samples","title":"Draw new response values from the conditional distribution of the response ‚Äî predicted_samples","text":"Predicted values response (new response data) drawn fitted model, created via simulate() (e.g. simulate.gam()) returned tidy, long, format. predicted values include uncertainty estimated model; simply draws conditional distribution response.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/predicted_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw new response values from the conditional distribution of the response ‚Äî predicted_samples","text":"","code":"predicted_samples(model, ...)  # S3 method for gam predicted_samples(   model,   n = 1,   newdata = NULL,   seed = NULL,   weights = NULL,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/predicted_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw new response values from the conditional distribution of the response ‚Äî predicted_samples","text":"model fitted model supported types ... arguments passed methods. fitted_samples(), passed predict.gam(). n numeric; number posterior samples return. newdata data frame; new observations posterior draws model evaluated. supplied, data used fit model used newdata, available model. seed numeric; random seed simulations. weights numeric; vector prior weights. newdata null defaults object[[\"prior.weights\"]], otherwise vector ones.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/predicted_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draw new response values from the conditional distribution of the response ‚Äî predicted_samples","text":"tibble (data frame) 3 columns containing posterior predicted values long format. columns row (integer) row newdata posterior draw relates , draw (integer) index, range 1:n, indicating draw row relates , response (numeric) predicted response indicated row newdata.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/predicted_samples.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Draw new response values from the conditional distribution of the response ‚Äî predicted_samples","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/predicted_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Draw new response values from the conditional distribution of the response ‚Äî predicted_samples","text":"","code":"load_mgcv() # \\dontshow{ set.seed(2) op <- options(cli.unicode = FALSE) # } dat <- gamSim(1, n = 1000, dist = \"normal\", scale = 2) #> Gu & Wahba 4 term additive model m <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = \"REML\")  predicted_samples(m, n = 5, seed = 42) #> # A tibble: 5,000 x 3 #>      row  draw response #>    <int> <int>    <dbl> #>  1     1     1     8.93 #>  2     2     1     4.23 #>  3     3     1     7.71 #>  4     4     1     8.51 #>  5     5     1    10.1  #>  6     6     1     8.20 #>  7     7     1     8.95 #>  8     8     1     7.20 #>  9     9     1    18.1  #> 10    10     1    12.7  #> # ... with 4,990 more rows  ## Can pass arguments to predict.gam() newd <- data.frame(x0 = runif(10), x1 = runif(10), x2 = runif(10),                    x3 = runif(10))  ## Exclude s(x2) predicted_samples(m, n = 5, newd, exclude = \"s(x2)\", seed = 25) #> # A tibble: 50 x 3 #>      row  draw response #>    <int> <int>    <dbl> #>  1     1     1     4.16 #>  2     2     1     7.32 #>  3     3     1     8.69 #>  4     4     1     6.36 #>  5     5     1     4.14 #>  6     6     1     8.28 #>  7     7     1    13.2  #>  8     8     1    13.1  #>  9     9     1     9.10 #> 10    10     1     6.27 #> # ... with 40 more rows  ## Exclude s(x1) predicted_samples(m, n = 5, newd, exclude = \"s(x1)\", seed = 25) #> # A tibble: 50 x 3 #>      row  draw response #>    <int> <int>    <dbl> #>  1     1     1     6.00 #>  2     2     1    11.7  #>  3     3     1     2.05 #>  4     4     1     9.03 #>  5     5     1     3.53 #>  6     6     1     8.29 #>  7     7     1    16.8  #>  8     8     1    12.4  #>  9     9     1    10.1  #> 10    10     1     6.68 #> # ... with 40 more rows  ## Select which terms --- result same as previous predicted_samples(m, n = 5, newd, seed = 25,                   terms = c(\"s(x0)\", \"s(x2)\", \"s(x3)\")) #> # A tibble: 50 x 3 #>      row  draw response #>    <int> <int>    <dbl> #>  1     1     1     6.00 #>  2     2     1    11.7  #>  3     3     1     2.05 #>  4     4     1     9.03 #>  5     5     1     3.53 #>  6     6     1     8.29 #>  7     7     1    16.8  #>  8     8     1    12.4  #>  9     9     1    10.1  #> 10    10     1     6.68 #> # ... with 40 more rows options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/qq_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile-quantile plot of model residuals ‚Äî qq_plot","title":"Quantile-quantile plot of model residuals ‚Äî qq_plot","text":"Quantile-quantile plot model residuals","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/qq_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile-quantile plot of model residuals ‚Äî qq_plot","text":"","code":"qq_plot(model, ...)  # S3 method for default qq_plot(model, ...)  # S3 method for gam qq_plot(   model,   method = c(\"uniform\", \"simulate\", \"normal\", \"direct\"),   type = c(\"deviance\", \"response\", \"pearson\"),   n_uniform = 10,   n_simulate = 50,   level = 0.9,   ylab = NULL,   xlab = NULL,   title = NULL,   subtitle = NULL,   caption = NULL,   ci_col = \"black\",   ci_alpha = 0.2,   point_col = \"black\",   point_alpha = 1,   line_col = \"red\",   ... )  # S3 method for glm qq_plot(model, ...)  # S3 method for lm qq_plot(model, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/qq_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile-quantile plot of model residuals ‚Äî qq_plot","text":"model fitted model. Currently class \"gam\". ... arguments passed ot methods. method character; method used generate theoretical quantiles. Note method = \"direct\" deprecated favour method = \"uniform\". type character; type residuals use. \"deviance\", \"response\", \"pearson\" residuals allowed. n_uniform numeric; number times randomize uniform quantiles direct computation method (method = \"uniform\"). n_simulate numeric; number data sets simulate estimated model using simulation method (method = \"simulate\"). level numeric; coverage level reference intervals. Must strictly 0 < level < 1. used method = \"simulate\". ylab character expression; label y axis. supplied, suitable label generated. xlab character expression; label y axis. supplied, suitable label generated. title character expression; title plot. See ggplot2::labs(). subtitle character expression; subtitle plot. See ggplot2::labs(). caption character expression; plot caption. See ggplot2::labs(). ci_col, ci_alpha fill colour alpha transparency reference interval method = \"simulate\". point_col, point_alpha colour alpha transparency points QQ plot. line_col colour used draw reference line.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/qq_plot.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Quantile-quantile plot of model residuals ‚Äî qq_plot","text":"wording used mgcv::qq.gam() uses direct reference simulated residuals method (method = \"simulated\"). avoid confusion, method = \"direct\" deprecated favour method = \"uniform\".","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/qq_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quantile-quantile plot of model residuals ‚Äî qq_plot","text":"","code":"load_mgcv() ## simulate binomial data... dat <- data_sim(\"eg1\", n = 200, dist = \"binary\", scale = .33, seed = 0) p <- binomial()$linkinv(dat$f)               # binomial p n <- sample(c(1, 3), 200, replace = TRUE) # binomial n dat <- transform(dat, y = rbinom(n, n, p), n = n) m <- gam( y / n ~ s(x0) + s(x1) + s(x2) + s(x3),          family = binomial, data = dat, weights = n,          method = \"REML\")  ## Q-Q plot; default using direct randomization of uniform quantiles qq_plot(m)   ## Alternatively use simulate new data from the model, which ## allows construction of reference intervals for the Q-Q plot qq_plot(m, method = \"simulate\", point_col = \"steelblue\",         point_alpha = 0.4)   ## ... or use the usual normality assumption qq_plot(m, method = \"normal\")"},{"path":"https://gavinsimpson.github.io/gratia/reference/ref_sims.html","id":null,"dir":"Reference","previous_headings":"","what":"Reference simulation data ‚Äî ref_sims","title":"Reference simulation data ‚Äî ref_sims","text":"set reference objects testing data_sim().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/ref_sims.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Reference simulation data ‚Äî ref_sims","text":"named list simulated data sets created data_sim().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/rep_first_factor_value.html","id":null,"dir":"Reference","previous_headings":"","what":"Repeat the first level of a factor n times ‚Äî rep_first_factor_value","title":"Repeat the first level of a factor n times ‚Äî rep_first_factor_value","text":"Function repeat first level factor n times return vector factor original levels intact","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/rep_first_factor_value.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Repeat the first level of a factor n times ‚Äî rep_first_factor_value","text":"","code":"rep_first_factor_value(f, n)"},{"path":"https://gavinsimpson.github.io/gratia/reference/rep_first_factor_value.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Repeat the first level of a factor n times ‚Äî rep_first_factor_value","text":"f factor n numeric; number times repeat first level f","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/rep_first_factor_value.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Repeat the first level of a factor n times ‚Äî rep_first_factor_value","text":"factor length n levels f, whose elements first level f.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/residuals_hist_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Histogram of model residuals ‚Äî residuals_hist_plot","title":"Histogram of model residuals ‚Äî residuals_hist_plot","text":"Histogram model residuals","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/residuals_hist_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Histogram of model residuals ‚Äî residuals_hist_plot","text":"","code":"residuals_hist_plot(   model,   type = c(\"deviance\", \"pearson\", \"response\"),   n_bins = c(\"sturges\", \"scott\", \"fd\"),   ylab = NULL,   xlab = NULL,   title = NULL,   subtitle = NULL,   caption = NULL )"},{"path":"https://gavinsimpson.github.io/gratia/reference/residuals_hist_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Histogram of model residuals ‚Äî residuals_hist_plot","text":"model fitted model. Currently class \"gam\". type character; type residuals use. \"deviance\", \"response\", \"pearson\" residuals allowed. n_bins character numeric; either number bins string indicating calculate number bins. ylab character expression; label y axis. supplied, suitable label generated. xlab character expression; label y axis. supplied, suitable label generated. title character expression; title plot. See ggplot2::labs(). subtitle character expression; subtitle plot. See ggplot2::labs(). caption character expression; plot caption. See ggplot2::labs().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/residuals_linpred_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot of residuals versus linear predictor values ‚Äî residuals_linpred_plot","title":"Plot of residuals versus linear predictor values ‚Äî residuals_linpred_plot","text":"Plot residuals versus linear predictor values","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/residuals_linpred_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot of residuals versus linear predictor values ‚Äî residuals_linpred_plot","text":"","code":"residuals_linpred_plot(   model,   type = c(\"deviance\", \"pearson\", \"response\"),   ylab = NULL,   xlab = NULL,   title = NULL,   subtitle = NULL,   caption = NULL,   point_col = \"black\",   point_alpha = 1,   line_col = \"red\" )"},{"path":"https://gavinsimpson.github.io/gratia/reference/residuals_linpred_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot of residuals versus linear predictor values ‚Äî residuals_linpred_plot","text":"model fitted model. Currently class \"gam\". type character; type residuals use. \"deviance\", \"response\", \"pearson\" residuals allowed. ylab character expression; label y axis. supplied, suitable label generated. xlab character expression; label y axis. supplied, suitable label generated. title character expression; title plot. See ggplot2::labs(). subtitle character expression; subtitle plot. See ggplot2::labs(). caption character expression; plot caption. See ggplot2::labs(). point_col colour used draw points plots. See graphics::par() section Color Specification. passed individual plotting functions, therefore affects points plots. point_alpha numeric; alpha transparency points plots. line_col colour specification 1:1 line.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/rootogram.html","id":null,"dir":"Reference","previous_headings":"","what":"Rootograms to assess goodness of model fit ‚Äî rootogram","title":"Rootograms to assess goodness of model fit ‚Äî rootogram","text":"rootogram model diagnostic tool assesses goodness fit statistical model. observed values response compared expected fitted model. discrete, count responses, frequency count (0, 1, 2, etc) observed data expected conditional distribution response implied model compared. continuous variables, observed expected frequencies obtained grouping data bins. rootogram drawn using ggplot2::ggplot() graphics. design closely follows Kleiber & Zeileis (2016).","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/rootogram.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rootograms to assess goodness of model fit ‚Äî rootogram","text":"","code":"rootogram(object, ...)  # S3 method for gam rootogram(object, max_count = NULL, breaks = \"Sturges\", ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/rootogram.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rootograms to assess goodness of model fit ‚Äî rootogram","text":"object R object ... arguments passed methods max_count integer; largest count consider breaks continuous responses, group response. Can anything acceptable breaks argument graphics::hist.default()","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/rootogram.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Rootograms to assess goodness of model fit ‚Äî rootogram","text":"Kleiber, C., Zeileis, ., (2016) Visualizing Count Data Regressions Using Rootograms. . Stat. 70, 296‚Äì303. doi: 10.1080/00031305.2016.1173590","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/rootogram.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rootograms to assess goodness of model fit ‚Äî rootogram","text":"","code":"load_mgcv() op <- options(cli.unicode = FALSE, digits = 6) df <- data_sim(\"eg1\", n = 1000, dist = \"poisson\", scale = 0.1, seed = 6)  # A poisson example m <- gam(y ~ s(x0, bs = \"cr\") + s(x1, bs = \"cr\") + s(x2, bs = \"cr\") +          s(x3, bs = \"cr\"), family = poisson(), data = df, method = \"REML\") rg <- rootogram(m) rg #> # A tibble: 21 x 3 #>      bin observed fitted #>    <dbl>    <int>  <dbl> #>  1     0      113 117.   #>  2     1      236 228.   #>  3     2      230 239.   #>  4     3      200 182.   #>  5     4       94 113.   #>  6     5       68  62.5  #>  7     6       27  31.7  #>  8     7       22  15.1  #>  9     8        4   6.89 #> 10     9        3   3.00 #> # ... with 11 more rows draw(rg) # plot the rootogram   # A Gaussian example df <- data_sim(\"eg1\", dist = \"normal\", seed = 2) m <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = df, method = \"REML\") draw(rootogram(m, breaks = \"FD\"), type = \"suspended\")  options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/seq_min_max.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a sequence of evenly-spaced values ‚Äî seq_min_max","title":"Create a sequence of evenly-spaced values ‚Äî seq_min_max","text":"continuous vector x, seq_min_max() creates sequence n evenly-spaced values range min(x) --","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/seq_min_max.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a sequence of evenly-spaced values ‚Äî seq_min_max","text":"","code":"seq_min_max(x, n)"},{"path":"https://gavinsimpson.github.io/gratia/reference/seq_min_max.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a sequence of evenly-spaced values ‚Äî seq_min_max","text":"x numeric; vector evenly-spaced values returned n numeric; number evenly-spaced values return","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/seq_min_max.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a sequence of evenly-spaced values ‚Äî seq_min_max","text":"numeric vector length n.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/seq_min_max.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a sequence of evenly-spaced values ‚Äî seq_min_max","text":"","code":"set.seed(1) x <- rnorm(10) n <- 10L seq_min_max(x, n = n) #>  [1] -0.83562861 -0.56552757 -0.29542652 -0.02532547  0.24477557  0.51487662 #>  [7]  0.78497766  1.05507871  1.32517976  1.59528080"},{"path":"https://gavinsimpson.github.io/gratia/reference/seq_min_max_eps.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a sequence of evenly-spaced values adjusted to accommodate a\nsmall adjustment ‚Äî seq_min_max_eps","title":"Create a sequence of evenly-spaced values adjusted to accommodate a\nsmall adjustment ‚Äî seq_min_max_eps","text":"Creates sequence n evenly-spaced values range min(x) -- max(x), minimum maximum adjusted always contained within range x x may shifted forwards backwards amount related eps. particularly useful computing derivatives via finite differences without adjustment may predicting values outside range data hence conmstraints penalty.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/seq_min_max_eps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a sequence of evenly-spaced values adjusted to accommodate a\nsmall adjustment ‚Äî seq_min_max_eps","text":"","code":"seq_min_max_eps(x, n, order, type = c(\"forward\", \"backward\", \"central\"), eps)"},{"path":"https://gavinsimpson.github.io/gratia/reference/seq_min_max_eps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a sequence of evenly-spaced values adjusted to accommodate a\nsmall adjustment ‚Äî seq_min_max_eps","text":"x numeric; vector evenly-spaced values returned n numeric; number evenly-spaced values return order integer; order derivative. Either 1 2 first second order derivatives type character; type finite difference used. One \"forward\", \"backward\", \"central\" eps numeric; finite difference","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/seq_min_max_eps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a sequence of evenly-spaced values adjusted to accommodate a\nsmall adjustment ‚Äî seq_min_max_eps","text":"numeric vector length n.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/shift_values.html","id":null,"dir":"Reference","previous_headings":"","what":"Shift numeric values in a data frame by an amount eps ‚Äî shift_values","title":"Shift numeric values in a data frame by an amount eps ‚Äî shift_values","text":"Shift numeric values data frame amount eps","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/shift_values.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Shift numeric values in a data frame by an amount eps ‚Äî shift_values","text":"","code":"shift_values(df, h, i, FUN = \"+\")"},{"path":"https://gavinsimpson.github.io/gratia/reference/shift_values.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Shift numeric values in a data frame by an amount eps ‚Äî shift_values","text":"df data frame tibble. h numeric; amount shift values df . logical; vector indexing columns df included shift. FUN function; function applut shift. Typically + -.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/simulate.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate from the posterior distribution of a GAM ‚Äî simulate.gam","title":"Simulate from the posterior distribution of a GAM ‚Äî simulate.gam","text":"Simulations posterior distribution fitted GAM model involve computing predicted values observation data simulated data required, generating random draws probability distribution used fitting model.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/simulate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate from the posterior distribution of a GAM ‚Äî simulate.gam","text":"","code":"# S3 method for gam simulate(object, nsim = 1, seed = NULL, newdata = NULL, weights = NULL, ...)  # S3 method for gamm simulate(object, nsim = 1, seed = NULL, newdata = NULL, weights = NULL, ...)  # S3 method for scam simulate(object, nsim = 1, seed = NULL, newdata = NULL, weights = NULL, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/simulate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate from the posterior distribution of a GAM ‚Äî simulate.gam","text":"object fitted GAM, typically result call mgcv::gam` mgcv::gamm(). nsim numeric; number posterior simulations return. seed numeric; random seed simulations. newdata data frame; new observations posterior draws model evaluated. supplied, data used fit model used newdata, available object. weights numeric; vector prior weights. newdata null defaults object[[\"prior.weights\"]], otherwise vector ones. ... arguments passed methods. simulate.gam() simulate.scam() pass ... predict.gam(). can pass additional arguments terms, exclude, select model terms included predictions. may useful, example, excluding effects random effect terms.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/simulate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate from the posterior distribution of a GAM ‚Äî simulate.gam","text":"(Currently) matrix nsim columns.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/simulate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate from the posterior distribution of a GAM ‚Äî simulate.gam","text":"simulate.gam() function, family component fitted model must contain, updateable contain, required random number generator. See mgcv::fix.family.rd().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/simulate.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate from the posterior distribution of a GAM ‚Äî simulate.gam","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/simulate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate from the posterior distribution of a GAM ‚Äî simulate.gam","text":"","code":"load_mgcv() set.seed(2) dat <- gamSim(1, n = 400, dist = \"normal\", scale = 2) #> Gu & Wahba 4 term additive model m1 <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = \"REML\")  sims <- simulate(m1, nsim = 5, seed = 42) head(sims) #>           [,1]      [,2]      [,3]      [,4]      [,5] #> [1,] 11.445470 11.374304 10.098681  7.264881  8.796630 #> [2,]  6.510912  5.909584  9.057362  7.698084 11.444781 #> [3,]  3.837995  3.230610  3.550240  3.759380  4.774581 #> [4,] 12.361830 11.209226 10.714215 11.861957 10.746417 #> [5,] 14.851461 12.911440 11.356984 15.783913 15.106270 #> [6,]  5.921276  4.158963  5.520856  7.973614  9.654888"},{"path":"https://gavinsimpson.github.io/gratia/reference/smallAges.html","id":null,"dir":"Reference","previous_headings":"","what":"Lead-210 age-depth measurements for Small Water ‚Äî smallAges","title":"Lead-210 age-depth measurements for Small Water ‚Äî smallAges","text":"dataset containing lead-210 based age depth measurements SMALL1 core Small Water.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smallAges.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Lead-210 age-depth measurements for Small Water ‚Äî smallAges","text":"data frame 12 rows 7 variables.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smallAges.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Lead-210 age-depth measurements for Small Water ‚Äî smallAges","text":"Simpson, G.L. (Unpublished data).","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smallAges.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Lead-210 age-depth measurements for Small Water ‚Äî smallAges","text":"variables follows: Depth Drymass Date Age Error SedAccRate SedPerCentChange","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_coefs.html","id":null,"dir":"Reference","previous_headings":"","what":"Indices of the parametric terms for a particular smooth ‚Äî smooth_coefs","title":"Indices of the parametric terms for a particular smooth ‚Äî smooth_coefs","text":"Returns vector indices parametric terms represent supplied smooth. Useful extracting model coefficients columns covariance matrix.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_coefs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Indices of the parametric terms for a particular smooth ‚Äî smooth_coefs","text":"","code":"smooth_coefs(smooth)"},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_coefs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Indices of the parametric terms for a particular smooth ‚Äî smooth_coefs","text":"smooth object inherits class mgcv.smooth","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_coefs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Indices of the parametric terms for a particular smooth ‚Äî smooth_coefs","text":"numeric vector indices.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_coefs.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Indices of the parametric terms for a particular smooth ‚Äî smooth_coefs","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate regular data over the covariates of a smooth ‚Äî smooth_data","title":"Generate regular data over the covariates of a smooth ‚Äî smooth_data","text":"Generate regular data covariates smooth","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate regular data over the covariates of a smooth ‚Äî smooth_data","text":"","code":"smooth_data(   model,   id,   n = 100,   n_3d = NULL,   n_4d = NULL,   offset = NULL,   include_all = FALSE )"},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate regular data over the covariates of a smooth ‚Äî smooth_data","text":"model fitted model id number ID smooth within model process. n numeric; number new observations generate. n_3d numeric; number new observations generate third dimension 3D smooth. n_4d numeric; number new observations generate dimensions higher 2 (!) kD smooth (k >= 4). example, smooth 4D smooth, dimensions 3 4 get n_4d new observations. offset numeric; value model offset use. include_all logical; include covariates involved smooth? FALSE, covariates involved smooth included returned data frame. TRUE, representative value included covariates model actually used model. can useful want pass returned data frame mgcv::PredictMat().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_dim.html","id":null,"dir":"Reference","previous_headings":"","what":"Dimension of a smooth ‚Äî smooth_dim","title":"Dimension of a smooth ‚Äî smooth_dim","text":"Extracts dimension estimated smooth.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_dim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dimension of a smooth ‚Äî smooth_dim","text":"","code":"smooth_dim(object)  # S3 method for gam smooth_dim(object)  # S3 method for gamm smooth_dim(object)  # S3 method for mgcv.smooth smooth_dim(object)"},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_dim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Dimension of a smooth ‚Äî smooth_dim","text":"object R object. See Details list supported objects.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_dim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Dimension of a smooth ‚Äî smooth_dim","text":"numeric vector dimensions smooth.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_dim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Dimension of a smooth ‚Äî smooth_dim","text":"generic function methods objects class \"gam\", \"gamm\", \"mgcv.smooth\".","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_dim.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Dimension of a smooth ‚Äî smooth_dim","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_estimates.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate smooths at covariate values ‚Äî smooth_estimates","title":"Evaluate smooths at covariate values ‚Äî smooth_estimates","text":"Evaluate smooth grid evenly spaced value range covariate associated smooth. Alternatively, set points smooth evaluated can supplied. smooth_estimates() new implementation evaluate_smooth(), used instead function.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_estimates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate smooths at covariate values ‚Äî smooth_estimates","text":"","code":"smooth_estimates(object, ...)  # S3 method for gam smooth_estimates(   object,   smooth = NULL,   n = 100,   n_3d = NULL,   n_4d = NULL,   data = NULL,   unconditional = FALSE,   overall_uncertainty = TRUE,   dist = NULL,   unnest = TRUE,   partial_match = FALSE,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_estimates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate smooths at covariate values ‚Äî smooth_estimates","text":"object object class \"gam\" \"gamm\". ... arguments passed methods. smooth character; single smooth evaluate. n numeric; number points range covariate evaluate smooth. n_3d, n_4d numeric; number points range last covariate 3D 4D smooth. default NULL achieves standard behaviour using n points range covariate, resulting n^d evaluation pointsm, d dimension smooth. d > 2 can result many evaluation points slow performance. smooths d > 4, value n_4d used dimensions > 4, unless NULL, case default behaviour (using n dimensions) observed. data data frame covariate values evaluate smooth. unconditional logical; confidence intervals include uncertainty due smoothness selection? TRUE, corrected Bayesian covariance matrix used. overall_uncertainty logical; uncertainty model constant term included standard error evaluate values smooth? dist numeric; greater 0, used determine location far data plotted plotting 2-D smooths. data scaled unit square deciding exclude, dist distance within unit square. See mgcv::exclude..far() details. unnest logical; unnest smooth objects? partial_match logical; case character select, select match partially smooths? partial_match = TRUE, select must single string, character vector length 1.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_estimates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate smooths at covariate values ‚Äî smooth_estimates","text":"data frame (tibble), class \"smooth_estimates\".","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_estimates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluate smooths at covariate values ‚Äî smooth_estimates","text":"","code":"load_mgcv() op <- options(cli.unicode = FALSE, digits = 6) dat <- data_sim(\"eg1\", n = 400, dist = \"normal\", scale = 2, seed = 2) m1 <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = \"REML\")  ## evaluate all smooths smooth_estimates(m1) #> # A tibble: 400 x 9 #>    smooth type  by       est    se      x0    x1    x2    x3 #>    <chr>  <chr> <chr>  <dbl> <dbl>   <dbl> <dbl> <dbl> <dbl> #>  1 s(x0)  TPRS  NA    -0.967 0.316 0.00711    NA    NA    NA #>  2 s(x0)  TPRS  NA    -0.925 0.297 0.0171     NA    NA    NA #>  3 s(x0)  TPRS  NA    -0.884 0.279 0.0271     NA    NA    NA #>  4 s(x0)  TPRS  NA    -0.843 0.263 0.0371     NA    NA    NA #>  5 s(x0)  TPRS  NA    -0.802 0.247 0.0471     NA    NA    NA #>  6 s(x0)  TPRS  NA    -0.761 0.234 0.0571     NA    NA    NA #>  7 s(x0)  TPRS  NA    -0.719 0.222 0.0671     NA    NA    NA #>  8 s(x0)  TPRS  NA    -0.678 0.211 0.0772     NA    NA    NA #>  9 s(x0)  TPRS  NA    -0.636 0.202 0.0872     NA    NA    NA #> 10 s(x0)  TPRS  NA    -0.595 0.195 0.0972     NA    NA    NA #> # ... with 390 more rows  ## or selected smooths smooth_estimates(m1, smooth = c(\"s(x0)\", \"s(x1)\")) #> # A tibble: 200 x 7 #>    smooth type  by       est    se      x0    x1 #>    <chr>  <chr> <chr>  <dbl> <dbl>   <dbl> <dbl> #>  1 s(x0)  TPRS  NA    -0.967 0.316 0.00711    NA #>  2 s(x0)  TPRS  NA    -0.925 0.297 0.0171     NA #>  3 s(x0)  TPRS  NA    -0.884 0.279 0.0271     NA #>  4 s(x0)  TPRS  NA    -0.843 0.263 0.0371     NA #>  5 s(x0)  TPRS  NA    -0.802 0.247 0.0471     NA #>  6 s(x0)  TPRS  NA    -0.761 0.234 0.0571     NA #>  7 s(x0)  TPRS  NA    -0.719 0.222 0.0671     NA #>  8 s(x0)  TPRS  NA    -0.678 0.211 0.0772     NA #>  9 s(x0)  TPRS  NA    -0.636 0.202 0.0872     NA #> 10 s(x0)  TPRS  NA    -0.595 0.195 0.0972     NA #> # ... with 190 more rows options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior draws for individual smooths ‚Äî smooth_samples","title":"Posterior draws for individual smooths ‚Äî smooth_samples","text":"Returns draws posterior distributions smooth functions GAM. Useful, example, visualising uncertainty individual estimated functions.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior draws for individual smooths ‚Äî smooth_samples","text":"","code":"smooth_samples(model, ...)  # S3 method for gam smooth_samples(   model,   term = NULL,   n = 1,   newdata = NULL,   seed = NULL,   freq = FALSE,   unconditional = FALSE,   ncores = 1L,   n_vals = 200,   ... )"},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior draws for individual smooths ‚Äî smooth_samples","text":"model fitted model supported types ... arguments passed methods. fitted_samples(), passed predict.gam(). term character; select smooth's posterior draw . default (NULL) means posteriors smooths model wil sampled . supplied, character vector requested terms. n numeric; number posterior samples return. newdata data frame; new observations posterior draws model evaluated. supplied, data used fit model used newdata, available model. seed numeric; random seed simulations. freq logical; TRUE use frequentist covariance matrix parameter estimators, FALSE use Bayesian posterior covariance matrix parameters. unconditional logical; TRUE (freq == FALSE) Bayesian smoothing parameter uncertainty corrected covariance matrix used, available. ncores number cores generating random variables multivariate normal distribution. Passed mvnfast::rmvn(). Parallelization take place OpenMP supported (appears work Windows current R). n_vals numeric; many locations evaluate smooth newdata supplied","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior draws for individual smooths ‚Äî smooth_samples","text":"tibble additional classes \"smooth_samples\" `\"posterior_samples\". \"gam\" method, columns currently returned (order) : smooth; character vector. Indicates smooth function particular draw, term; character vector. Similar smooth, contain full label smooth, differentiate factor-smooths example. by_variable; character vector. smooth involves term, variable named , NA_character_ otherwise. row; integer. vector values seq_len(n_vals), repeated n > 1L. Indexes row newdata particular draw. draw; integer. vector integer values indexing particular posterior draw row belongs . value; numeric. value smooth function posterior draw covariate combination. .xN; numeric. series one columns containing data required smooth. .x1 always present contains values covariate smooth. example smooth s(z) .x1 contain values covariate z smooth evaluated. covariates multi-dimensional thin plate splines (e.g. s(x, z)) tensor product smooths (e.g. te(x,z,)) result variables .x1 .x2, .x1, .x2, .x3 respectively, number (1, 2, etc) representing order covariates specified smooth. Additional columns present case factor smooths, contain level factor named by_variable particular posterior draw.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_samples.html","id":"warning","dir":"Reference","previous_headings":"","what":"Warning","title":"Posterior draws for individual smooths ‚Äî smooth_samples","text":"set variables returned order tibble subject change future versions. rely position.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_samples.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Posterior draws for individual smooths ‚Äî smooth_samples","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooth_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Posterior draws for individual smooths ‚Äî smooth_samples","text":"","code":"load_mgcv() op <- options(cli.unicode = FALSE) dat <- data_sim(\"eg1\", n = 1000, seed = 2) m1 <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = \"REML\")  smooth_samples(m1, term = \"s(x0)\", n = 5, seed = 42) #> # A tibble: 1,000 x 7 #>    smooth term  by_variable      .x1   row  draw  value #>    <chr>  <chr> <chr>          <dbl> <int> <int>  <dbl> #>  1 s(x0)  s(x0) NA          0.000663     1     1 -0.961 #>  2 s(x0)  s(x0) NA          0.00568      2     1 -0.933 #>  3 s(x0)  s(x0) NA          0.0107       3     1 -0.906 #>  4 s(x0)  s(x0) NA          0.0157       4     1 -0.878 #>  5 s(x0)  s(x0) NA          0.0207       5     1 -0.850 #>  6 s(x0)  s(x0) NA          0.0258       6     1 -0.822 #>  7 s(x0)  s(x0) NA          0.0308       7     1 -0.795 #>  8 s(x0)  s(x0) NA          0.0358       8     1 -0.768 #>  9 s(x0)  s(x0) NA          0.0408       9     1 -0.740 #> 10 s(x0)  s(x0) NA          0.0458      10     1 -0.713 #> # ... with 990 more rows  ## A factor by example (with a spurious covariate x0) dat <- data_sim(\"eg4\", n = 1000, seed = 2)  ## fit model... m2 <- gam(y ~ fac + s(x2, by = fac) + s(x0), data = dat) sms <- smooth_samples(m2, n = 5, seed = 42) draw(sms)  options(op)"},{"path":"https://gavinsimpson.github.io/gratia/reference/smooths.html","id":null,"dir":"Reference","previous_headings":"","what":"Names of smooths in a GAM ‚Äî smooths","title":"Names of smooths in a GAM ‚Äî smooths","text":"Names smooths GAM","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/smooths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Names of smooths in a GAM ‚Äî smooths","text":"","code":"smooths(object)"},{"path":"https://gavinsimpson.github.io/gratia/reference/smooths.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Names of smooths in a GAM ‚Äî smooths","text":"object fitted GAM related model. Typically result call mgcv::gam(), mgcv::bam(), mgcv::gamm().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/term_names.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract names of all variables needed to fit a GAM or a smooth ‚Äî term_names","title":"Extract names of all variables needed to fit a GAM or a smooth ‚Äî term_names","text":"Extract names variables needed fit GAM smooth","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/term_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract names of all variables needed to fit a GAM or a smooth ‚Äî term_names","text":"","code":"term_names(object, ...)  # S3 method for gam term_names(object, ...)  # S3 method for mgcv.smooth term_names(object, ...)  # S3 method for gamm term_names(object, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/term_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract names of all variables needed to fit a GAM or a smooth ‚Äî term_names","text":"object fitted GAM object mgcv smooth object ... arguments passed methods. currently used.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/term_names.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract names of all variables needed to fit a GAM or a smooth ‚Äî term_names","text":"vector variable names required terms model","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/term_variables.html","id":null,"dir":"Reference","previous_headings":"","what":"Names of variables involved in a specified model term ‚Äî term_variables","title":"Names of variables involved in a specified model term ‚Äî term_variables","text":"Given name (term label) term model, returns names variables involved term.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/term_variables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Names of variables involved in a specified model term ‚Äî term_variables","text":"","code":"term_variables(object, term, ...)  # S3 method for terms term_variables(object, term, ...)  # S3 method for gam term_variables(object, term, ...)  # S3 method for bam term_variables(object, term, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/term_variables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Names of variables involved in a specified model term ‚Äî term_variables","text":"object R object method dispatch performed term character; name model term, sense attr(terms(object), \"term.labels\"). Currently checked see term exists model. ... arguments passed methods.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/term_variables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Names of variables involved in a specified model term ‚Äî term_variables","text":"character vector variable names.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/theta.html","id":null,"dir":"Reference","previous_headings":"","what":"General extractor for additional parameters in mgcv models ‚Äî theta","title":"General extractor for additional parameters in mgcv models ‚Äî theta","text":"General extractor additional parameters mgcv models","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/theta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"General extractor for additional parameters in mgcv models ‚Äî theta","text":"","code":"theta(object, ...)  # S3 method for gam theta(object, transform = TRUE, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/theta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"General extractor for additional parameters in mgcv models ‚Äî theta","text":"object fitted model ... arguments passed methods. transform logical; transform natural scale parameter","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/theta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"General extractor for additional parameters in mgcv models ‚Äî theta","text":"Returns numeric vector additional parameters","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/theta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"General extractor for additional parameters in mgcv models ‚Äî theta","text":"","code":"load_mgcv() df <- data_sim(\"eg1\", dist = \"poisson\", seed = 42, scale = 1/5) m <- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = df, method = \"REML\",          family = nb()) p <- theta(m)"},{"path":"https://gavinsimpson.github.io/gratia/reference/tidy_basis.html","id":null,"dir":"Reference","previous_headings":"","what":"A tidy basis representation of a smooth object ‚Äî tidy_basis","title":"A tidy basis representation of a smooth object ‚Äî tidy_basis","text":"Takes object class mgcv.smooth returns tidy representation basis.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/tidy_basis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A tidy basis representation of a smooth object ‚Äî tidy_basis","text":"","code":"tidy_basis(smooth, data)"},{"path":"https://gavinsimpson.github.io/gratia/reference/tidy_basis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A tidy basis representation of a smooth object ‚Äî tidy_basis","text":"smooth smooth object. data data frame containing variables used smooth.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/tidy_basis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A tidy basis representation of a smooth object ‚Äî tidy_basis","text":"tibble.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/tidy_basis.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"A tidy basis representation of a smooth object ‚Äî tidy_basis","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/to_na.html","id":null,"dir":"Reference","previous_headings":"","what":"Sets the elements of vector to NA ‚Äî to_na","title":"Sets the elements of vector to NA ‚Äî to_na","text":"Given vector indexing elements x, sets selected elements x NA.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/to_na.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sets the elements of vector to NA ‚Äî to_na","text":"","code":"to_na(x, i)"},{"path":"https://gavinsimpson.github.io/gratia/reference/to_na.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sets the elements of vector to NA ‚Äî to_na","text":"x vector values vector values used subset x","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/to_na.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sets the elements of vector to NA ‚Äî to_na","text":"Returns x possibly elements set NA","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/too_far.html","id":null,"dir":"Reference","previous_headings":"","what":"Exclude values that lie too far from the support of data ‚Äî too_far","title":"Exclude values that lie too far from the support of data ‚Äî too_far","text":"Identifies pairs covariate values lie far original data. function currently basic wrapper around mgcv::exclude..far().","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/too_far.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Exclude values that lie too far from the support of data ‚Äî too_far","text":"","code":"too_far(x, y, ref_1, ref_2, dist = NULL)"},{"path":"https://gavinsimpson.github.io/gratia/reference/too_far.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Exclude values that lie too far from the support of data ‚Äî too_far","text":"x, y numeric; vector values covariates compare observed data ref_1, ref_2 numeric; vectors covariate values represent reference x1 x2` compared dist supplied, numeric vector length 1 representing distance data beyond observation excluded. example, want exclude values lie observation 10% range observed data, use 0.1.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/too_far.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Exclude values that lie too far from the support of data ‚Äî too_far","text":"Returns logical vector length x1.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/too_far_to_na.html","id":null,"dir":"Reference","previous_headings":"","what":"Set rows of data to NA if the lie too far from a reference set of values ‚Äî too_far_to_na","title":"Set rows of data to NA if the lie too far from a reference set of values ‚Äî too_far_to_na","text":"Set rows data NA lie far reference set values","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/too_far_to_na.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set rows of data to NA if the lie too far from a reference set of values ‚Äî too_far_to_na","text":"","code":"too_far_to_na(smooth, input, reference, cols, dist = NULL)"},{"path":"https://gavinsimpson.github.io/gratia/reference/too_far_to_na.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set rows of data to NA if the lie too far from a reference set of values ‚Äî too_far_to_na","text":"smooth mgcv smooth object input data frame containing input observations columns set NA reference data frame containing reference values cols character vector columns whose elements set NA data lies far reference set dist numeric, distance reference set beyond elements input set NA","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/transform_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform estimated values and confidence intervals by applying a function ‚Äî transform_fun","title":"Transform estimated values and confidence intervals by applying a function ‚Äî transform_fun","text":"Transform estimated values confidence intervals applying function","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/transform_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform estimated values and confidence intervals by applying a function ‚Äî transform_fun","text":"","code":"transform_fun(object, fun = NULL, ...)  # S3 method for evaluated_smooth transform_fun(object, fun = NULL, ...)  # S3 method for smooth_estimates transform_fun(object, fun = NULL, ...)  # S3 method for mgcv_smooth transform_fun(object, fun = NULL, ...)  # S3 method for evaluated_parametric_term transform_fun(object, fun = NULL, ...)  # S3 method for parametric_effects transform_fun(object, fun = NULL, ...)  # S3 method for tbl_df transform_fun(object, fun = NULL, column = NULL, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/transform_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform estimated values and confidence intervals by applying a function ‚Äî transform_fun","text":"object object apply transform function . fun function apply. ... additional arguments passed methods. column character; \"tbl_df\" method, column transform.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/transform_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform estimated values and confidence intervals by applying a function ‚Äî transform_fun","text":"Returns object estimate upper lower values confidence interval transformed via function.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/transform_fun.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Transform estimated values and confidence intervals by applying a function ‚Äî transform_fun","text":"Gavin L. Simpson","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/typical_values.html","id":null,"dir":"Reference","previous_headings":"","what":"Typical values of model covariates ‚Äî typical_values","title":"Typical values of model covariates ‚Äî typical_values","text":"Typical values model covariates","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/typical_values.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Typical values of model covariates ‚Äî typical_values","text":"","code":"typical_values(object, ...)  # S3 method for gam typical_values(object, vars = everything(), ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/typical_values.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Typical values of model covariates ‚Äî typical_values","text":"object fitted GAM(M) model. ... arguments passed methods. vars terms include exclude returned object. Uses tidyselect principles.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/variance_comp.html","id":null,"dir":"Reference","previous_headings":"","what":"Variance components of smooths from smoothness estimates ‚Äî variance_comp","title":"Variance components of smooths from smoothness estimates ‚Äî variance_comp","text":"wrapper mgcv::gam.vcomp() returns smoothing parameters expressed variance components.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/variance_comp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variance components of smooths from smoothness estimates ‚Äî variance_comp","text":"","code":"variance_comp(object, ...)  # S3 method for gam variance_comp(object, rescale = TRUE, coverage = 0.95, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/variance_comp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variance components of smooths from smoothness estimates ‚Äî variance_comp","text":"object R object. Currently models fitted mgcv::gam() mgcv::bam() supported. ... arguments passed methods rescale logical; numerical stability reasons penalty matrices smooths rescaled fitting. rescale = TRUE, rescaling undone, resulting variance components original scale. needed comparing mixed model software, lmer(). coverage numeric; value 0 1 indicating (approximate) coverage confidence interval returned.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/variance_comp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Variance components of smooths from smoothness estimates ‚Äî variance_comp","text":"function wrapper mgcv::gam.vcomp() performs three additional services suppresses annoying text output mgcv::gam.vcomp() prints terminal, returns variance smooth well standard deviation, returns variance components tibble.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/vars_from_label.html","id":null,"dir":"Reference","previous_headings":"","what":"Returns names of variables from a smooth label ‚Äî vars_from_label","title":"Returns names of variables from a smooth label ‚Äî vars_from_label","text":"Returns names variables smooth label","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/vars_from_label.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Returns names of variables from a smooth label ‚Äî vars_from_label","text":"","code":"vars_from_label(label)"},{"path":"https://gavinsimpson.github.io/gratia/reference/vars_from_label.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Returns names of variables from a smooth label ‚Äî vars_from_label","text":"label character; length 1 character vector containing label smooth.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/vars_from_label.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Returns names of variables from a smooth label ‚Äî vars_from_label","text":"","code":"vars_from_label(\"s(x1)\") #> [1] \"x1\" vars_from_label(\"t2(x1,x2,x3)\") #> [1] \"x1\" \"x2\" \"x3\""},{"path":"https://gavinsimpson.github.io/gratia/reference/which_smooths.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify a smooth term by its label ‚Äî which_smooths","title":"Identify a smooth term by its label ‚Äî which_smooths","text":"Identify smooth term label","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/which_smooths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify a smooth term by its label ‚Äî which_smooths","text":"","code":"which_smooths(object, ...)  # S3 method for default which_smooths(object, ...)  # S3 method for gam which_smooths(object, terms, ...)  # S3 method for bam which_smooths(object, terms, ...)  # S3 method for gamm which_smooths(object, terms, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/which_smooths.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify a smooth term by its label ‚Äî which_smooths","text":"object fitted GAM. ... arguments passed methods. terms character; one (partial) term labels identify required smooths.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/worm_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Worm plot of model residuals ‚Äî worm_plot","title":"Worm plot of model residuals ‚Äî worm_plot","text":"Worm plot model residuals","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/worm_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Worm plot of model residuals ‚Äî worm_plot","text":"","code":"worm_plot(model, ...)  # S3 method for gam worm_plot(   model,   method = c(\"uniform\", \"simulate\", \"normal\", \"direct\"),   type = c(\"deviance\", \"response\", \"pearson\"),   n_uniform = 10,   n_simulate = 50,   level = 0.9,   ylab = NULL,   xlab = NULL,   title = NULL,   subtitle = NULL,   caption = NULL,   ci_col = \"black\",   ci_alpha = 0.2,   point_col = \"black\",   point_alpha = 1,   line_col = \"red\",   ... )  # S3 method for glm worm_plot(model, ...)  # S3 method for lm worm_plot(model, ...)"},{"path":"https://gavinsimpson.github.io/gratia/reference/worm_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Worm plot of model residuals ‚Äî worm_plot","text":"model fitted model. Currently class \"gam\". ... arguments passed ot methods. method character; method used generate theoretical quantiles. Note method = \"direct\" deprecated favour method = \"uniform\". type character; type residuals use. \"deviance\", \"response\", \"pearson\" residuals allowed. n_uniform numeric; number times randomize uniform quantiles direct computation method (method = \"uniform\"). n_simulate numeric; number data sets simulate estimated model using simulation method (method = \"simulate\"). level numeric; coverage level reference intervals. Must strictly 0 < level < 1. used method = \"simulate\". ylab character expression; label y axis. supplied, suitable label generated. xlab character expression; label y axis. supplied, suitable label generated. title character expression; title plot. See ggplot2::labs(). subtitle character expression; subtitle plot. See ggplot2::labs(). caption character expression; plot caption. See ggplot2::labs(). ci_col fill colour alpha transparency reference interval method = \"simulate\". ci_alpha fill colour alpha transparency reference interval method = \"simulate\". point_col colour alpha transparency points QQ plot. point_alpha colour alpha transparency points QQ plot. line_col colour used draw reference line.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/worm_plot.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Worm plot of model residuals ‚Äî worm_plot","text":"wording used mgcv::qq.gam() uses direct reference simulated residuals method (method = \"simulated\"). avoid confusion, method = \"direct\" deprecated favour method = \"uniform\".","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/worm_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Worm plot of model residuals ‚Äî worm_plot","text":"","code":"load_mgcv() ## simulate binomial data... dat <- data_sim(\"eg1\", n = 200, dist = \"binary\", scale = .33, seed = 0) p <- binomial()$linkinv(dat$f)               # binomial p n <- sample(c(1, 3), 200, replace = TRUE) # binomial n dat <- transform(dat, y = rbinom(n, n, p), n = n) m <- gam( y / n ~ s(x0) + s(x1) + s(x2) + s(x3),          family = binomial, data = dat, weights = n,          method = \"REML\")  ## Worm plot; default using direct randomization of uniform quantiles ## Note no reference bands are drawn with this method. worm_plot(m)   ## Alternatively use simulate new data from the model, which ## allows construction of reference intervals for the Q-Q plot worm_plot(m, method = \"simulate\", point_col = \"steelblue\",           point_alpha = 0.4)   ## ... or use the usual normality assumption worm_plot(m, method = \"normal\")"},{"path":"https://gavinsimpson.github.io/gratia/reference/zooplankton.html","id":null,"dir":"Reference","previous_headings":"","what":"Madison lakes zooplankton data ‚Äî zooplankton","title":"Madison lakes zooplankton data ‚Äî zooplankton","text":"Madison lake zooplankton data long-term study seasonal dynamics zooplankton, collected Richard Lathrop. data collected chain lakes Wisconsin (Mendota, Monona, Kegnonsa, Waubesa) approximately bi-weekly 1976 1994. consist samples zooplankton communities, taken deepest point lake via vertical tow. data provided Wisconsin Department Natural Resources collection processing fully described Lathrop (2000).","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/zooplankton.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Madison lakes zooplankton data ‚Äî zooplankton","text":"data frame","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/zooplankton.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Madison lakes zooplankton data ‚Äî zooplankton","text":"Pedersen EJ, Miller DL, Simpson GL, Ross N. 2018. Hierarchical generalized additive models: introduction mgcv. PeerJ Preprints 6:e27320v1 doi: 10.7287/peerj.preprints.27320v1 .","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/zooplankton.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Madison lakes zooplankton data ‚Äî zooplankton","text":"record consists counts given zooplankton taxon taken subsample single vertical net tow, scaled account relative volume subsample versus whole net sample area net tow rounded nearest 1000 give estimated population density per m2 taxon point time sampled lake.","code":""},{"path":"https://gavinsimpson.github.io/gratia/reference/zooplankton.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Madison lakes zooplankton data ‚Äî zooplankton","text":"Lathrop RC. (2000). Madison Wisonsin Lakes Zooplankton 1976--1994. Environmental Data Initiative.","code":""},{"path":[]},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"new-features-0-7-0-4","dir":"Changelog","previous_headings":"","what":"New features","title":"gratia 0.7.0-4","text":"draw.gam() draw.smooth_estimates(): {gratia} can now handle smooths 3 4 covariates plotting. smooths 3 covariates, third covariate handled ggplot2::facet_wrap() set (default n = small multiples drawn, 2d surface evaluated specified value third covariate. smooths 4 covariates, ggplot2::facet_grid() used draw small multiples, default producing 4 rows 4 columns plots specific values third fourth covariates. number small multiples produced controlled new arguments n_3d (default = n_3d = 16) n_4d (default n_4d = 4, yielding n_4d * n_4d = 16 facets) respectively. affects plotting; smooth_estimates() able handle smooths number covariates . handling higher-dimensional smooths, actually drawing plots default device can slow, especially default value n = 100 (3D 4D smooths result 160,000 data points plotted). recommended reduce n smaller value: n = 50 reasonable compromise resolution speed. model_concurvity() returns concurvity measures mgcv::concurvity() estimated GAMs tidy format. synonym concrvity() also provided. draw() method provided produces bar plot heatmap concurvity values depending whether overall concurvity smooth pairwise concurvity smooth model requested.","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"bug-fixes-0-7-0-4","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"gratia 0.7.0-4","text":"model_edf() using type argument. result ever returned default EDF type. add_constant methods weren‚Äôt applying constant required variables.","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"gratia-070","dir":"Changelog","previous_headings":"","what":"gratia 0.7.0","title":"gratia 0.7.0","text":"CRAN release: 2022-02-07","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"major-changes-0-7-0","dir":"Changelog","previous_headings":"","what":"Major changes","title":"gratia 0.7.0","text":"draw.gam() now uses smooth_estimates() internally consequently uses draw() method underlying plotting code. simplified code compared evaluate_smooth() methods, allow future development addition features easily evaluate_smooth() retained. Similarly, evaluate_parametric_terms() now deprecated favour parametric_effects(), also used internally draw.gam() parametric terms present model (parametric = TRUE). lot code reused differences plots result change minimal, corner cases may missed. File Issue notice something changed think shouldn‚Äôt. draw.gam() now plots 2D isotropic smooths (TPRS Duchon splines) equally-scaled x y coordinates using coord_equal(ratio = 1). Alignment plots little different now plotting models multiple smooths. See Issue #81.","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"deprecated-functions-0-7-0","dir":"Changelog","previous_headings":"Major changes","what":"Deprecated functions","title":"gratia 0.7.0","text":"version 0.7.0, following functions considered deprecated use discouraged: fderiv() soft-deprecated favour derivatives(), evaluate_smooth() soft-deprecated favour smooth_estimates(), evaluate_parametric_term() soft-deprecated favour parametric_effects(). first call one functions generate warning, pointing newer, alternative, function. safe ignore warnings, deprecated functions longer receive updates thus risk removed package future date. newer alternatives can handle types models smooths, especially case smooth_estimates().","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"new-features-0-7-0","dir":"Changelog","previous_headings":"","what":"New features","title":"gratia 0.7.0","text":"fitted_values() provides tidy wrapper around predict.gam() generating fitted values model. New covariate values can provided via argument data. credible interval fitted values returned, values can link (linear predictor) response scale. Note function returns expected values response. Hence, ‚Äúfitted values‚Äù used instead ‚Äúpredictions‚Äù case new covariate values differentiate values case generating new response values fitted model. rootogram() draw() method produce rootograms diagnostic plots fitted models. Currently models fitted poisson(), nb(), negbin(), gaussian() families. New helper functions typical_values(), factor_combos() data_combos() quickly creating data sets producing predictions fitted models covariatess fixed come typical representative values. typical_values() new helper function return typical values covariates fitted model. returns value observation closest median numerical covariates modal level factor preserving levels factor. typical_values() useful preparing data slices scenarios fitted values estimated model required. factor_combos() extracts returns combinations levels factors found data used fit model. Unlike typical_values(), factor_combos() returns combinations factor levels observed data, just modal level. Optionally, combinations factor levels can returned, just observed data. data_combos() combines returns factor data factor_combos() plus typical values numerical covariates. useful want generate predictions model combination factor terms holding continuous covariates median values. nb_theta() new extractor function returns theta parameter fitted negative binomial GAM (families nb() negbin()). Additionally, theta() has_theta() provide additional functionality. theta() experimental function extracting additional parameters model family. has_theta() useful checking additional parameters available family model. edf() extracts effective degrees freedom (EDF) fitted model specific smooth model. Various forms EDF can extracted. model_edf() returns EDF overall model. supplied multiple models, EDFs model returned comparison. draw.gam() can now show ‚Äúrug‚Äù plot bivariate smooth drawing small points high transparency smooth surface data coordinates. addition, rugs plots factor smooths now show locations covariate values specific level factor levels. better reflects data used estimate smooth, even though basis smooth set using covariate locations. draw.gam() draw.smooth_estimates() now allow aspects plot changed: fill (colour) alpha attributes credible interval, line colour smooth can now specified using arguments ci_col, ci_alpha, smooth_col respectively. Partial residuals can now plotted factor smooths. allow , partial residuals filtered residuals associated particular level‚Äôs smooth drawn plot smooth. smooth_estimates() uses check_user_select_smooths() handle user-specified selection smooth terms. flexible previously, allows easier selection smooths evaluate. fixef() now imported (re-exported) nlme package, methods models fitted gam() gamm(), extract fixed effects estimates fitted models. fixed_effects() alias fixef(). draw() method smooth_samples() can now handle 2D smooths. Additionally, number posterior draws plot can now specified plotting using new argument n_samples, result n_samples draws selected random set draws plotting. New argument seed allows selection draws repeatable.","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"bug-fixes-0-7-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"gratia 0.7.0","text":"smooth_estimates() filtering user-supplied data level specific smooth used factor smooths. result smooth evaluated rows user-supplied data, therefore result nrow(user_data) * nlevels(by_variable) rows returned object instead nrow(user_data) rows. add_confint() method smooth_estimates() upper lower intervals reversed. #107 Reported @Aariq draw.gam() smooth_estimates() ignoring dist argument allows covariate values lie far support data excluded returning estimated values smooth plotting . #111 Reported @Aariq smooth_samples() factor GAM return samples first factor level . Reported @rroyaute discussion #121 smooth_samples() fail model contained random effect ‚Äúsmooths‚Äù. now ignored message running smooth_samples(). Reported @isabellaghement #121 link(), inv_link() failing models fitted family = scat(). Reported @Aariq #130","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"gratia-060","dir":"Changelog","previous_headings":"","what":"gratia 0.6.0","title":"gratia 0.6.0","text":"CRAN release: 2021-04-18","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"major-changes-0-6-0","dir":"Changelog","previous_headings":"","what":"Major changes","title":"gratia 0.6.0","text":"{cowplot} package replaced {patchwork} package producing multi-panel figures draw() appraise(). shouldn‚Äôt affect code used {gratia} , passed additional arguments cowplot::plot_grid() used align axis arguments draw() appraise(), ‚Äôll need adapt code accordingly. Typically, can simply delete align axis arguments {patchwork} just work align plots nicely. arguments passed via ... cowplot::plot_grid() just ignored patchwork::wrap_plots() unless passed arguments match arguments patchwork::wrap_plots().","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"new-features-0-6-0","dir":"Changelog","previous_headings":"","what":"New features","title":"gratia 0.6.0","text":"{patchwork} package now used multi-panel figures. , {gratia} longer Imports {cowplot} package. Worm plot diagnostic plots available via new function worm_plot(). Worm plots detrended Q-Q plots, deviation Q-Q reference line emphasized deviations around line occupy full height plot. worm_plot() methods available models classes \"gam\", \"glm\", \"lm\". (#62) Smooths can now compared across models using compare_smooths(), comparisons visualised associated draw() method. (#85 @dill) feature bit experimental; returned object uses nested lists may change future users find confusing. reference line qq_plot() method = \"normal\" previously drawn line intercept 0 slope 1, match methods. inconsistent stats::qqplot() drew line 1st 3rd quartiles. qq_plot() method = \"normal\" now uses robust reference line. Reference lines methods remain drawn slope 1 intercept 0. qq_plot() method = \"normal\" now draws point-wise reference band using standard error order statistic. draw() method penalty() now plots penalty matrix heatmaps -logical orientation, match matrices might written printed R console. link(), inv_link() now work models fitted gumbls() shash() families. (#84) extract_link() lower level utility function related link() inv_link(), now exported.","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"user-visible-changes-0-6-0","dir":"Changelog","previous_headings":"","what":"User visible changes","title":"gratia 0.6.0","text":"default method name generating reference quantiles qq_plot() changed \"direct\" \"uniform\", avoid confusion mgcv::qq.gam() help page description methods. Accordingly using method = \"direct\" deprecated message effect displayed used. way smooths/terms selected derivatives() switched use mechanism draw.gam()‚Äôs select argument. get partial match term, now need also specify partial_match = TRUE call derivatives().","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"bug-fixes-0-6-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"gratia 0.6.0","text":"transform_fun() copy paste bug definition generic. (#96 @Aariq) derivatives() user-supplied newdata fail factor smooths interval = \"simultaneous\" introduce rows derivative == 0 interval = \"confidence\" didn‚Äôt subset rows newdata specific level factor computing derivatives. (#102 @sambweber) evaluate_smooth() can now handle random effect smooths defined using ordered factor. (#99 @StefanoMezzini)","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"gratia-051","dir":"Changelog","previous_headings":"","what":"gratia 0.5.1","title":"gratia 0.5.1","text":"CRAN release: 2021-01-23","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"new-features-0-5-1","dir":"Changelog","previous_headings":"","what":"New features","title":"gratia 0.5.1","text":"smooth_estimates() can now handle bivariate multivariate thinplate regression spline smooths, e.g.¬† s(x, z, ), tensor product smooths (te(), t2(), & ti()), e.g.¬†te(x, z, ) factor smooth interactions, e.g.¬†s(x, f, bs = \"fs\") random effect smooths, e.g.¬†s(f, bs = \"re\") penalty() provides tidy representation penalty matrices smooths. tidy representation suitable plotting ggplot(). draw() method provided, represents penalty matrix heatmap.","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"user-visible-changes-0-5-1","dir":"Changelog","previous_headings":"","what":"User visible changes","title":"gratia 0.5.1","text":"newdata argument smooth_estimates() changed data originally intended.","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"gratia-050","dir":"Changelog","previous_headings":"","what":"gratia 0.5.0","title":"gratia 0.5.0","text":"CRAN release: 2021-01-10","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"new-features-0-5-0","dir":"Changelog","previous_headings":"","what":"New features","title":"gratia 0.5.0","text":"Partial residuals models can computed partial_residuals(). partial residuals weighted residuals model added contribution smooth term (returned predict(model,   type = \"terms\"). Wish #76 (@noamross) Also, new function add_partial_residuals() can used add partial residuals data frames. Users can now control extent colour fill scales used plotting smooths draw() methods use . useful change fill scale plotting 2D smooths, change discrete colour scale used plotting random factor smooths (bs = \"fs\"). user can pass scales via arguments discrete_colour continuous_fill. effects certain smooths can excluded data simulated model using simulate.gam() predicted_samples() passing exclude terms predict.gam(). allows excluding random effects, example, model predicted values used simulate new data conditional distribution. See example predicted_samples(). Wish #74 (@hgoldspiel) draw.gam() related functions gain arguments constant fun allow user-defined constants transformations smooth estimates confidence intervals applied. Part wish Wish #79. confint.gam() now works 2D smooths also. smooth_estimates() early version code replace (likely supersede) evaluate_smooth(). smooth_estimates() can currently handle 1D smooths standard types.","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"user-visible-changes-0-5-0","dir":"Changelog","previous_headings":"","what":"User visible changes","title":"gratia 0.5.0","text":"meaning parm confint.gam changed. argument now requires smooth label match smooth. vector labels can provided, partial matching smooth label works single parm value. default behaviour remains unchanged however; parm NULL smooths evaluated returned confidence intervals. data_class() longer exported; ever intended internal function.","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"bug-fixes-0-5-0","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"gratia 0.5.0","text":"confint.gam() failing tensor product smooth due matching issues. Reported @tamas-ferenci #88 also fixes #80 related issue selecting specific smooth. vdiffr package now used conditionally package tests. Reported Brian Ripley #93","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"gratia-041","dir":"Changelog","previous_headings":"","what":"gratia 0.4.1","title":"gratia 0.4.1","text":"CRAN release: 2020-05-30","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"user-visible-changes-0-4-1","dir":"Changelog","previous_headings":"","what":"User visible changes","title":"gratia 0.4.1","text":"draw.gam() scales = \"fixed\" now applies terms can plotted, including 2d smooths. Reported @StefanoMezzini #73","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"bug-fixes-0-4-1","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"gratia 0.4.1","text":"dplyr::combine() deprecated. Switch vctrs::vec_c(). draw.gam() scales = \"fixed\" wasn‚Äôt using fixed scales 2d smooths model. Reported @StefanoMezzini #73","code":""},{"path":[]},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"new-features-0-4-0","dir":"Changelog","previous_headings":"","what":"New features","title":"gratia 0.4.0","text":"draw.gam() can include partial residuals drawing univariate smooths. Use residuals = TRUE add partial residuals univariate smooth drawn. feature available smooths one variable, smooths, factor-smooth interactions (bs = \"fs\"). coverage credible confidence intervals drawn draw.gam() can specified via argument ci_level. default arbitrarily 0.95 reason (rough) compatibility plot.gam(). change effect making intervals slightly narrower previous versions gratia; intervals drawn ¬± 2 √ó standard error. default intervals now drawn ¬± ~1.96 √ó standard error. New function difference_smooths() computing differences factor smooth interactions. Methods available gam(), bam(), gamm() gamm4::gamm4(). Also draw() method, can handle differences 1D 2D smooths currently (handling 3D 4D smooths planned). New functions add_fitted() add_residuals() add fitted values (expectations) model residuals existing data frame. Currently methods available objects fitted gam() bam(). data_sim() tidy reimplementation mgcv::gamSim() added ability use sampling distributions Gaussian models implemented. Currently Gaussian, Poisson, Bernoulli sampling distributions available. smooth_samples() can handle continuous variable smooths varying coefficient models. link() inv_link() now work families available mgcv, including location, scale, shape families, specialised families described ?mgcv::family.mgcv. evaluate_smooth(), data_slice(), family(), link(), inv_link() methods models fitted using gamm4() gamm4 package. data_slice() can generate data 1-d slice (single variable varying). colour points, reference lines, simulation band appraise() can now specified via arguments point_col, point_alpha, ci_col ci_alpha line_col passed qq_plot(), observed_fitted_plot(), residuals_linpred_plot(), residuals_hist_plot(), also now take new arguments applicable. Added utility functions is_factor_term() term_variables() working models. is_factor_term() identifies named term factor using information terms() object fitted model. term_variables() returns character vector variable names involved model term. strictly working parametric terms models. appraise() now works models fitted glm() lm(), underlying functions calls, especially qq_plot. appraise() also works models fitted family gaulss(). location scale models models fitted extended family functions supported upcoming releases.","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"user-visible-changes-0-4-0","dir":"Changelog","previous_headings":"","what":"User visible changes","title":"gratia 0.4.0","text":"datagen() now internal function longer exported. Use data_slice() instead. evaluate_parametric_term() now much stricter can evaluate main effect terms, .e.¬†whose order, stored terms object model 1.","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"bug-fixes-0-4-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"gratia 0.4.0","text":"draw() method derivatives() getting x-axis label factor smooths correctly, instead using NA second subsequent levels factor. datagen() method class \"gam\" couldn‚Äôt possibly worked anything simplest models fail even simple factor smooths. issues fixed, behaviour datagen() changed, function now intended use users. Fixed issue models terms form factor1:factor2 incorrectly identified numeric parametric terms. #68","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"gratia-031","dir":"Changelog","previous_headings":"","what":"gratia 0.3.1","title":"gratia 0.3.1","text":"CRAN release: 2020-03-29","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"new-features-0-3-1","dir":"Changelog","previous_headings":"","what":"New features","title":"gratia 0.3.1","text":"New functions link() inv_link() access link function inverse fitted models family functions. Methods classes: \"glm\", \"gam\", \"bam\", \"gamm\" currently. #58 Adds explicit family() methods objects classes \"gam\", \"bam\", \"gamm\". derivatives() now handles non-numeric creating shifted data finite differences. Fixes problem stringsAsFactors = FALSE default R-devel. #64","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"bug-fixes-0-3-1","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"gratia 0.3.1","text":"Updated gratia work tibble versions >= 3.0","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"gratia-030","dir":"Changelog","previous_headings":"","what":"gratia 0.3.0","title":"gratia 0.3.0","text":"CRAN release: 2020-01-19","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"new-features-0-3-0","dir":"Changelog","previous_headings":"","what":"New features","title":"gratia 0.3.0","text":"gratia now uses mvnfast package random draws multivariate normal distribution (mvnfast::rmvn()). Contributed Henrik Singmann #28 New function basis() generating tidy representations basis expansions mgcv-like definition smooth, e.g.¬†s(), te(), ti(), t2(). basic smooth types also simple draw() method plotting basis. basis() simple wrapper around mgcv::smoothCon() post processing basis model matrix tidy format. #42 New function smooth_samples() draw samples entire smooth functions posterior distribution. Also draw() method plotting posterior samples.","code":""},{"path":"https://gavinsimpson.github.io/gratia/news/index.html","id":"bug-fixes-0-3-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"gratia 0.3.0","text":"draw.gam() produce empty plots panels parametric terms 2 parametric terms model. Reported @sklayn #39. derivatives() now works factor smooths, including ordered factor smooths. function also now works correctly complex models multiple covariates/smooths. #47 derivatives() also now handles 'fs' smooths. Reported @tomand-uio #57. evaluate_parametric_term() hence draw.gam() fail ziplss() model ) gratia didn‚Äôt handle parametric terms models multiple linear predictors correctly, ii) gratia didn‚Äôt convert naming convention mgcv terms higher linear predictors. Reported @pboesu #45","code":""}]
