<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gratia">
<title>Get started with gratia â€¢ gratia</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Get started with gratia">
<meta property="og:description" content="gratia">
<meta property="og:image" content="https://gavinsimpson.github.io/gratia/reference/figures/README-draw-gam-figure-1.png">
<meta property="og:image:alt" content="Plot produced by draw() of 4 smooth functions from a fitted generalized additive model">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@ucfagls">
<meta name="twitter:site" content="@ucfagls">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gratia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0.9005</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/gratia.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/custom-plotting.html">Customizing plots</a>
    <a class="dropdown-item" href="../articles/data-slices.html">Data slices</a>
    <a class="dropdown-item" href="../articles/posterior-simulation.html">Posterior Simulation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/gavinsimpson/gratia/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Get started with gratia</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gavinsimpson/gratia/blob/HEAD/vignettes/gratia.Rmd" class="external-link"><code>vignettes/gratia.Rmd</code></a></small>
      <div class="d-none name"><code>gratia.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://gavinsimpson.github.io/gratia/">"gratia"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"mgcv"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: nlme</span></span>
<span><span class="co">#&gt; This is mgcv 1.9-1. For overview type 'help("mgcv-package")'.</span></span></code></pre></div>
<p>gratia is a package to make working with generalized additive models
(GAMs) in R easier, including producing plots of estimated smooths using
the ggplot2 ðŸ“¦.</p>
<p>This introduction will cover some of the basic functionality of
gratia to get you started. Weâ€™ll work with some classic simulated data
often used to illustrate properties of GAMs</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_sim.html">data_sim</a></span><span class="op">(</span><span class="st">"eg1"</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 400 Ã— 10</span></span></span>
<span><span class="co">#&gt;        y    x0     x1    x2    x3     f    f0    f1     f2    f3</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  2.99 0.915 0.022<span style="text-decoration: underline;">7</span> 0.909 0.402  1.62 0.529  1.05 0.039<span style="text-decoration: underline;">7</span>     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  4.70 0.937 0.513  0.900 0.432  3.25 0.393  2.79 0.063<span style="text-decoration: underline;">0</span>     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 13.9  0.286 0.631  0.192 0.664 13.5  1.57   3.53 8.41       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  5.71 0.830 0.419  0.532 0.182  6.12 1.02   2.31 2.79       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  7.63 0.642 0.879  0.522 0.838 10.4  1.80   5.80 2.76       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  9.80 0.519 0.108  0.160 0.917 10.4  2.00   1.24 7.18       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 10.4  0.737 0.980  0.520 0.798 11.3  1.47   7.10 2.75       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 12.8  0.135 0.265  0.225 0.503 11.4  0.821  1.70 8.90       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 13.8  0.657 0.084<span style="text-decoration: underline;">3</span> 0.282 0.254 11.1  1.76   1.18 8.20       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  7.51 0.705 0.386  0.504 0.667  6.50 1.60   2.16 2.74       0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 390 more rows</span></span></span></code></pre></div>
<p>and the following GAM</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x3</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: gaussian </span></span>
<span><span class="co">#&gt; Link function: identity </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; y ~ s(x0) + s(x1) + s(x2) + s(x3)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parametric coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   7.4951     0.1051   71.35   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span><span class="co">#&gt;         edf Ref.df      F  p-value    </span></span>
<span><span class="co">#&gt; s(x0) 3.425  4.244  8.828 8.78e-07 ***</span></span>
<span><span class="co">#&gt; s(x1) 3.221  4.003 67.501  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; s(x2) 7.905  8.685 67.766  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; s(x3) 1.885  2.359  2.642   0.0636 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-sq.(adj) =  0.685   Deviance explained = 69.8%</span></span>
<span><span class="co">#&gt; -REML = 886.93  Scale est. = 4.4144    n = 400</span></span></code></pre></div>
<div class="section level2">
<h2 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h2>
<p>gratia provides the <code><a href="../reference/draw.html">draw()</a></code> function to produce plots
using the ggplot2 ðŸ“¦. To draw the estimated smooths from the GAM we
fitted above, use</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw.html">draw</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<p><img src="gratia_files/figure-html/draw-gam-1.png" width="700"></p>
<p>This is intended as reasonable overview of the estimated model, but
it offers limited option to modify the resulting plot. If you want full
control, you can obtain the data used to create the plot above with
<code><a href="../reference/smooth_estimates.html">smooth_estimates()</a></code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_estimates.html">smooth_estimates</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="va">sm</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 400 Ã— 9</span></span></span>
<span><span class="co">#&gt;    .smooth .type .by   .estimate   .se       x0    x1    x2    x3</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> s(x0)   TPRS  <span style="color: #BB0000;">NA</span>       -<span style="color: #BB0000;">1.32</span>  0.390 0.000<span style="text-decoration: underline;">239</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> s(x0)   TPRS  <span style="color: #BB0000;">NA</span>       -<span style="color: #BB0000;">1.24</span>  0.365 0.010<span style="text-decoration: underline;">3</span>      <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> s(x0)   TPRS  <span style="color: #BB0000;">NA</span>       -<span style="color: #BB0000;">1.17</span>  0.340 0.020<span style="text-decoration: underline;">4</span>      <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> s(x0)   TPRS  <span style="color: #BB0000;">NA</span>       -<span style="color: #BB0000;">1.09</span>  0.318 0.030<span style="text-decoration: underline;">4</span>      <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> s(x0)   TPRS  <span style="color: #BB0000;">NA</span>       -<span style="color: #BB0000;">1.02</span>  0.297 0.040<span style="text-decoration: underline;">5</span>      <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> s(x0)   TPRS  <span style="color: #BB0000;">NA</span>       -<span style="color: #BB0000;">0.947</span> 0.279 0.050<span style="text-decoration: underline;">6</span>      <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> s(x0)   TPRS  <span style="color: #BB0000;">NA</span>       -<span style="color: #BB0000;">0.875</span> 0.263 0.060<span style="text-decoration: underline;">6</span>      <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> s(x0)   TPRS  <span style="color: #BB0000;">NA</span>       -<span style="color: #BB0000;">0.803</span> 0.249 0.070<span style="text-decoration: underline;">7</span>      <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> s(x0)   TPRS  <span style="color: #BB0000;">NA</span>       -<span style="color: #BB0000;">0.732</span> 0.237 0.080<span style="text-decoration: underline;">7</span>      <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> s(x0)   TPRS  <span style="color: #BB0000;">NA</span>       -<span style="color: #BB0000;">0.662</span> 0.228 0.090<span style="text-decoration: underline;">8</span>      <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 390 more rows</span></span></span></code></pre></div>
<p>which will evaluate all smooths are unevenly spaced values over the
range of the covariate(s). If you want to evaluate only selected
smooths, you can specify which via the <code>smooth</code> argument.
This takes the <em>smooth labels</em> which are the names of the smooths
as they are known to mgcv. To list the labels for the smooths in use</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/smooths.html">smooths</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "s(x0)" "s(x1)" "s(x2)" "s(x3)"</span></span></code></pre></div>
<p>To evaluate only <span class="math inline">\(f(x_2)\)</span> use</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_estimates.html">smooth_estimates</a></span><span class="op">(</span><span class="va">m</span>, smooth <span class="op">=</span> <span class="st">"s(x2)"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The `smooth` argument of `smooth_estimates()` is deprecated as of gratia</span></span>
<span><span class="co">#&gt; 0.8.9.9.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Please use the `select` argument instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sm</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 Ã— 6</span></span></span>
<span><span class="co">#&gt;    .smooth .type .by   .estimate   .se      x2</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> s(x2)   TPRS  <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">4.47</span>   0.476 0.003<span style="text-decoration: underline;">59</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> s(x2)   TPRS  <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">4.00</span>   0.406 0.013<span style="text-decoration: underline;">6</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> s(x2)   TPRS  <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">3.53</span>   0.345 0.023<span style="text-decoration: underline;">7</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> s(x2)   TPRS  <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">3.06</span>   0.295 0.033<span style="text-decoration: underline;">8</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> s(x2)   TPRS  <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">2.58</span>   0.263 0.043<span style="text-decoration: underline;">8</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> s(x2)   TPRS  <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">2.09</span>   0.250 0.053<span style="text-decoration: underline;">9</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> s(x2)   TPRS  <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.59</span>   0.253 0.063<span style="text-decoration: underline;">9</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> s(x2)   TPRS  <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.08</span>   0.264 0.074<span style="text-decoration: underline;">0</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> s(x2)   TPRS  <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">0.564</span>  0.278 0.084<span style="text-decoration: underline;">1</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> s(x2)   TPRS  <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">0.036</span><span style="color: #BB0000; text-decoration: underline;">4</span> 0.289 0.094<span style="text-decoration: underline;">1</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 90 more rows</span></span></span></code></pre></div>
<p>Then you can generate your own plot using the ggplot2 package, for
example</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:nlme':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     collapse</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sm</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_confint.html">add_confint</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.estimate</span>, x <span class="op">=</span> <span class="va">x2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">.lower_ci</span>, ymax <span class="op">=</span> <span class="va">.upper_ci</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.2</span>, fill <span class="op">=</span> <span class="st">"forestgreen"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"forestgreen"</span>, linewidth <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="st">"Partial effect"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Partial effect of"</span> <span class="op">~</span> <span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="gratia_files/figure-html/ggplot-smooth-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="model-diagnostics">Model diagnostics<a class="anchor" aria-label="anchor" href="#model-diagnostics"></a>
</h2>
<p>The <code><a href="../reference/appraise.html">appraise()</a></code> function provides standard diagnostic
plots for GAMs</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/appraise.html">appraise</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<p><img src="gratia_files/figure-html/appraise-1.png" width="700"></p>
<p>The plots produced are (from left-to-right, top-to-bottom),</p>
<ul>
<li>a quantile-quantile (QQ) plot of deviance residuals,</li>
<li>a scatterplot of deviance residuals against the linear
predictor,</li>
<li>a histogram of deviance residuals, and</li>
<li>a scatterplot of observed vs fitted values.</li>
</ul>
<p>Adding partial residuals to the partial effect plots produced by
<code><a href="../reference/draw.html">draw()</a></code> can also help diagnose problems with the model, such
as oversmoothing</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>, residuals <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="gratia_files/figure-html/draw-partial-residuals-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="want-to-learn-more">Want to learn more?<a class="anchor" aria-label="anchor" href="#want-to-learn-more"></a>
</h2>
<p><em>gratia</em> is in very active development and an area of
development that is currently lacking is documentation. To find out more
about the package, look at the <a href="https://gavinsimpson.github.io/gratia/reference/index.html">help
pages for the package</a> and look at the examples for more code to help
you get going.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://fromthebottomoftheheap.net" class="external-link">Gavin L. Simpson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
